msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-01T05:53:05Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Language: zh_TW\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/2696-debug-map-key-value.md:1
msgid "Feature Name: `debug_map_key_value`"
msgstr ""

#: src/2696-debug-map-key-value.md:2
msgid "Start Date: 2019-05-01"
msgstr ""

#: src/2696-debug-map-key-value.md:3
msgid ""
"RFC PR: [rust-lang/rfcs#2696](https://github.com/rust-lang/rfcs/pull/2696)"
msgstr ""

#: src/2696-debug-map-key-value.md:4
msgid ""
"Rust Issue: [rust-lang/rust#62482](https://github.com/rust-lang/rust/"
"issues/62482)"
msgstr ""

#: src/2696-debug-map-key-value.md:6
msgid "Summary"
msgstr ""

#: src/2696-debug-map-key-value.md:9
msgid ""
"Add two new methods to `std::fmt::DebugMap` for writing the key and value "
"part of a map entry separately:"
msgstr ""

#: src/2696-debug-map-key-value.md:18
msgid "Motivation"
msgstr ""

#: src/2696-debug-map-key-value.md:21
msgid ""
"The format builders available to `std::fmt::Debug` implementations through "
"the `std::fmt::Formatter` help keep the textual debug representation of Rust "
"structures consistent. They're also convenient to use and make sure the "
"various formatting flags are retained when formatting entries. The standard "
"formatting API in `std::fmt` is similar to `serde::ser`:"
msgstr ""

#: src/2696-debug-map-key-value.md:23
msgid "`Debug` -> `Serialize`"
msgstr ""

#: src/2696-debug-map-key-value.md:24
msgid "`Formatter` -> `Serializer`"
msgstr ""

#: src/2696-debug-map-key-value.md:25
msgid "`DebugMap` -> `SerializeMap`"
msgstr ""

#: src/2696-debug-map-key-value.md:26
msgid "`DebugList` -> `SerializeSeq`"
msgstr ""

#: src/2696-debug-map-key-value.md:27
msgid ""
"`DebugTuple` -> `SerializeTuple` / `SerializeTupleStruct` / "
"`SerilizeTupleVariant`"
msgstr ""

#: src/2696-debug-map-key-value.md:28
msgid "`DebugStruct` -> `SerializeStruct` / `SerializeStructVariant`"
msgstr ""

#: src/2696-debug-map-key-value.md:30
msgid ""
"There's one notable inconsistency though: an implementation of "
"`SerializeMap` must support serializing its keys and values independently. "
"This isn't supported by `DebugMap` because its `entry` method takes both a "
"key and a value together. That means it's not possible to write a "
"`Serializer` that defers entirely to the format builders."
msgstr ""

#: src/2696-debug-map-key-value.md:32
msgid ""
"Adding separate `key` and `value` methods to `DebugMap` will align it more "
"closely with `SerializeMap`, and make it possible to build a `Serializer` "
"based on the standard format builders."
msgstr ""

#: src/2696-debug-map-key-value.md:34
msgid "Guide-level explanation"
msgstr ""

#: src/2696-debug-map-key-value.md:37
msgid ""
"In `DebugMap`, an entry is the pair of a key and a value. That means the "
"following `Debug` implementation:"
msgstr ""

#: src/2696-debug-map-key-value.md:48 src/2696-debug-map-key-value.md:63
#: src/2696-debug-map-key-value.md:96
msgid "\"key\""
msgstr ""

#: src/2696-debug-map-key-value.md:48 src/2696-debug-map-key-value.md:63
#: src/2696-debug-map-key-value.md:95
msgid "\"value\""
msgstr ""

#: src/2696-debug-map-key-value.md:55
msgid "is equivalent to:"
msgstr ""

#: src/2696-debug-map-key-value.md:62
msgid "// Equivalent to map.entry\n"
msgstr ""

#: src/2696-debug-map-key-value.md:70
msgid ""
"Every call to `key` must be directly followed by a corresponding call to "
"`value` to complete the entry:"
msgstr ""

#: src/2696-debug-map-key-value.md:79
msgid ""
"// err: attempt to start a new entry without finishing the current one\n"
msgstr ""

#: src/2696-debug-map-key-value.md:87
msgid "`key` must be called before `value`:"
msgstr ""

#: src/2696-debug-map-key-value.md:94
msgid "// err: attempt to write a value without first writing its key\n"
msgstr ""

#: src/2696-debug-map-key-value.md:103
msgid "Each entry must be finished before the map can be finished:"
msgstr ""

#: src/2696-debug-map-key-value.md:112
msgid "// err: attempt to finish a map that has an incomplete key\n"
msgstr ""

#: src/2696-debug-map-key-value.md:118
msgid "Any incorrect calls to `key` and `value` will panic."
msgstr ""

#: src/2696-debug-map-key-value.md:120
msgid "When to use `key` and `value`"
msgstr ""

#: src/2696-debug-map-key-value.md:122
msgid ""
"Why would you want to use `key` and `value` directly if they're less "
"convenient than `entry`? The reason is when the driver of the `DebugMap` is "
"a framework like `serde` rather than a data structure directly:"
msgstr ""

#: src/2696-debug-map-key-value.md:166
msgid "Consumers should prefer calling `entry` over `key` and `value`."
msgstr ""

#: src/2696-debug-map-key-value.md:168
msgid "Reference-level explanation"
msgstr ""

#: src/2696-debug-map-key-value.md:171
msgid ""
"The `key` and `value` methods can be implemented on `DebugMap` by tracking "
"the state of the current entry in a `bool`, and splitting the existing "
"`entry` method into two:"
msgstr ""

#: src/2696-debug-map-key-value.md:192 src/2696-debug-map-key-value.md:223
msgid "// Make sure there isn't a partial entry\n"
msgstr ""

#: src/2696-debug-map-key-value.md:193
msgid ""
"\"attempted to begin a new map entry without completing the previous one\""
msgstr ""

#: src/2696-debug-map-key-value.md:196
msgid "// write the key\n"
msgstr ""

#: src/2696-debug-map-key-value.md:198
msgid "// Mark that we're in an entry\n"
msgstr ""

#: src/2696-debug-map-key-value.md:207
msgid "// Make sure there is a partial entry to finish\n"
msgstr ""

#: src/2696-debug-map-key-value.md:208
msgid "\"attempted to format a map value before its key\""
msgstr ""

#: src/2696-debug-map-key-value.md:211
msgid "// write the value\n"
msgstr ""

#: src/2696-debug-map-key-value.md:213
msgid "// Mark that we're not in an entry\n"
msgstr ""

#: src/2696-debug-map-key-value.md:224
msgid "\"attempted to finish a map with a partial entry\""
msgstr ""

#: src/2696-debug-map-key-value.md:226
msgid "\"}\""
msgstr ""

#: src/2696-debug-map-key-value.md:231
msgid "Drawbacks"
msgstr ""

#: src/2696-debug-map-key-value.md:234
msgid ""
"The proposed `key` and `value` methods are't immediately useful for `Debug` "
"implementors that are able to call `entry` instead. This creates a decision "
"point where there wasn't one before. The proposed implementation is also "
"going to be less efficient than the one that exists now because it "
"introduces a few conditionals."
msgstr ""

#: src/2696-debug-map-key-value.md:236
msgid ""
"On balance, the additional `key` and `value` methods are a small and "
"unsurprising addition that enables a set of use-cases that weren't possible "
"before, and aligns more closely with `serde`."
msgstr ""

#: src/2696-debug-map-key-value.md:238
msgid "Rationale and alternatives"
msgstr ""

#: src/2696-debug-map-key-value.md:241
msgid ""
"The universal alternative of simply _not doing this_ leaves consumers that "
"do need to format map keys independently of values with a few options:"
msgstr ""

#: src/2696-debug-map-key-value.md:243
msgid ""
"Write an alternative implementation of the format builders. The output from "
"this alternative implementation would need to be kept reasonably in-sync "
"with the one in the standard library. It doesn't change very frequently, but "
"does from time to time. It would also have to take the same care as the "
"standard library implementation to retain formatting flags when working with "
"entries."
msgstr ""

#: src/2696-debug-map-key-value.md:244
msgid ""
"Buffer keys and format them together with values when the whole entry is "
"available. Unless the key is guaranteed to live until the value is supplied "
"(meaning it probably needs to be `'static`) then the key will need to be "
"formatted into a string first. This means allocating (though the cost could "
"be amortized over the whole map) and potentially losing formatting flags "
"when buffering."
msgstr ""

#: src/2696-debug-map-key-value.md:246
msgid ""
"Another alternative is to avoid panicking if the sequence of entries doesn't "
"follow the expected pattern of `key` then `value`. Instead, `DebugMap` could "
"make a best-effort attempt to represent keys without values and values "
"without keys. However, this approach has the drawback of masking incorrect "
"`Debug` implementations, may produce a surprising output and doesn't reduce "
"the complexity of the implementation (we'd still need to tell whether a key "
"should be followed by a `: ` separator or a `, `)."
msgstr ""

#: src/2696-debug-map-key-value.md:248
msgid "Prior art"
msgstr ""

#: src/2696-debug-map-key-value.md:251
msgid ""
"The `serde::ser::SerializeMap` API (and `libserialize::Encoder` for what "
"it's worth) requires map keys and values can be serialized independently. "
"`SerializeMap` provides a `serialize_entry` method, which is similar to the "
"existing `DebugMap::entry`, but is only supposed to be used as an "
"optimization."
msgstr ""

#: src/2696-debug-map-key-value.md:253
msgid "Unresolved questions"
msgstr ""

#: src/2696-debug-map-key-value.md:256
msgid "Future possibilities"
msgstr ""

#: src/2696-debug-map-key-value.md:259
msgid ""
"The internal implementation could optimize the `entry` method to avoid a few "
"redundant checks."
msgstr ""
