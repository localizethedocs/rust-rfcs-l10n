msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-01T05:53:02Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Language: zh_TW\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/0888-compiler-fence-intrinsics.md:1
msgid "Feature Name: compiler_fence_intrinsics"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:2
msgid "Start Date: 2015-02-19"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:3
msgid ""
"RFC PR: [rust-lang/rfcs#888](https://github.com/rust-lang/rfcs/pull/888)"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:4
msgid ""
"Rust Issue: [rust-lang/rust#24118](https://github.com/rust-lang/rust/"
"issues/24118)"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:6
msgid "Summary"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:8
msgid "Add intrinsics for single-threaded memory fences."
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:10
msgid "Motivation"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:12
msgid ""
"Rust currently supports memory barriers through a set of intrinsics, "
"`atomic_fence` and its variants, which generate machine instructions and are "
"suitable as cross-processor fences. However, there is currently no compiler "
"support for single-threaded fences which do not emit machine instructions."
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:17
msgid ""
"Certain use cases require that the compiler not reorder loads or stores "
"across a given barrier but do not require a corresponding hardware "
"guarantee, such as when a thread interacts with a signal handler which will "
"run on the same thread. By omitting a fence instruction, relatively costly "
"machine operations can be avoided."
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:23
msgid "The C++ equivalent of this feature is `std::atomic_signal_fence`."
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:25
msgid "Detailed design"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:27
msgid "Add four language intrinsics for single-threaded fences:"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:29
msgid "`atomic_compilerfence`"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:30
msgid "`atomic_compilerfence_acq`"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:31
msgid "`atomic_compilerfence_rel`"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:32
msgid "`atomic_compilerfence_acqrel`"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:34
msgid ""
"These have the same semantics as the existing `atomic_fence` intrinsics but "
"only constrain memory reordering by the compiler, not by hardware."
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:37
msgid ""
"The existing fence intrinsics are exported in libstd with safe wrappers, but "
"this design does not export safe wrappers for the new intrinsics. The "
"existing fence functions will still perform correctly if used where a single-"
"threaded fence is called for, but with a slight reduction in efficiency. Not "
"exposing these new intrinsics through a safe wrapper reduces the possibility "
"for confusion on which fences are appropriate in a given situation, while "
"still providing the capability for users to opt in to a single-threaded "
"fence when appropriate."
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:46
msgid "Alternatives"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:48
msgid ""
"Do nothing. The existing fence intrinsics support all use cases, but with a "
"negative impact on performance in some situations where a compiler-only "
"fence is appropriate."
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:52
msgid ""
"Recommend inline assembly to get a similar effect, such as `asm!(\"\" ::: "
"\"memory\" : \"volatile\")`. LLVM provides an IR item specifically for this "
"case (`fence singlethread`), so I believe taking advantage of that feature "
"in LLVM is most appropriate, since its semantics are more rigorously defined "
"and less likely to yield unexpected (but not necessarily wrong) behavior."
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:58
msgid "Unresolved questions"
msgstr ""

#: src/0888-compiler-fence-intrinsics.md:60
msgid ""
"These intrinsics may be better represented with a different name, such as "
"`atomic_signal_fence` or `atomic_singlethread_fence`. The existing "
"implementation of atomic intrinsics in the compiler precludes the use of "
"underscores in their names and I believe it is clearer to refer to this "
"construct as a \"compiler fence\" rather than a \"signal fence\" because not "
"all use cases necessarily involve signal handlers, hence the current choice "
"of name."
msgstr ""
