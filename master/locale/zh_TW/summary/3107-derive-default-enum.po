msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-01T05:53:05Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"Language: zh_TW\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/3107-derive-default-enum.md:1
msgid "Feature Name: `derive_default_enum`"
msgstr ""

#: src/3107-derive-default-enum.md:2
msgid "Start Date: 2021-04-07"
msgstr ""

#: src/3107-derive-default-enum.md:3
msgid ""
"RFC PR: [rust-lang/rfcs#3107](https://github.com/rust-lang/rfcs/pull/3107)"
msgstr ""

#: src/3107-derive-default-enum.md:4
msgid ""
"Rust Issue: [rust-lang/rust#87517](https://github.com/rust-lang/rust/"
"issues/87517)"
msgstr ""

#: src/3107-derive-default-enum.md:6
msgid "Summary"
msgstr "摘要"

#: src/3107-derive-default-enum.md:9
msgid ""
"An attribute `#[default]`, usable on `enum` unit variants, is introduced "
"thereby allowing some enums to work with `#[derive(Default)]`."
msgstr ""

#: src/3107-derive-default-enum.md:24
msgid ""
"The `#[default]` and `#[non_exhaustive]` attributes may not be used on the "
"same variant."
msgstr ""

#: src/3107-derive-default-enum.md:26
msgid "Motivation"
msgstr "動機"

#: src/3107-derive-default-enum.md:29
msgid "`#[derive(Default)]` in more cases"
msgstr ""

#: src/3107-derive-default-enum.md:31
msgid ""
"Currently, `#[derive(Default)]` is not usable on `enum`s. To partially "
"rectify this situation, a `#[default]` attribute is introduced that can be "
"attached to unit variants. This allows you to use `#[derive(Default)]` on "
"enums wherefore you can now write:"
msgstr ""

#: src/3107-derive-default-enum.md:45
msgid "Guide-level explanation"
msgstr ""

#: src/3107-derive-default-enum.md:48
msgid ""
"The ability to add default values to fields of `enum` variants does not mean "
"that you can suddenly `#[derive(Default)]` on the enum. A Rust compiler will "
"still have no idea which variant you intended as the default. This RFC adds "
"the ability to mark one unit variant with `#[default]`:"
msgstr ""

#: src/3107-derive-default-enum.md:62
msgid ""
"Now the compiler knows that `Ingredient::Lettuce` should be considered the "
"default and will accordingly generate an appropriate implementation:"
msgstr ""

#: src/3107-derive-default-enum.md:73
msgid ""
"Note that after any `cfg`\\-stripping has occurred, it is an error to have "
"`#[default]` specified on zero or multiple variants."
msgstr ""

#: src/3107-derive-default-enum.md:76
msgid ""
"As fields may be added to `#[non_exhaustive]` variants that necessitate "
"additional bounds, it is not permitted to place `#[default]` and "
"`#[non_exhaustive]` on the same variant."
msgstr ""

#: src/3107-derive-default-enum.md:79
msgid "Reference-level explanation"
msgstr ""

#: src/3107-derive-default-enum.md:82
msgid "`#[default]` on `enum`s"
msgstr ""

#: src/3107-derive-default-enum.md:84
msgid ""
"An attribute `#[default]` is provided the compiler and may be legally placed "
"solely on one exhaustive `enum` unit variants. The attribute has no "
"semantics on its own. Placing the attribute on anything else will result in "
"a compilation error. Furthermore, if the attribute occurs on zero or "
"multiple variants of the same `enum` data-type after `cfg`\\-stripping and "
"macro expansion is done, this will also result in a compilation error."
msgstr ""

#: src/3107-derive-default-enum.md:90
msgid "`#[derive(Default)]`"
msgstr ""

#: src/3107-derive-default-enum.md:92
msgid ""
"Placing `#[derive(Default)]` on an `enum` named `$e` is permissible if and "
"only if that enum has some variant `$v` with `#[default]` on it. In that "
"event, the compiler shall generate the following: implementation of "
"`Default` where the function `default` is defined as:"
msgstr ""

#: src/3107-derive-default-enum.md:104
msgid "Generated bounds"
msgstr ""

#: src/3107-derive-default-enum.md:106
msgid ""
"As exhaustive unit variants have no inner types, no bounds shall be "
"generated on the derived implementation. For example,"
msgstr ""

#: src/3107-derive-default-enum.md:118
msgid "would generate:"
msgstr ""

#: src/3107-derive-default-enum.md:128
msgid "Interaction with `#[non_exhaustive]`"
msgstr ""

#: src/3107-derive-default-enum.md:130
msgid ""
"The Rust compiler shall not permit `#[default]` and `#[non_exhaustive]` to "
"be present on the same variant. Non-default variants may be "
"`#[non_exhaustive]`, as can the `enum` itself."
msgstr ""

#: src/3107-derive-default-enum.md:133
msgid "Drawbacks"
msgstr ""

#: src/3107-derive-default-enum.md:136
msgid ""
"The usual drawback of increasing the complexity of the language applies. "
"However, the degree to which complexity is increased is not substantial. One "
"notable change is the addition of an attribute for a built-in `#[derive]`, "
"which has no precedent."
msgstr ""

#: src/3107-derive-default-enum.md:140
msgid "Rationale"
msgstr ""

#: src/3107-derive-default-enum.md:143
msgid ""
"The inability to derive `Default` on `enum`s has been noted on a number of "
"occasions, with a common suggestion being to add a `#[default]` attribute "
"(or similar) as this RFC proposes."
msgstr ""

#: src/3107-derive-default-enum.md:146
msgid ""
"\\[IRLO\\] [Request: derive enum's default](https://internals.rust-lang.org/"
"t/request-derive-enums-default/10576?u=jhpratt)"
msgstr ""

#: src/3107-derive-default-enum.md:147
msgid ""
"\\[IRLO\\] [Deriving `Error` (comment)](https://internals.rust-lang.org/t/"
"deriving-error/11894/10?u=jhpratt)"
msgstr ""

#: src/3107-derive-default-enum.md:148
msgid ""
"\\[URLO\\] [Crate for macro for default enum variant](https://users.rust-"
"lang.org/t/crate-for-macro-for-default-enum-variant/44032?u=jhpratt)"
msgstr ""

#: src/3107-derive-default-enum.md:149
msgid ""
"\\[URLO\\] [`#[derive(Default)]` for enum, \\[not\\] only struct](https://"
"users.rust-lang.org/t/derive-default-for-enum-non-only-struct/44046?"
"u=jhpratt)"
msgstr ""

#: src/3107-derive-default-enum.md:156
msgid ""
"In the interest of forwards compatibility, this RFC is limited to only "
"exhaustive unit variants. Were this not the case, adding a field to a "
"`#[non_exhaustive]` variant could lead to more stringent bounds being "
"generated, which is a breaking change. For example,"
msgstr ""

#: src/3107-derive-default-enum.md:160
msgid "A definition of"
msgstr ""

#: src/3107-derive-default-enum.md:172
msgid ""
"would not have any required bounds on the generated code. If this were "
"changed to"
msgstr ""

#: src/3107-derive-default-enum.md:184
msgid ""
"then any code where `T: !Default` would now fail to compile, on the "
"assumption that the generated code for the latter has the `T: Default` bound "
"(nb: not part of this RFC)."
msgstr ""

#: src/3107-derive-default-enum.md:187
msgid "Alternatives"
msgstr ""

#: src/3107-derive-default-enum.md:190
msgid ""
"One alternative is to permit the user to declare the default variant in the "
"derive itself, such as `#[derive(Default(VariantName))]`. This has the "
"disadvantage that the variant name is present in multiple locations in the "
"declaration, increasing the likelihood of a typo (and thus an error)."
msgstr ""

#: src/3107-derive-default-enum.md:194
msgid ""
"Another alternative is assigning the first variant to be default when "
"`#[derive(Default)]` is present. This may prevent a `#[derive(PartialOrd)]` "
"on some `enum`s where order is important (unless the user were to explicitly "
"assign the discriminant)."
msgstr ""

#: src/3107-derive-default-enum.md:198
msgid "Prior art"
msgstr ""

#: src/3107-derive-default-enum.md:201
msgid "Procedural macros"
msgstr ""

#: src/3107-derive-default-enum.md:203
msgid ""
"There are a number of crates which to varying degrees afford macros for "
"default field values and associated facilities."
msgstr ""

#: src/3107-derive-default-enum.md:206
msgid "`#[derive(Derivative)]`"
msgstr ""

#: src/3107-derive-default-enum.md:210
msgid ""
"The crate [`derivative`](https://crates.io/crates/derivative) provides the "
"`#[derivative(Default)]` attribute. With it, you may write:"
msgstr ""

#: src/3107-derive-default-enum.md:222
msgid "Contrast this with the equivalent in the style of this RFC:"
msgstr ""

#: src/3107-derive-default-enum.md:233
msgid ""
"Like in this RFC, `derivative` allows you to derive `Default` for `enum`s. "
"The syntax used in the macro is `#[derivative(Default)]` whereas the RFC "
"provides the more ergonomic and direct notation `#[default]` in this RFC."
msgstr ""

#: src/3107-derive-default-enum.md:237
msgid "`#[derive(SmartDefault)]`"
msgstr ""

#: src/3107-derive-default-enum.md:241
msgid ""
"The [`smart-default`](https://crates.io/crates/smart-default) provides "
"`#[derive(SmartDefault)]` custom derive macro. It functions similarly to "
"`derivative` but is specialized for the `Default` trait. With it, you can "
"write:"
msgstr ""

#: src/3107-derive-default-enum.md:253
msgid ""
"The same syntax `#[default]` is used both by `smart-default` and by this "
"RFC. While it may seem that this RFC was inspired by `smart-default`, this "
"is not the case. Rather, this notation has been independently thought of on "
"multiple occasions. That suggests that the notation is intuitive and a solid "
"design choice."
msgstr ""

#: src/3107-derive-default-enum.md:258
msgid ""
"There is no trait `SmartDefault` even though it is being derived. This works "
"because `#[proc_macro_derive(SmartDefault)]` is in fact not tied to any "
"trait. That `#[derive(Serialize)]` refers to the same trait as the name of "
"the macro is from the perspective of the language's static semantics "
"entirely coincidental."
msgstr ""

#: src/3107-derive-default-enum.md:263
msgid ""
"However, for users who aren't aware of this, it may seem strange that "
"`SmartDefault` should derive for the `Default` trait."
msgstr ""

#: src/3107-derive-default-enum.md:266
msgid "Unresolved questions"
msgstr "未解決的問題"

#: src/3107-derive-default-enum.md:269
msgid "None so far."
msgstr ""

#: src/3107-derive-default-enum.md:271
msgid "Future possibilities"
msgstr ""

#: src/3107-derive-default-enum.md:274
msgid "Non-unit variants"
msgstr ""

#: src/3107-derive-default-enum.md:276
msgid ""
"One significant future possibility is to have `#[default]` permitted on non-"
"unit variants. This was originally proposed as part of this RFC but has been "
"postponed due to disagreement over what the generated bounds should be. This "
"is largely due to the fact that [`#[derive(Default)]` on `struct`s may "
"generate incorrect bounds](https://github.com/rust-lang/rust/issues/26925)."
msgstr ""

#: src/3107-derive-default-enum.md:281
msgid "Overriding default fields"
msgstr ""

#: src/3107-derive-default-enum.md:283
msgid ""
"The `#[default]` attribute could be extended to override otherwise derived "
"default values, such as"
msgstr ""

#: src/3107-derive-default-enum.md:294
msgid "which would result in"
msgstr ""

#: src/3107-derive-default-enum.md:307
msgid "being generated."
msgstr ""

#: src/3107-derive-default-enum.md:309
msgid ""
"Alternatively, dedicated syntax could be provided [as proposed by @Centril]"
"(https://github.com/Centril/rfcs/pull/19):"
msgstr ""

#: src/3107-derive-default-enum.md:321
msgid ""
"If consensus can be reached on desired bounds, there should be no technical "
"restrictions on permitting the `#[default]` attribute on a "
"`#[non_exhaustive]` variant."
msgstr ""

#: src/3107-derive-default-enum.md:324
msgid "Clearer documentation and more local reasoning"
msgstr ""

#: src/3107-derive-default-enum.md:326
msgid ""
"Providing good defaults when such exist is part of any good design that "
"makes a physical tool, UI design, or even data-type more ergonomic and "
"easily usable. However, that does not mean that the defaults provided can "
"just be ignored and that they need not be understood. This is especially the "
"case when you are moving away from said defaults and need to understand what "
"they were. Furthermore, it is not too uncommon to see authors writing in the "
"documentation of a data-type that a certain value is the default."
msgstr ""

#: src/3107-derive-default-enum.md:333
msgid ""
"All in all, the defaults of a data-type are therefore important properties. "
"By encoding the defaults right where the data-type is defined gains can be "
"made in terms of readability particularly with regard to the ease of "
"skimming through code. In particular, it is easier to see what the default "
"variant is if you can directly look at the `rustdoc` page and read the "
"previous snippet, which would let you see the default variant without having "
"to open up the code of the `Default` implementation."
msgstr ""

#: src/3107-derive-default-enum.md:339
msgid "`Error` trait and more"
msgstr ""

#: src/3107-derive-default-enum.md:341
msgid ""
"As this is the first derive macro that includes an attribute, this may open "
"the flood gates with regard to permitting additional macros with attributes. "
"Crates such as `thiserror` could be, in some form or another, upstreamed to "
"the standard library as `#[derive(Error)]`, `#[derive(Display)]` or more."
msgstr ""
