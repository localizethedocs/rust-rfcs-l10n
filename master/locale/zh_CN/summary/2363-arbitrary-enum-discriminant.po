msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-01T05:53:04Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"Language: zh_CN\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/2363-arbitrary-enum-discriminant.md:1
msgid "Feature Name: `arbitrary_enum_discriminant`"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:2
msgid "Start Date: 2018-03-11"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:3
msgid ""
"RFC PR: [rust-lang/rfcs#2363](https://github.com/rust-lang/rfcs/pull/2363)"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:4
msgid ""
"Rust Issue: [rust-lang/rust#60553](https://github.com/rust-lang/rust/"
"issues/60553)"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:6
msgid "Summary"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:9
msgid ""
"This RFC gives users a way to control the discriminants of variants of all "
"enumerations, not just the ones that are shaped like C-like enums (i.e. "
"where all the variants have no fields)."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:13
msgid ""
"The change is minimal: allow any variant to be adorned with an explicit "
"discriminant value, whether or not that variant has any field."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:16
msgid "Motivation"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:19
msgid ""
"Stylo, the style system of Servo, represents CSS properties with a large "
"enumeration `PropertyDeclaration` where each variant has only one field "
"which represents the value of a given CSS property. Here is a subset of it:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:33
msgid ""
"For various book-keeping reasons, Servo also generates a `LonghandId` "
"enumeration with the same variants as `PropertyDeclaration` but without the "
"fields, thus making `LonghandId` a C-like enumeration:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:48
msgid ""
"Given that rustc guarantees that `#[repr(u16)]` enumerations start with "
"their discriminant stored as a `u16`, going from `&PropertyDeclaration` to "
"`LonghandId` is then just a matter of unsafely coercing `&self` as a "
"`&LonghandId`:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:61
msgid ""
"This works great, but doesn't scale if we want to replicate this behaviour "
"for an enumeration that is a subset of `PropertyDeclaration`, for example an "
"enumeration `AnimationValue` that is limited to animatable properties:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:75
msgid ""
"// We can't just unsafely read `&self` as a `&LonghandId` because\n"
"        // the discriminant of `AnimationValue::TransformOrigin` isn't "
"equal\n"
"        // to `LonghandId::TransformOrigin` anymore.\n"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:87
msgid ""
"This is not sustainable, as the jump table generated by rustc to compile "
"this huge match expression is larger than 4KB in the final Gecko binary, "
"when this operation could be a trivial `u16` copy. This is worked around in "
"Servo by generating spurious `Void` variants for the non-animatable "
"properties in `AnimationValue`:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:106
#: src/2363-arbitrary-enum-discriminant.md:150
msgid "// We can use the unsafe trick again.\n"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:112
msgid ""
"This is unfortunately quite painful to use, given now all methods matching "
"against `AnimationValue` need to have dummy arms for all of these variants:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:125
msgid "// This shouldn't be needed.\n"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:137
msgid ""
"We suggest generalising the explicit discriminant notation to all enums, "
"regardless of whether their variants have fields or not:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:155
msgid "// No spurious variant anymore.\n"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:171
msgid "Guide-level explanation"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:174
msgid ""
"An enumeration with only field-less variants can currently have explicit "
"discriminant values:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:185
msgid ""
"With this RFC, users are allowed to put explicit discriminant values on any "
"variant of any enumeration, not just the ones where all variants are field-"
"less:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:196
msgid "Reference-level explanation"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:199
msgid "Grammar"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:201
msgid "The production for enumeration items becomes:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:209
msgid "Semantics"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:211
msgid ""
"The limitation that only field-less enumerations can have explicit "
"discriminant values is lifted, and no other change is made to their "
"semantics:"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:214
msgid ""
"enumerations with fields still can't be casted to numeric types with the "
"`as` operator;"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:216
msgid ""
"if the first variant doesn't have an explicit discriminant, it is set to "
"zero;"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:218
msgid ""
"any unspecified discriminant is set to one higher than the one from the "
"previous variant;"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:220
msgid ""
"under the default representation, the specified discriminants are "
"interpreted as `isize`;"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:222
msgid "two variants cannot share the same discriminant."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:224
msgid "Drawbacks"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:227
msgid "This introduces one more knob to the representation of enumerations."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:229
msgid "Rationale and alternatives"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:232
msgid ""
"Reusing the current syntax and semantics for explicit discriminants of field-"
"less enumerations means that the changes to the grammar and semantics of the "
"language are minimal. There are a few possible alternatives nonetheless."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:236
msgid "Discriminant values in attributes"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:238
msgid ""
"We could specify the discriminant values in variant attributes, but this "
"would be at odds with the syntax for field-less enumerations."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:252
msgid "Use discriminants of a separate field-less enumeration"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:254
msgid ""
"We could tell rustc to tie the discriminants of the enumeration to the "
"variants of a separate field-less enumeration."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:272
msgid ""
"This isn't applicable if such a separate field-less enumeration doesn't "
"exist, and this can easily be done as a procedural macro using the feature "
"described in this RFC. It also looks way more like spooky action at a "
"distance."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:276
msgid "Prior art"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:279
msgid "No prior art."
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:281
msgid "Unresolved questions"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:284
msgid ""
"Should discriminants of enumerations with fields be specified as variant "
"attributes?"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:286
msgid "Should they?"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:288
msgid "Should this apply only to enumerations with an explicit representation?"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:290
msgid "Should it?"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:292
msgid "Thanks"
msgstr ""

#: src/2363-arbitrary-enum-discriminant.md:294
msgid ""
"Thanks to Mazdak Farrokhzad (@Centril) and Simon Sapin (@SimonSapin) for the "
"reviews, and my local bakery for their delicious baguettes. ðŸ¥–"
msgstr ""
