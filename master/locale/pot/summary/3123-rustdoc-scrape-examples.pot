msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-01T05:53:05Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Language: en\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/3123-rustdoc-scrape-examples.md:1
msgid "Feature Name: `rustdoc_scrape_examples`"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:2
msgid "Start Date: 2021-05-09"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:3
msgid ""
"RFC PR: [rust-lang/rfcs#3123](https://github.com/rust-lang/rfcs/pull/3123)"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:4
msgid ""
"Rust Issue: [rust-lang/rust#88791](https://github.com/rust-lang/rust/"
"issues/88791)"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:6
msgid "Summary"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:9
msgid ""
"This RFC proposes an extension to Rustdoc that automatically scrapes code "
"examples from the project's `examples/` directory."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:11
msgid ""
"Check out a live demo here: https://willcrichton.net/example-analyzer/warp/"
"trait.Filter.html#method.and"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:13
msgid "Motivation"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:16
msgid ""
"Code examples are an important tool for programmers to understand how a "
"library works. Examples are **concrete** and **contextual**: they reference "
"actual values rather than abstract parameters, and they show how to use a "
"function in the context of the code around it."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:18
msgid ""
"As a parable of the value of examples, I recently did a small user study "
"where I observed two Rust programmers learning to use the [warp](https://"
"github.com/seanmonstar/warp) library for a basic task. Warp is designed "
"around a generic [`Filter`](https://docs.rs/warp/0.3.1/warp/trait.Filter."
"html) abstraction. Both participants found the documentation for `Filter` "
"methods to be both imposing and too generic to be useful. For instance, "
"[`Filter::and`](https://docs.rs/warp/0.3.1/warp/trait.Filter.html#method."
"and):"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:23
msgid ""
"The repo authors also included a code example. But neither participant could "
"understand the example because it lacked context."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:27
msgid ""
"The participant who was less familiar with Rust struggled to read the "
"documentation and failed to accomplish the task. By contrast, the "
"participant who was more familiar with Rust knew to look in the `examples/` "
"directory, where they found a wealth of examples for each function that "
"complemented the documentation. For instance, [`rejection.rs`](https://"
"github.com/seanmonstar/warp/blob/bf8bfc4134035dbff882f9b26cb9d1aa57f2c338/"
"examples/rejections.rs) shows the usage of `and` in combination with `map`:"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:30
msgid "\"math\""
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:36
msgid "\"{} / {}\""
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:42
msgid ""
"The goal of this RFC is to bridge the gap between automatically generated "
"documentation and code examples by helping users find relevant examples "
"within Rustdoc."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:44
msgid "Guide-level explanation"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:47
msgid ""
"The `scrape-examples` feature of Rustdoc finds examples of code where a "
"particular function is called. For example, if we are documenting [`Filter::"
"and`](https://willcrichton.net/example-analyzer/warp/trait.Filter."
"html#method.and), and a file [`examples/returning.rs`](https://github.com/"
"seanmonstar/warp/tree/bf8bfc4134035dbff882f9b26cb9d1aa57f2c338/examples/"
"returning.rs) contains a call to `and`, then the corresponding Rustdoc "
"documentation looks like this:"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:53
msgid ""
"After the user-provided documentation in the doc-comment, `scrape-examples` "
"inserts a code example (if one exists). The code example shows a window into "
"the source file with the function call highlighted in yellow. The icons in "
"the top-right of the code viewer allow the user to expand the code sample to "
"the full file, or to navigate through other calls in the same file. The link "
"above the example goes to the full listing in Rustdoc's generated `src/` "
"directory, similar to other `[src]` links."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:55
msgid ""
"Additionally, the user can click \"More examples\" to see every example from "
"the `examples/` directory, like this:"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:59
msgid ""
"To use the `scrape-examples` feature, simply add the `--scrape-examples` "
"flag like so:"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:66
msgid "Reference-level explanation"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:68
msgid ""
"I have implemented a prototype of the `scrape-examples` feature as "
"modifications to rustdoc and cargo. You can check out the draft PRs:"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:69
msgid "rustdoc: https://github.com/rust-lang/rust/pull/85833"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:70
msgid "cargo: https://github.com/rust-lang/cargo/pull/9525"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:72
msgid ""
"The feature uses the following high-level flow, with some added technical "
"details as necessary."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:74
msgid "The user gives `--scrape-examples` as an argument to `cargo doc`."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:75
msgid ""
"Cargo runs the equivalent of `cargo rustdoc --examples` ([source](https://"
"github.com/willcrichton/cargo/blob/9c9f86772cbcf49f77119b7471021989e72c9936/"
"src/cargo/ops/cargo_compile.rs#L596-L655))."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:76
msgid ""
"Specifically, when constructing the `BuildContext`, Cargo will now "
"recursively invoke `rustdoc` on all files matching the `--examples` filter."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:77
msgid ""
"Each invocation includes a flag `--scrape-examples <output path>` which "
"directs rustdoc to output to a file at the specific location."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:78
msgid ""
"An instance of rustdoc runs for each example, finding all call-sites and "
"exporting them to a JSON file ([source](https://github.com/willcrichton/rust/"
"blob/20044cd72dc220e787b081ae2139df49c2320471/src/librustdoc/scrape_examples."
"rs))."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:79
msgid ""
"A visitor runs over the HIR to find call sites that resolve to a specific "
"linkable function."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:80
msgid ""
"As a part of this pass, rustdoc also generates source files for the "
"examples, e.g. `target/doc/src/example/foo.rs`. These are then linked to "
"during rendering."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:81
msgid ""
"The format of the generated JSON is `{function: {file: {locations: [list of "
"spans], other metadata}}}`. See the [`AllCallLocations`](https://github.com/"
"willcrichton/rust/blob/20044cd72dc220e787b081ae2139df49c2320471/src/"
"librustdoc/scrape_examples.rs#L24-L32) type."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:82
msgid ""
"Rustdoc is then invoked as normal for the package being documented, except "
"with the added flags `--with-examples <path/to/json>` for each generated "
"JSON file. Rustdoc reads the JSON data from disk and stores them in "
"`RenderOptions`."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:83
msgid ""
"Rustdoc renders the call locations into the HTML ([source](https://github."
"com/willcrichton/rust/blob/20044cd72dc220e787b081ae2139df49c2320471/src/"
"librustdoc/html/render/mod.rs#L2433-L2508))."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:84
msgid ""
"This involves reading the source file from disk to embed the example into "
"the page."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:85
msgid ""
"Rustdoc's Javascript adds interactivity to the examples when loaded ([source]"
"(https://github.com/willcrichton/rust/"
"blob/20044cd72dc220e787b081ae2139df49c2320471/src/librustdoc/html/static/"
"main.js#L965-L1135))."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:86
msgid ""
"Most of the logic here is to extend the code viewer with additional features "
"like toggling between snippet / full file, navigating between call sites, "
"and highlighting code in-situ."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:88
msgid ""
"The primary use case for this will be on docs.rs. My expectation is that "
"docs.rs would use the `--scrape-examples` flag, and all docs hosted there "
"would have the scraped examples."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:90
msgid "Drawbacks"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:93
msgid ""
"I think the biggest drawback of this feature is that it adds further "
"complexity to the Rustdoc interface. Rustdoc already includes a lot of "
"information, and a concern is that this feature would overload users, "
"especially Rust novices."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:94
msgid ""
"This feature requires pre-loading a significant amount of information into "
"the HTML pages. If we want to keep the \"view whole file\" feature, then the "
"entire source code of every referenced example would be embedded into every "
"page. This will increase the size of the generated files and hence increase "
"page load times."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:95
msgid ""
"This feature requires adding more functionality to both Cargo and Rustdoc, "
"increasing the complexity of both tools."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:97
msgid "Rationale and alternatives"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:100
msgid ""
"At the highest-level, this tool could be built separately from Rustdoc as an "
"independent database mapping functions to examples. I believe it's "
"preferable to have the function -> example connections integrated into "
"Rustdoc so people need as few tools as possible to understand Rust "
"libraries. Moreover, Rustdoc-generated pages are the main results that "
"appear in Google when searching for help with Rust libraries, so it's the "
"easiest for programmers to find."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:101
msgid ""
"At the lower-level, this feature could be implemented in alternative "
"interfaces. For instance, examples could be a separate part of the Rustdoc "
"interface. I'm not sure what this interface would look like -- having the "
"examples be inline was the only sensible interface I could imagine."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:103
msgid "See \"Unresolved questions\" for more discussion of the design space."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:105
msgid "Prior art"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:108
msgid ""
"I have never seen a documentation generator with this exact feature before. "
"There has been some HCI research like [Jadeite](https://dl.acm.org/doi/"
"pdf/10.1145/1520340.1520678) and [Apatite](https://dl.acm.org/doi/"
"pdf/10.1145/1753326.1753525) that use code examples to augment generated "
"documentation, e.g. by sorting methods in order of usage. Other research "
"prototypes have clustered code examples to show broad usage patterns, e.g. "
"[Examplore](https://dl.acm.org/doi/pdf/10.1145/3173574.3174154)."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:110
msgid "Unresolved questions"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:113
msgid ""
"The main unresolved questions are about the UI: what is the best UI to show "
"the examples inline? My prototype represents my best effort at a draft, but "
"I'm open to suggestions. For example:"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:115
msgid ""
"Is showing 1 example by default the best idea? Or should scraped examples be "
"hidden by default?"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:116
msgid ""
"Is the ability to see the full file context worth the increase in page size?"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:117
msgid ""
"How should the examples be ordered? Is there a way to determine the \"best\" "
"examples to show first?"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:120
msgid "Future possibilities"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:123
msgid "To my mind, the main future extensions of this feature are:"
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:124
msgid ""
"**More examples:** examples can be scraped from the codebase itself (e.g. "
"this would be very useful for developers on large code bases like rustc ), "
"or scraped from the ecosystem at large."
msgstr ""

#: src/3123-rustdoc-scrape-examples.md:125
msgid ""
"**Ordering examples:** with more examples comes the question of how to "
"present them all to the user. If there are too many examples, say >10, there "
"should be a way to maximize the diversity of the examples (or something like "
"that)."
msgstr ""
