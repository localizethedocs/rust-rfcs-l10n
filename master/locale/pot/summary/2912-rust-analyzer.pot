msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-22T09:04:45Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"Language: en\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/2912-rust-analyzer.md:1
msgid "Feature Name: (fill me in with a unique ident, `my_awesome_feature`)"
msgstr ""

#: src/2912-rust-analyzer.md:2
msgid "Start Date: 2020-04-20"
msgstr ""

#: src/2912-rust-analyzer.md:3
msgid ""
"RFC PR: [rust-lang/rfcs#2912](https://github.com/rust-lang/rfcs/pull/2912)"
msgstr ""

#: src/2912-rust-analyzer.md:4
msgid ""
"Rust Issue: [rust-analyzer/rust-analyzer#4224](https://github.com/rust-"
"analyzer/rust-analyzer/issues/4224)"
msgstr ""

#: src/2912-rust-analyzer.md:6
msgid "Summary"
msgstr ""

#: src/2912-rust-analyzer.md:9
msgid ""
"The RFC proposes a plan to adopt rust-analyzer as Rust's official LSP "
"implementation. The transition to rust-analyzer will take place in a few "
"stages:"
msgstr ""

#: src/2912-rust-analyzer.md:11
msgid ""
"**Feedback** -- encourage people to use rust-analyzer and report problems"
msgstr ""

#: src/2912-rust-analyzer.md:12
msgid ""
"**Deprecation period** -- announce that the RLS is deprecated and encourage "
"people to migrate to rust-analyzer"
msgstr ""

#: src/2912-rust-analyzer.md:13
msgid "**Final transition** -- stop supporting the older RLS"
msgstr ""

#: src/2912-rust-analyzer.md:15
msgid ""
"As detailed below, one major concern with rust-analyzer as it stands today "
"is that it shares very little code with rustc. To avoid creating an "
"unsustainable maintenance burden, this RFC proposes extracting shared "
"libraries that will be used by both rustc and rust-analyzer (\"library-"
"ification\"), which should eventually lead to rustc and rust-analyzer being "
"two front-ends over a shared codebase."
msgstr ""

#: src/2912-rust-analyzer.md:17
msgid "Motivation"
msgstr ""

#: src/2912-rust-analyzer.md:20
msgid "Current status: RLS and rust-analyzer"
msgstr ""

#: src/2912-rust-analyzer.md:22
msgid ""
"Currently, Rust users who wish to use an editor that supports Microsoft's "
"Language Server Protocol (LSP) have two choices:"
msgstr ""

#: src/2912-rust-analyzer.md:24
msgid "Use the RLS, the official IDE project of the Rust language."
msgstr ""

#: src/2912-rust-analyzer.md:25
msgid ""
"Use rust-analyzer, a more experimental, unofficial project that has recently "
"been gaining ground."
msgstr ""

#: src/2912-rust-analyzer.md:27
msgid ""
"Ideally, we would like to concentrate our efforts behind a single "
"implementation."
msgstr ""

#: src/2912-rust-analyzer.md:29
msgid "Architectural divide: save-analysis vs on-demand queries"
msgstr ""

#: src/2912-rust-analyzer.md:31
msgid ""
"The key technical difference between these two projects is that the RLS is "
"based around rustc's \"save-analysis\" data, which basically means that the "
"compiler -- after compilation -- can dump all sorts of of information about "
"the code that it compiles into files. These files can be loaded by the RLS "
"and used to do things like display errors, handle jump-to-definition, and "
"other sorts of things. This architecture has the advantage that it builds on "
"rustc itself, so it is generally up-to-date and accurate. However, "
"generating save-analysis files is slow, and the architecture is not "
"considered suitable for handling things like completions, where latency is "
"at a premium."
msgstr ""

#: src/2912-rust-analyzer.md:33
msgid ""
"In contrast, rust-analyzer effectively reimplements the Rust compiler in a "
"fully incremental, on-demand style. This is the same architecture that rustc "
"has been slowly evolving towards. This architecture enables much faster "
"response time and it can also (in principle) handle things like fully type-"
"correct completions. However, because rust-analyzer is not complete, it is "
"currently not able to offer several key features, such as reporting errors "
"or doing precise \"find all usages\"."
msgstr ""

#: src/2912-rust-analyzer.md:35
msgid ""
"Even in its current, experimental form, many users derive value from rust-"
"analyzer. Many users are using it as their day-to-day IDE. It is "
"particularly useful for larger codebases, such as the compiler."
msgstr ""

#: src/2912-rust-analyzer.md:37
msgid "Challenges to overcome"
msgstr ""

#: src/2912-rust-analyzer.md:39
msgid ""
"There are several things that we would like to improve about the current "
"situation:"
msgstr ""

#: src/2912-rust-analyzer.md:41
msgid ""
"We would like to concentrate our efforts behind one LSP server, not support "
"both the RLS and rust-analyzer."
msgstr ""

#: src/2912-rust-analyzer.md:42
msgid ""
"Further, the goal for some time has been to adopt a query-based architecture "
"much like the one that rust-analyzer is using."
msgstr ""

#: src/2912-rust-analyzer.md:43
msgid ""
"We would like to (eventually) avoid having two implementations of the Rust "
"compiler to support, one in rustc and one in rust-analyzer."
msgstr ""

#: src/2912-rust-analyzer.md:44
msgid ""
"We would like to \"pay down\" technical debt within the compiler itself and "
"to make it approachable."
msgstr ""

#: src/2912-rust-analyzer.md:45
msgid ""
"To that end, we've been pursuing the creation of independent libraries, like "
"miri or chalk. Smaller libraries with stronger API boundaries are not only "
"easier to reason about but also provide an easier way for people to get "
"involved in compiler development."
msgstr ""

#: src/2912-rust-analyzer.md:47
msgid ""
"However, in making the transition from the existing RLS setup to rust-"
"analyzer, we have to be careful not to introduce user confusion. In "
"particular, we wish to make the experience of \"managing one's editor\" "
"smooth, both for:"
msgstr ""

#: src/2912-rust-analyzer.md:49
msgid ""
"Existing RLS users (who need to transition from the RLS to rust-analyzer), "
"and"
msgstr ""

#: src/2912-rust-analyzer.md:50
msgid ""
"New Rust users (who need to find and install rust-analyzer for the first "
"time)."
msgstr ""

#: src/2912-rust-analyzer.md:52
msgid ""
"Separate goal: making the compiler more approachable via 'library-ification'"
msgstr ""

#: src/2912-rust-analyzer.md:54
msgid ""
"Independently from IDEs, The compiler team has been pursuing a process of "
"\"library-ification\", meaning converting rustc from a monolithic codebase "
"into one with well-defined libraries and reasonably stable API boundaries. "
"You can find more details in the [design meeting from 2019-09-13](https://"
"rust-lang.github.io/compiler-team/minutes/design-meeting/2019-09-13-rust-"
"analyzer-and-libraryification/). The goal is ultimately for both rustc and "
"rust-analyzer to be shallow wrappers around the same core codebases, as well "
"as to improve the accessibility of the rustc codebase by having well-defined "
"modules that can be learned independently."
msgstr ""

#: src/2912-rust-analyzer.md:58
msgid ""
"As of today, rust-analyzer and rustc share the same lexer, which was "
"extracted from rustc as part of this process. Meanwhile, rust-analyzer "
"relies on [chalk](https://github.com/rust-lang/chalk) for its trait solving, "
"and efforts are underway to integrate chalk into rustc and thus have a "
"shared trait solver. Similarly, we are working to [extract a common library "
"for representing types](https://rust-lang.github.io/compiler-team/minutes/"
"design-meeting/2020-03-12-shared-library-for-types/)."
msgstr ""

#: src/2912-rust-analyzer.md:63
msgid ""
"Observation: the needs of batch compilation and the needs of an IDE are not "
"always the same"
msgstr ""

#: src/2912-rust-analyzer.md:65
msgid ""
"One observation that we have seen over time is that batch compilation and "
"IDE interaction have somewhat different needs. We would like to share as "
"much code as possible, but we might like to specialize some aspects of it."
msgstr ""

#: src/2912-rust-analyzer.md:67
msgid ""
"For example, the compiler currently interns all of its types and frees them "
"all at once at the end of compilation. This is highly efficient but not "
"necessarily appropriate for a long-lived process, as over time it can lead "
"to very high memory usage. An IDE, in contrast, might prefer to use a "
"different strategy such as ref-counting or even garbage collection."
msgstr ""

#: src/2912-rust-analyzer.md:69
msgid ""
"Similarly, in rustc, we have been moving towards a model where the "
"dependency graph between queries is streamed out to the disk as soon as it "
"is generated, and never stored in memory. This is because the dependency "
"information is only needed when you start the _next_ compilation. But in an "
"IDE, that dependency information is needed as soon as the next keypress, and "
"hence it doesn't make sense to stream it to disk."
msgstr ""

#: src/2912-rust-analyzer.md:71
msgid ""
"Library-ification can address these concerns by two distinct \"host "
"processes\" that make use of shared libraries differently. In the case of "
"types, for example, we can be generic over whether types are interned or "
"stored in some other sort of pointer. Similarly, the query infrastructure "
"might have two modes or implementation strategies."
msgstr ""

#: src/2912-rust-analyzer.md:73
msgid "Guide-level explanation"
msgstr ""

#: src/2912-rust-analyzer.md:76
msgid ""
"The high-level plan is effectively to adopt rust-analyzer as the primary LSP "
"implementation for the Rust project, and to aggressively pursue 'library-"
"ification' as a means to eliminate code duplication. The ultimate vision is "
"that the majority of the compiler logic should live in shared libraries "
"which have two \"front-ends\", one from rustc and one from rust-analyzer."
msgstr ""

#: src/2912-rust-analyzer.md:78
msgid "Adopting rust-analyzer as the primary LSP implementation"
msgstr ""

#: src/2912-rust-analyzer.md:80
msgid "Installing rust-analyzer today"
msgstr ""

#: src/2912-rust-analyzer.md:82
msgid ""
"Today, [to install rust-analyzer for VSCode](https://rust-analyzer.github.io/"
"manual.html#installation), one simply installs the rust-analyzer plugin. The "
"plugin will download the rust-analyzer LSP implementation and automatically "
"keep it up to date (currently on a once-per-week release cadence). The "
"plugin also adds the `rust-src` component to rustup."
msgstr ""

#: src/2912-rust-analyzer.md:86
msgid ""
"The experience of installing rust-analyzer for other editors is more varied. "
"Currently, the rust-analyzer project only directly supports VSCode, while "
"other editor plugins are maintained independently. During this period where "
"rust-analyzer is still under heavy development, this makes sense. As rust-"
"analyzer matures, we may wish to re-evaluate and contribute directly to "
"their development or maintain them within the rust-lang org."
msgstr ""

#: src/2912-rust-analyzer.md:88
msgid "Timeline for transition"
msgstr ""

#: src/2912-rust-analyzer.md:90
msgid "Transition will occur in three phases:"
msgstr ""

#: src/2912-rust-analyzer.md:92
msgid ""
"**Feedback:** During this first phase, we will post a blog post encouraging "
"RLS users to try out rust-analyzer and see whether it works for them. If we "
"encounter unexpected, blocking issues, or cases where people feel rust-"
"analyzer is a significant step backward in their user experience, we may try "
"to fix those issues before fully replacing the existing RLS."
msgstr ""

#: src/2912-rust-analyzer.md:93
msgid ""
"**Deprecation period:** We announce that support for the RLS is deprecated. "
"We begin putting in place the tooling to transition existing users away from "
"the RLS."
msgstr ""

#: src/2912-rust-analyzer.md:94
msgid ""
"**Final transition:** We no longer support the RLS plugin in its older form "
"and no longer distribute RLS over rustup."
msgstr ""

#: src/2912-rust-analyzer.md:96
msgid "How will rust-analyzer binaries be distributed"
msgstr ""

#: src/2912-rust-analyzer.md:98
msgid ""
"Presently, rust-analyzer binaries are distributed on a weekly basis by the "
"rust-analyzer project. The plugin detects when new releases are available "
"and automatically upgrades. We expect to transition that binary distribution "
"to use rustup. This change to use rustup should occur during the feedback "
"period."
msgstr ""

#: src/2912-rust-analyzer.md:100
msgid "Conformance to the LSP protocol"
msgstr ""

#: src/2912-rust-analyzer.md:102
msgid ""
"Before the deprecation period begins, rust-analyzer should fully conform to "
"the LSP protocol."
msgstr ""

#: src/2912-rust-analyzer.md:104
msgid ""
"Furthermore, rust-analyzer sometimes adds extensions to the core LSP "
"protocol, to enable features that the core LSP does not yet support. Some "
"examples include:"
msgstr ""

#: src/2912-rust-analyzer.md:108
msgid ""
"running specific tests (https://github.com/microsoft/language-server-"
"protocol/issues/944)"
msgstr ""

#: src/2912-rust-analyzer.md:109
msgid ""
"inlay hints (https://github.com/microsoft/vscode-languageserver-node/"
"pull/609)"
msgstr ""

#: src/2912-rust-analyzer.md:111
msgid ""
"In some cases, these extensions go on to become part of the standard "
"protocol, as happened with these two extensions:"
msgstr ""

#: src/2912-rust-analyzer.md:114
msgid ""
"extend selection (https://github.com/microsoft/language-server-protocol/"
"issues/613)"
msgstr ""

#: src/2912-rust-analyzer.md:115
msgid ""
"syntax highlighting (https://github.com/microsoft/vscode-languageserver-node/"
"issues/576)"
msgstr ""

#: src/2912-rust-analyzer.md:117
msgid ""
"rust-analyzer will document the status and stability of these extensions. "
"Further, disruptive or unstable extensions will be made opt-in (via client "
"settings) until they are suitable for wider use. However, we do not consider "
"it a \"semver violation\" to remove support for extensions if they don't "
"seem to be working out, as the LSP protocol already permits a negotiation "
"between client and server with respect to which extensions are supported."
msgstr ""

#: src/2912-rust-analyzer.md:125
msgid "What is the transition plan?"
msgstr ""

#: src/2912-rust-analyzer.md:127
msgid ""
"The precise transition plan is not part of this RFC. It will be determined "
"and announced as we enter the deprecation period, based on the feedback "
"we've gotten and how many users have manually transitioned away from the "
"RLS. We will endeavor to keep the experience as smooth as possible, but it "
"may require some manual steps."
msgstr ""

#: src/2912-rust-analyzer.md:129
msgid "Branding: how to talk about rust-analyzer/RLS going forward?"
msgstr ""

#: src/2912-rust-analyzer.md:131
msgid ""
"We propose to keep the \"rust-analyzer\" name, at least for the transition "
"period."
msgstr ""

#: src/2912-rust-analyzer.md:132
msgid ""
"In keeping with the [proposed rust-lang github access policy](https://github."
"com/rust-lang/rfcs/pull/2872), the repositories from the [rust-analyzer "
"github org](https://github.com/rust-analyzer) will be consolidated and then "
"merged into the [rust-lang github org](https://github.com/rust-lang)."
msgstr ""

#: src/2912-rust-analyzer.md:133
msgid ""
"They will be maintained by the compiler team with a dedicated working group."
msgstr ""

#: src/2912-rust-analyzer.md:134
msgid ""
"The infra team will work with rust-analyzer to integrate the binary release "
"and upgrade process"
msgstr ""

#: src/2912-rust-analyzer.md:135
msgid ""
"The [rust-analyzer.github.io](https://rust-analyzer.github.io/) website will "
"redirect to `rust-lang.github.io/rust-analyzer`."
msgstr ""

#: src/2912-rust-analyzer.md:137
msgid "Drawbacks"
msgstr ""

#: src/2912-rust-analyzer.md:140
msgid ""
"The primary drawback to the plan is that, in the short term, rust-analyzer "
"and rustc represent two distinct codebases performing essentially the same "
"function. We do hope to rectify this by extracting shared libraries that "
"both can use but this will take some time. In the meantime, we'll have to "
"support them both. This could mean that there is more of a \"lag\" between "
"rustc gaining support for some new syntax and that same support making its "
"way into the IDE."
msgstr ""

#: src/2912-rust-analyzer.md:142
msgid ""
"A secondary drawback is that rust-analyzer today sometimes uses approximate "
"answers where the current RLS is able to offer precise results. This can "
"occur, for example, with jump to definition. This situation will continue to "
"be the case until we make progress on library-ification of parsing and name "
"resolution."
msgstr ""

#: src/2912-rust-analyzer.md:144
msgid ""
"More generally, switching the official IDE from RLS to rust-analyzer will "
"incur tooling churn on users, and would not be strictly better in the short "
"term (although the expectation is that it will be significantly better on "
"average)."
msgstr ""

#: src/2912-rust-analyzer.md:146
msgid "Rationale and alternatives"
msgstr ""

#: src/2912-rust-analyzer.md:149
msgid "Reimplement rust-analyzer within rustc"
msgstr ""

#: src/2912-rust-analyzer.md:151
msgid ""
"The primary alternative considered was to halt work on rust-analyzer and "
"instead attempt to port the lessons from its development to rustc. In "
"effect, the idea would be to create a LSP server based on rustc itself."
msgstr ""

#: src/2912-rust-analyzer.md:153
msgid ""
"The primary appeal of this plan is that there would always be a single "
"codebase. Moreover, the fundamental architecture of rustc has been moving "
"steadily towards the demand-driven, IDE-friendly design that rust-analyzer "
"has also adopted (the two have indeed influenced one another), so this would "
"be a natural extension of that work."
msgstr ""

#: src/2912-rust-analyzer.md:155
msgid ""
"However, there are a number of practical concerns with taking that approach. "
"One concern is that, for rust-analyzer's current users, it would represent a "
"regression. rust-analyzer would no longer be available (or at least no "
"longer updated) and it would take some time until rustc is at feature "
"parity. Moreover, experience has shown that refactoring rustc can move "
"relatively slowly, simply due to the age of the codebase, the amount of code "
"involved, and the complicated non-standard build process."
msgstr ""

#: src/2912-rust-analyzer.md:157
msgid ""
"Further, the \"reimplement\" approach would represent a constraint on the "
"ordering in which we do our work. With the design proposed in this RFC, for "
"example, rust-analyzer is able to make use of the chalk library already. "
"This is only possible because rust-analyzer has a \"stub\" version of Rust's "
"name resolution engine and type checker embedded in it -- this type checker "
"is not perfect, but it's good enough to drive chalk and gain useful "
"experience. This allows us to create an end-to-end IDE user experience "
"sooner, in effect."
msgstr ""

#: src/2912-rust-analyzer.md:159
msgid ""
"In contrast, if we were to try and rebuild rust-analyzer within rustc, even "
"if we had rustc adopt chalk or some other IDE-friendly trait resolution "
"algorithm, that would not be of use to IDE users until we had also upgraded "
"the name resolution algorithm and type checker to be IDE friendly. In short, "
"having a \"prototype\" version of these algorithms that lives in rust-"
"analyzer is both a pro and a con: it means we have to maintain two versions, "
"but it means users get benefits faster and developers can experiment more "
"freely."
msgstr ""

#: src/2912-rust-analyzer.md:161
msgid "Require feature parity between the existing RLS and rust-analyzer"
msgstr ""

#: src/2912-rust-analyzer.md:163
msgid ""
"One of the key points in this RFC is that feature parity with RLS is not "
"strictly required. While rust-analyzer offers a number of things that the "
"RLS does not support, there are three specific ways that it lags behind:"
msgstr ""

#: src/2912-rust-analyzer.md:165
msgid "It does not support reporting errors or lints without saving"
msgstr ""

#: src/2912-rust-analyzer.md:166
msgid ""
"It does not support precise find-all-usages, goto-definition, or renames, in "
"some cases falling back to approximations."
msgstr ""

#: src/2912-rust-analyzer.md:167
msgid ""
"It does not persist data to disk, which can lead to large startup times."
msgstr ""

#: src/2912-rust-analyzer.md:169
msgid ""
"The reasons behind these limitations are that it will take some time to "
"implement those features \"the right way\" (i.e., using the demand-driven "
"approach that rust-analyzer is pioneering). Initially, we expected to "
"require full feature parity, but we realized that this would lead to us "
"creating \"throwaway\" code to temporarily patch over the limitation, and "
"that this would in turn slow the progress towards our ultimate goals. "
"Therefore, we decided not to require this, but instead to opt for a "
"\"feedback\" period to assess the biggest pain points and see what we can do "
"to relieve them."
msgstr ""

#: src/2912-rust-analyzer.md:171
msgid "Prior art"
msgstr ""

#: src/2912-rust-analyzer.md:174
msgid ""
"The current proposal is informed by experience with existing RLS and query-"
"based compilation in rustc. Additionally, rust-analyzer heavily draws from "
"lessons learned while developing IntelliJ Rust."
msgstr ""

#: src/2912-rust-analyzer.md:176
msgid ""
"It's interesting that many compilers went through a phase with parallel "
"implementations to get a great IDE support"
msgstr ""

#: src/2912-rust-analyzer.md:178
msgid ""
"For C#, the [Roslyn](https://github.com/dotnet/roslyn) project was a from "
"scratch implementation."
msgstr ""

#: src/2912-rust-analyzer.md:179
msgid ""
"[Dart for a long time had different front-ends for command line and "
"interactive compilers](https://youtu.be/WjdrUphF5l4?t=2204)"
msgstr ""

#: src/2912-rust-analyzer.md:180
msgid ""
"[Swift is transitioning to new syntax tree library by \"reimplement "
"separately, then swap\" approach](https://medium.com/@kitasuke/deep-dive-"
"into-integrating-libsyntax-into-the-compiler-pipeline-2d478c8600a1)"
msgstr ""

#: src/2912-rust-analyzer.md:182
msgid "Notable exceptions:"
msgstr ""

#: src/2912-rust-analyzer.md:184
msgid ""
"Kotlin, TypeScript -- these languages were implemented with IDEs in mind "
"from the start"
msgstr ""

#: src/2912-rust-analyzer.md:185
msgid ""
"OCaml with merlin/[ocaml-lsp](https://github.com/ocaml/ocaml-lsp) and C++ "
"with clangd -- languages with header files and forward declarations make it "
"easier to adapt traditional compiler architecture to certain IDE tasks like "
"completion"
msgstr ""

#: src/2912-rust-analyzer.md:189
msgid "Unresolved questions"
msgstr ""

#: src/2912-rust-analyzer.md:192
msgid ""
"How and when will we complete the transition from the existing RLS to rust-"
"analyzer?"
msgstr ""

#: src/2912-rust-analyzer.md:193
msgid ""
"As stated above, this will be determined based on the feedback we receive "
"during the Feedback phase."
msgstr ""

#: src/2912-rust-analyzer.md:195
msgid "Future possibilities"
msgstr ""
