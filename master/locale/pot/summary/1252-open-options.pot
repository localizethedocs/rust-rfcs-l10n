msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-22T09:04:43Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"Language: en\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/1252-open-options.md:1
msgid "Feature Name: `expand_open_options`"
msgstr ""

#: src/1252-open-options.md:2
msgid "Start Date: 2015-08-04"
msgstr ""

#: src/1252-open-options.md:3
msgid ""
"RFC PR: [rust-lang/rfcs#1252](https://github.com/rust-lang/rfcs/pull/1252)"
msgstr ""

#: src/1252-open-options.md:4
msgid ""
"Rust Issue: [rust-lang/rust#30014](https://github.com/rust-lang/rust/"
"issues/30014)"
msgstr ""

#: src/1252-open-options.md:6
msgid "Summary"
msgstr ""

#: src/1252-open-options.md:8
msgid "Document and expand the open options."
msgstr ""

#: src/1252-open-options.md:11
msgid "Motivation"
msgstr ""

#: src/1252-open-options.md:13
msgid ""
"The options that can be passed to the os when opening a file vary between "
"systems. And even if the options seem the same or similar, there may be "
"unexpected corner cases."
msgstr ""

#: src/1252-open-options.md:17
msgid "This RFC attempts to"
msgstr ""

#: src/1252-open-options.md:18
msgid ""
"describe the different corner cases and behaviour of various operating "
"systems."
msgstr ""

#: src/1252-open-options.md:20
msgid "describe the intended behaviour and interaction of Rusts options."
msgstr ""

#: src/1252-open-options.md:21
msgid "remedy cross-platform inconsistencies."
msgstr ""

#: src/1252-open-options.md:22
msgid "suggest extra options to expose more platform-specific options."
msgstr ""

#: src/1252-open-options.md:25
msgid "Detailed design"
msgstr ""

#: src/1252-open-options.md:27
msgid "Access modes"
msgstr ""

#: src/1252-open-options.md:29
msgid "Read-only"
msgstr ""

#: src/1252-open-options.md:30
msgid "Open a file for read-only."
msgstr ""

#: src/1252-open-options.md:33
msgid "Write-only"
msgstr ""

#: src/1252-open-options.md:34
msgid "Open a file for write-only."
msgstr ""

#: src/1252-open-options.md:36
msgid ""
"If a file already exist, the contents of that file get overwritten, but it "
"is not truncated. Example:"
msgstr ""

#: src/1252-open-options.md:38
msgid ""
"```\n"
"// contents of file before: \"aaaaaaaa\"\n"
"file.write(b\"bbbb\")\n"
"// contents of file after: \"bbbbaaaa\"\n"
"```"
msgstr ""

#: src/1252-open-options.md:45
msgid "Read-write"
msgstr ""

#: src/1252-open-options.md:46
msgid "This is the simple combinations of read-only and write-only."
msgstr ""

#: src/1252-open-options.md:49
msgid "Append-mode"
msgstr ""

#: src/1252-open-options.md:50
msgid ""
"Append-mode is similar to write-only, but all writes always happen at the "
"end of the file. This mode is especially useful if multiple processes or "
"threads write to a single file, like a log file. The operating system "
"guarantees all writes are atomic: no writes get mangled because another "
"process writes at the same time. No guarantees are made about the order "
"writes end up in the file though."
msgstr ""

#: src/1252-open-options.md:56
msgid "Note: sadly append-mode is not atomic on NFS filesystems."
msgstr ""

#: src/1252-open-options.md:58
msgid ""
"One maybe obvious note when using append-mode: make sure that all data that "
"belongs together, is written to the file in one operation. This can be done "
"by concatenating strings before passing them to `write()`, or using a "
"buffered writer (with a more than adequately sized buffer) and calling "
"`flush()` when the message is complete."
msgstr ""

#: src/1252-open-options.md:64
msgid ""
"_Implementation detail_: On Windows opening a file in append-mode has one "
"flag _less_, the right to change existing data is removed. On Unix opening a "
"file in append-mode has one flag _extra_, that sets the status of the file "
"descriptor to append-mode. You could say that on Windows write is a superset "
"of append, while on Unix append is a superset of write."
msgstr ""

#: src/1252-open-options.md:70
msgid ""
"Because of this append is treated as a separate access mode in Rust, and if "
"`.append(true)` is specified than `.write()` is ignored."
msgstr ""

#: src/1252-open-options.md:74
msgid "Read-append"
msgstr ""

#: src/1252-open-options.md:75
msgid "Writing to the file works exactly the same as in append-mode."
msgstr ""

#: src/1252-open-options.md:77
msgid ""
"Reading is more difficult, and may involve a lot of seeking. When the file "
"is opened, the position for reading may be set at the end of the file, so "
"you should first seek to the beginning. Also after every write the position "
"is set to the end of the file. So before writing you should save the current "
"position, and restore it after the write."
msgstr ""

#: src/1252-open-options.md:82
msgid ""
"```\n"
"try!(file.seek(SeekFrom::Start(0)));\n"
"try!(file.read(&mut buffer));\n"
"let pos = try!(file.seek(SeekFrom::Current(0)));\n"
"try!(file.write(b\"foo\"));\n"
"try!(file.seek(SeekFrom::Start(pos)));\n"
"try!(file.read(&mut buffer));\n"
"```"
msgstr ""

#: src/1252-open-options.md:91
msgid "No access mode set"
msgstr ""

#: src/1252-open-options.md:92
msgid ""
"Even if you don't have read or write permission to a file, it is possible to "
"open it on some systems by opening it with no access mode set (or the "
"equivalent there of). This is true for Windows, Linux (with the flag "
"`O_PATH`) and GNU/Hurd."
msgstr ""

#: src/1252-open-options.md:97
msgid ""
"What can be done with a file opened this way is system-specific and niche. "
"Since Linux version 2.6.39 all three operating systems support reading "
"metadata such as the file size and timestamps."
msgstr ""

#: src/1252-open-options.md:101
msgid ""
"On practically all variants of Unix opening a file without specifying the "
"access mode falls back to opening the file read-only. This is because of the "
"way the access flags where traditionally defined: `O_RDONLY = 0`, `O_WRONLY "
"= 1` and `O_RDWR = 2`. When no flags are set, the access mode is `0`: read-"
"only. But code that relies on this is considered buggy and not portable."
msgstr ""

#: src/1252-open-options.md:107
msgid ""
"What should Rust do when no access mode is specified? Fall back to read-"
"only, open with the most similar system-specific mode, or always fail to "
"open? This RFC proposes to always fail. This is the conservative choice, and "
"can be changed to open in a system-specific mode if a clear use case arises. "
"Implementing a fallback is not worth it: it is no great effort to set the "
"access mode explicitly."
msgstr ""

#: src/1252-open-options.md:115
msgid "Windows-specific"
msgstr ""

#: src/1252-open-options.md:116
msgid "`.access_mode(FILE_READ_DATA)`"
msgstr ""

#: src/1252-open-options.md:118
msgid ""
"On Windows you can detail whether you want to have read and/or write access "
"to the files data, attributes and/or extended attributes. Managing "
"permissions in such detail has proven itself too difficult, and generally "
"not worth it."
msgstr ""

#: src/1252-open-options.md:122
msgid ""
"In Rust, `.read(true)` gives you read access to the data, attributes and "
"extended attributes. Similarly, `.write(true)` gives write access to those "
"three, and the right to append data beyond the current end of the file."
msgstr ""

#: src/1252-open-options.md:126
msgid "But if you want fine-grained control, with `access_mode` you have it."
msgstr ""

#: src/1252-open-options.md:128
msgid ""
"`.access_mode()` overrides the access mode set with Rusts cross-platform "
"options. Reasons to do so:"
msgstr ""

#: src/1252-open-options.md:130
msgid "it is not possible to un-set the flags set by Rusts options;"
msgstr ""

#: src/1252-open-options.md:131
msgid ""
"otherwise the cross-platform options have to be wrapped with `#[cfg(unix)]`, "
"instead of only having to wrap the Windows-specific option."
msgstr ""

#: src/1252-open-options.md:134
msgid "As a reference, this are the flags set by Rusts access modes:"
msgstr ""

#: src/1252-open-options.md:136 src/1252-open-options.md:367
msgid "bit"
msgstr ""

#: src/1252-open-options.md:136 src/1252-open-options.md:367
msgid "flag"
msgstr ""

#: src/1252-open-options.md:136 src/1252-open-options.md:297
msgid "read"
msgstr ""

#: src/1252-open-options.md:136 src/1252-open-options.md:297
msgid "write"
msgstr ""

#: src/1252-open-options.md:136 src/1252-open-options.md:297
msgid "read-write"
msgstr ""

#: src/1252-open-options.md:136 src/1252-open-options.md:297
msgid "append"
msgstr ""

#: src/1252-open-options.md:136 src/1252-open-options.md:297
msgid "read-append"
msgstr ""

#: src/1252-open-options.md:138
msgid "**generic rights**"
msgstr ""

#: src/1252-open-options.md:139 src/1252-open-options.md:369
msgid "31"
msgstr ""

#: src/1252-open-options.md:139
msgid "GENERIC_READ"
msgstr ""

#: src/1252-open-options.md:139 src/1252-open-options.md:140
#: src/1252-open-options.md:146 src/1252-open-options.md:148
#: src/1252-open-options.md:151 src/1252-open-options.md:154
#: src/1252-open-options.md:157
msgid "set"
msgstr ""

#: src/1252-open-options.md:140 src/1252-open-options.md:370
msgid "30"
msgstr ""

#: src/1252-open-options.md:140
msgid "GENERIC_WRITE"
msgstr ""

#: src/1252-open-options.md:141 src/1252-open-options.md:371
msgid "29"
msgstr ""

#: src/1252-open-options.md:141
msgid "GENERIC_EXECUTE"
msgstr ""

#: src/1252-open-options.md:142 src/1252-open-options.md:372
msgid "28"
msgstr ""

#: src/1252-open-options.md:142
msgid "GENERIC_ALL"
msgstr ""

#: src/1252-open-options.md:143
msgid "**specific rights**"
msgstr ""

#: src/1252-open-options.md:144
msgid "0"
msgstr ""

#: src/1252-open-options.md:144
msgid "FILE_READ_DATA"
msgstr ""

#: src/1252-open-options.md:144 src/1252-open-options.md:145
#: src/1252-open-options.md:146 src/1252-open-options.md:147
#: src/1252-open-options.md:148 src/1252-open-options.md:150
#: src/1252-open-options.md:151 src/1252-open-options.md:154
#: src/1252-open-options.md:157
msgid "implied"
msgstr ""

#: src/1252-open-options.md:145
msgid "1"
msgstr ""

#: src/1252-open-options.md:145
msgid "FILE_WRITE_DATA"
msgstr ""

#: src/1252-open-options.md:146
msgid "2"
msgstr ""

#: src/1252-open-options.md:146
msgid "FILE_APPEND_DATA"
msgstr ""

#: src/1252-open-options.md:147
msgid "3"
msgstr ""

#: src/1252-open-options.md:147
msgid "FILE_READ_EA"
msgstr ""

#: src/1252-open-options.md:148
msgid "4"
msgstr ""

#: src/1252-open-options.md:148
msgid "FILE_WRITE_EA"
msgstr ""

#: src/1252-open-options.md:149
msgid "6"
msgstr ""

#: src/1252-open-options.md:149
msgid "FILE_EXECUTE"
msgstr ""

#: src/1252-open-options.md:150
msgid "7"
msgstr ""

#: src/1252-open-options.md:150
msgid "FILE_READ_ATTRIBUTES"
msgstr ""

#: src/1252-open-options.md:151
msgid "8"
msgstr ""

#: src/1252-open-options.md:151
msgid "FILE_WRITE_ATTRIBUTES"
msgstr ""

#: src/1252-open-options.md:152
msgid "**standard rights**"
msgstr ""

#: src/1252-open-options.md:153
msgid "16"
msgstr ""

#: src/1252-open-options.md:153
msgid "DELETE"
msgstr ""

#: src/1252-open-options.md:154
msgid "17"
msgstr ""

#: src/1252-open-options.md:154
msgid "READ_CONTROL"
msgstr ""

#: src/1252-open-options.md:154 src/1252-open-options.md:157
msgid "set+implied"
msgstr ""

#: src/1252-open-options.md:155 src/1252-open-options.md:381
msgid "18"
msgstr ""

#: src/1252-open-options.md:155
msgid "WRITE_DAC"
msgstr ""

#: src/1252-open-options.md:156 src/1252-open-options.md:380
msgid "19"
msgstr ""

#: src/1252-open-options.md:156
msgid "WRITE_OWNER"
msgstr ""

#: src/1252-open-options.md:157 src/1252-open-options.md:379
msgid "20"
msgstr ""

#: src/1252-open-options.md:157
msgid "SYNCHRONIZE"
msgstr ""

#: src/1252-open-options.md:159
msgid ""
"The implied flags can be specified explicitly with the constants "
"`FILE_GENERIC_READ` and `FILE_GENERIC_WRITE`."
msgstr ""

#: src/1252-open-options.md:163
msgid "Creation modes"
msgstr ""

#: src/1252-open-options.md:165 src/1252-open-options.md:297
msgid "creation mode"
msgstr ""

#: src/1252-open-options.md:165
msgid "file exists"
msgstr ""

#: src/1252-open-options.md:165
msgid "file does not exist"
msgstr ""

#: src/1252-open-options.md:165
msgid "Unix"
msgstr ""

#: src/1252-open-options.md:165
msgid "Windows"
msgstr ""

#: src/1252-open-options.md:167 src/1252-open-options.md:299
msgid "not set (open existing)"
msgstr ""

#: src/1252-open-options.md:167 src/1252-open-options.md:168
msgid "open"
msgstr ""

#: src/1252-open-options.md:167 src/1252-open-options.md:169
#: src/1252-open-options.md:171
msgid "fail"
msgstr ""

#: src/1252-open-options.md:167
msgid "OPEN_EXISTING"
msgstr ""

#: src/1252-open-options.md:168
msgid ".create(true)"
msgstr ""

#: src/1252-open-options.md:168 src/1252-open-options.md:170
#: src/1252-open-options.md:171 src/1252-open-options.md:300
msgid "create"
msgstr ""

#: src/1252-open-options.md:168 src/1252-open-options.md:389
msgid "O_CREAT"
msgstr ""

#: src/1252-open-options.md:168
msgid "OPEN_ALWAYS"
msgstr ""

#: src/1252-open-options.md:169
msgid ".truncate(true)"
msgstr ""

#: src/1252-open-options.md:169 src/1252-open-options.md:170
#: src/1252-open-options.md:301
msgid "truncate"
msgstr ""

#: src/1252-open-options.md:169 src/1252-open-options.md:388
msgid "O_TRUNC"
msgstr ""

#: src/1252-open-options.md:169
msgid "TRUNCATE_EXISTING"
msgstr ""

#: src/1252-open-options.md:170
msgid ".create(true).truncate(true)"
msgstr ""

#: src/1252-open-options.md:170
msgid "O_CREAT + O_TRUNC"
msgstr ""

#: src/1252-open-options.md:170
msgid "CREATE_ALWAYS"
msgstr ""

#: src/1252-open-options.md:171
msgid ".create_new(true)"
msgstr ""

#: src/1252-open-options.md:171
msgid "O_CREAT + O_EXCL"
msgstr ""

#: src/1252-open-options.md:171
msgid "CREATE_NEW + FILE_FLAG_OPEN_REPARSE_POINT"
msgstr ""

#: src/1252-open-options.md:174
msgid "Not set (open existing)"
msgstr ""

#: src/1252-open-options.md:175
msgid "Open an existing file. Fails if the file does not exist."
msgstr ""

#: src/1252-open-options.md:178
msgid "Create"
msgstr ""

#: src/1252-open-options.md:179
msgid "`.create(true)`"
msgstr ""

#: src/1252-open-options.md:181
msgid ""
"Open an existing file, or create a new file if it does not already exists."
msgstr ""

#: src/1252-open-options.md:184
msgid "Truncate"
msgstr ""

#: src/1252-open-options.md:185
msgid "`.truncate(true)`"
msgstr ""

#: src/1252-open-options.md:187
msgid ""
"Open an existing file, and truncate it to zero length. Fails if the file "
"does not exist. Attributes and permissions of the truncated file are "
"preserved."
msgstr ""

#: src/1252-open-options.md:190
msgid ""
"Note when using the Windows-specific `.access_mode()`: truncating will only "
"work if the `GENERIC_WRITE` flag is set. Setting the equivalent individual "
"flags is not enough."
msgstr ""

#: src/1252-open-options.md:195
msgid "Create and truncate"
msgstr ""

#: src/1252-open-options.md:196
msgid "`.create(true).truncate(true)`"
msgstr ""

#: src/1252-open-options.md:198
msgid ""
"Open an existing file and truncate it to zero length, or create a new file "
"if it does not already exists."
msgstr ""

#: src/1252-open-options.md:201
msgid ""
"Note when using the Windows-specific `.access_mode()`: Contrary to only `."
"truncate(true)`, with `.create(true).truncate(true)` Windows _can_ truncate "
"an existing file without requiring any flags to be set."
msgstr ""

#: src/1252-open-options.md:205
msgid ""
"On Windows the attributes of an existing file can cause `.open()` to fail. "
"If the existing file has the attribute _hidden_ set, it is necessary to open "
"with `FILE_ATTRIBUTE_HIDDEN`. Similarly if the existing file has the "
"attribute _system_ set, it is necessary to open with "
"`FILE_ATTRIBUTE_SYSTEM`. See the Windows-specific `.attributes()` below on "
"how to set these."
msgstr ""

#: src/1252-open-options.md:212
msgid "Create_new"
msgstr ""

#: src/1252-open-options.md:213
msgid "`.create_new(true)`"
msgstr ""

#: src/1252-open-options.md:215
msgid "Create a new file, and fail if it already exist."
msgstr ""

#: src/1252-open-options.md:217
msgid ""
"On Unix this options started its life as a security measure. If you first "
"check if a file does not exists with `exists()` and then call `open()`, some "
"other process may have created in the in mean time. `.create_new()` is an "
"atomic operation that will fail if a file already exist at the location."
msgstr ""

#: src/1252-open-options.md:222
msgid ""
"`.create_new()` has a special rule on Unix for dealing with symlinks. If "
"there is a symlink at the final element of its path (e.g. the filename), "
"open will fail. This is to prevent a vulnerability where an unprivileged "
"process could trick a privileged process into following a symlink and "
"overwriting a file the unprivileged process has no access to. See "
"[Exploiting symlinks and tmpfiles](https://lwn.net/Articles/250468/). On "
"Windows this behaviour is imitated by specifying not only `CREATE_NEW` but "
"also `FILE_FLAG_OPEN_REPARSE_POINT`."
msgstr ""

#: src/1252-open-options.md:231
msgid ""
"Simply put: nothing is allowed to exist on the target location, also no "
"(dangling) symlink."
msgstr ""

#: src/1252-open-options.md:234
msgid ""
"if `.create_new(true)` is set, `.create()` and `.truncate()` are ignored."
msgstr ""

#: src/1252-open-options.md:237
msgid "Unix-specific: Mode"
msgstr ""

#: src/1252-open-options.md:238
msgid "`.mode(0o666)`"
msgstr ""

#: src/1252-open-options.md:240
msgid ""
"On Unix the new file is created by default with permissions `0o666` minus "
"the systems `umask` (see [Wikipedia](https://en.wikipedia.org/wiki/Umask)). "
"It is possible to set on other mode with this option."
msgstr ""

#: src/1252-open-options.md:244
msgid ""
"If a file already exist or `.create(true)` or `.create_new(true)` are not "
"specified, `.mode()` is ignored."
msgstr ""

#: src/1252-open-options.md:247
msgid "Rust currently does not expose a way to modify the umask."
msgstr ""

#: src/1252-open-options.md:250
msgid "Windows-specific: Attributes"
msgstr ""

#: src/1252-open-options.md:251
msgid ""
"`.attributes(FILE_ATTRIBUTE_READONLY | FILE_ATTRIBUTE_HIDDEN | "
"FILE_ATTRIBUTE_SYSTEM)`"
msgstr ""

#: src/1252-open-options.md:253
msgid ""
"Files on Windows can have several attributes, most commonly one or more of "
"the following four: readonly, hidden, system and archive. Most [others]"
"(https://msdn.microsoft.com/en-us/library/windows/desktop/"
"gg258117%28v=vs.85%29.aspx) are properties set by the file system. Of the "
"others only `FILE_ATTRIBUTE_ENCRYPTED`, `FILE_ATTRIBUTE_TEMPORARY` and "
"`FILE_ATTRIBUTE_OFFLINE` can be set when creating a new file. All others are "
"silently ignored."
msgstr ""

#: src/1252-open-options.md:261
msgid ""
"It is no use to set the archive attribute, as Windows sets it automatically "
"when the file is newly created or modified. This flag may then be used by "
"backup applications as an indication of which files have changed."
msgstr ""

#: src/1252-open-options.md:265
msgid ""
"If a _new_ file is created because it does not yet exist and `.create(true)` "
"or `.create_new(true)` are specified, the new file is given the attributes "
"declared with `.attributes()`."
msgstr ""

#: src/1252-open-options.md:269
msgid ""
"If an _existing_ file is opened with `.create(true).truncate(true)`, its "
"existing attributes are preserved and combined with the ones declared with `."
"attributes()`."
msgstr ""

#: src/1252-open-options.md:273
msgid "In all other cases the attributes get ignored."
msgstr ""

#: src/1252-open-options.md:276
msgid "Combination of access modes and creation modes"
msgstr ""

#: src/1252-open-options.md:278
msgid "Some combinations of creation modes and access modes do not make sense."
msgstr ""

#: src/1252-open-options.md:280
msgid ""
"For example: `.create(true)` when opening read-only. If the file does not "
"already exist, it is created and you start reading from an empty file. And "
"it is questionable whether you have permission to create a new file if you "
"don't have write access. A new file is created on all systems I have tested, "
"but there is no documentation that explicitly guarantees this behaviour."
msgstr ""

#: src/1252-open-options.md:286
msgid ""
"The same is true for `.truncate(true)` with read and/or append mode. Should "
"an existing file be modified if you don't have write permission? On Unix it "
"is undefined (see [some](http://www.monkey.org/openbsd/archive/tech/0009/"
"msg00299.html) [comments](http://www.monkey.org/openbsd/archive/tech/0009/"
"msg00304.html) on the OpenBSD mailing list). The behaviour on Windows is "
"inconsistent and depends on whether `.create(true)` is set."
msgstr ""

#: src/1252-open-options.md:294
msgid ""
"To give guarantees about cross-platform (and sane) behaviour, Rust should "
"allow only the following combinations of access modes and creations modes:"
msgstr ""

#: src/1252-open-options.md:299 src/1252-open-options.md:300
#: src/1252-open-options.md:301 src/1252-open-options.md:302
#: src/1252-open-options.md:303
msgid "X"
msgstr ""

#: src/1252-open-options.md:302
msgid "create and truncate"
msgstr ""

#: src/1252-open-options.md:303
msgid "create_new"
msgstr ""

#: src/1252-open-options.md:305
msgid ""
"It is possible to bypass these restrictions by using system-specific options "
"(as in this case you already have to take care of cross-platform support "
"yourself). On Unix this is done by setting the creation mode using `."
"custom_flags()` with `O_CREAT`, `O_TRUNC` and/or `O_EXCL`. On Windows this "
"can be done by manually specifying `.access_mode()` (see above)."
msgstr ""

#: src/1252-open-options.md:312
msgid "Asynchronous IO"
msgstr ""

#: src/1252-open-options.md:313
msgid "Out op scope."
msgstr ""

#: src/1252-open-options.md:316 src/1252-open-options.md:457
msgid "Other options"
msgstr ""

#: src/1252-open-options.md:318
msgid "Inheritance of file descriptors"
msgstr ""

#: src/1252-open-options.md:319
msgid ""
"Leaking file descriptors to child processes can cause problems and can be a "
"security vulnerability. See this report by [Python](https://www.python.org/"
"dev/peps/pep-0446/)."
msgstr ""

#: src/1252-open-options.md:323
msgid ""
"On Windows, child processes do not inherit file descriptors by default (but "
"this can be changed). On Unix they always inherit, unless the close-on-exec "
"flag is set."
msgstr ""

#: src/1252-open-options.md:327
msgid ""
"The close on exec flag can be set atomically when opening the file, or later "
"with `fcntl`. The `O_CLOEXEC` flag is in the relatively new POSIX-2008 "
"standard, and all modern versions of Unix support it. The following table "
"lists for which operating systems we can rely on the flag to be supported."
msgstr ""

#: src/1252-open-options.md:332
msgid "os"
msgstr ""

#: src/1252-open-options.md:332
msgid "since version"
msgstr ""

#: src/1252-open-options.md:332
msgid "oldest supported version"
msgstr ""

#: src/1252-open-options.md:334 src/1252-open-options.md:386
msgid "OS X"
msgstr ""

#: src/1252-open-options.md:334
msgid "10.6"
msgstr ""

#: src/1252-open-options.md:334
msgid "10.7?"
msgstr ""

#: src/1252-open-options.md:335 src/1252-open-options.md:386
msgid "Linux"
msgstr ""

#: src/1252-open-options.md:335
msgid "2.6.23"
msgstr ""

#: src/1252-open-options.md:335
msgid "2.6.32 (supported by Rust)"
msgstr ""

#: src/1252-open-options.md:336 src/1252-open-options.md:386
msgid "FreeBSD"
msgstr ""

#: src/1252-open-options.md:336
msgid "8.3"
msgstr ""

#: src/1252-open-options.md:336
msgid "8.4"
msgstr ""

#: src/1252-open-options.md:337 src/1252-open-options.md:386
msgid "OpenBSD"
msgstr ""

#: src/1252-open-options.md:337 src/1252-open-options.md:338
msgid "5.0"
msgstr ""

#: src/1252-open-options.md:337
msgid "5.7"
msgstr ""

#: src/1252-open-options.md:338 src/1252-open-options.md:386
msgid "NetBSD"
msgstr ""

#: src/1252-open-options.md:338
msgid "6.0"
msgstr ""

#: src/1252-open-options.md:339 src/1252-open-options.md:386
msgid "Dragonfly BSD"
msgstr ""

#: src/1252-open-options.md:339
msgid "3.2"
msgstr ""

#: src/1252-open-options.md:339
msgid "? (3.2 is not updated since 2012-12-14)"
msgstr ""

#: src/1252-open-options.md:340 src/1252-open-options.md:386
msgid "Solaris"
msgstr ""

#: src/1252-open-options.md:340
msgid "11"
msgstr ""

#: src/1252-open-options.md:340
msgid "10"
msgstr ""

#: src/1252-open-options.md:342
msgid ""
"This means we can always set the flag `O_CLOEXEC`, and do an additional "
"`fcntl` if the os is NetBSD or Solaris."
msgstr ""

#: src/1252-open-options.md:346
msgid "Custom flags"
msgstr ""

#: src/1252-open-options.md:347
msgid "`.custom_flags()`"
msgstr ""

#: src/1252-open-options.md:349
msgid ""
"Windows and the various flavours of Unix support flags that are not cross-"
"platform, but that can be useful in some circumstances. On Unix they will be "
"passed as the variable _flags_ to `open`, on Windows as the "
"_dwFlagsAndAttributes_ parameter."
msgstr ""

#: src/1252-open-options.md:354
msgid ""
"The cross-platform options of Rust can do magic: they can set any flag "
"necessary to ensure it works as expected. For example, `.append(true)` on "
"Unix not only sets the flag `O_APPEND`, but also automatically `O_WRONLY` or "
"`O_RDWR`. This special treatment is not available for the custom flags."
msgstr ""

#: src/1252-open-options.md:359
msgid "Custom flags can only set flags, not remove flags set by Rusts options."
msgstr ""

#: src/1252-open-options.md:361
msgid ""
"For the custom flags on Unix, the bits that define the access mode are "
"masked out with `O_ACCMODE`, to ensure they do not interfere with the access "
"mode set by Rusts options."
msgstr ""

#: src/1252-open-options.md:365
msgid ""
"[Windows](https://msdn.microsoft.com/en-us/library/windows/desktop/"
"hh449426%28v=vs.85%29.aspx):"
msgstr ""

#: src/1252-open-options.md:369
msgid "FILE_FLAG_WRITE_THROUGH"
msgstr ""

#: src/1252-open-options.md:370
msgid "FILE_FLAG_OVERLAPPED"
msgstr ""

#: src/1252-open-options.md:371
msgid "FILE_FLAG_NO_BUFFERING"
msgstr ""

#: src/1252-open-options.md:372
msgid "FILE_FLAG_RANDOM_ACCESS"
msgstr ""

#: src/1252-open-options.md:373
msgid "27"
msgstr ""

#: src/1252-open-options.md:373
msgid "FILE_FLAG_SEQUENTIAL_SCAN"
msgstr ""

#: src/1252-open-options.md:374
msgid "26"
msgstr ""

#: src/1252-open-options.md:374
msgid "FILE_FLAG_DELETE_ON_CLOSE"
msgstr ""

#: src/1252-open-options.md:375
msgid "25"
msgstr ""

#: src/1252-open-options.md:375
msgid "FILE_FLAG_BACKUP_SEMANTICS"
msgstr ""

#: src/1252-open-options.md:376
msgid "24"
msgstr ""

#: src/1252-open-options.md:376
msgid "FILE_FLAG_POSIX_SEMANTICS"
msgstr ""

#: src/1252-open-options.md:377
msgid "23"
msgstr ""

#: src/1252-open-options.md:377
msgid "FILE_FLAG_SESSION_AWARE"
msgstr ""

#: src/1252-open-options.md:378
msgid "21"
msgstr ""

#: src/1252-open-options.md:378
msgid "FILE_FLAG_OPEN_REPARSE_POINT"
msgstr ""

#: src/1252-open-options.md:379
msgid "FILE_FLAG_OPEN_NO_RECALL"
msgstr ""

#: src/1252-open-options.md:380
msgid "FILE_FLAG_FIRST_PIPE_INSTANCE"
msgstr ""

#: src/1252-open-options.md:381
msgid "FILE_FLAG_OPEN_REQUIRING_OPLOCK"
msgstr ""

#: src/1252-open-options.md:384
msgid "Unix:"
msgstr ""

#: src/1252-open-options.md:386
msgid "POSIX"
msgstr ""

#: src/1252-open-options.md:390
msgid "O_EXCL"
msgstr ""

#: src/1252-open-options.md:391
msgid "O_APPEND"
msgstr ""

#: src/1252-open-options.md:392
msgid "O_CLOEXEC"
msgstr ""

#: src/1252-open-options.md:393
msgid "O_DIRECTORY"
msgstr ""

#: src/1252-open-options.md:394
msgid "O_NOCTTY"
msgstr ""

#: src/1252-open-options.md:395
msgid "O_NOFOLLOW"
msgstr ""

#: src/1252-open-options.md:396
msgid "O_NONBLOCK"
msgstr ""

#: src/1252-open-options.md:397
msgid "O_SYNC"
msgstr ""

#: src/1252-open-options.md:397
msgid "O_FSYNC"
msgstr ""

#: src/1252-open-options.md:398
msgid "O_DSYNC"
msgstr ""

#: src/1252-open-options.md:399
msgid "O_RSYNC"
msgstr ""

#: src/1252-open-options.md:400
msgid "O_DIRECT"
msgstr ""

#: src/1252-open-options.md:401
msgid "O_ASYNC"
msgstr ""

#: src/1252-open-options.md:402
msgid "O_NOATIME"
msgstr ""

#: src/1252-open-options.md:403
msgid "O_PATH"
msgstr ""

#: src/1252-open-options.md:404
msgid "O_TMPFILE"
msgstr ""

#: src/1252-open-options.md:405
msgid "O_SHLOCK"
msgstr ""

#: src/1252-open-options.md:406
msgid "O_EXLOCK"
msgstr ""

#: src/1252-open-options.md:407
msgid "O_SYMLINK"
msgstr ""

#: src/1252-open-options.md:408
msgid "O_EVTONLY"
msgstr ""

#: src/1252-open-options.md:409
msgid "O_NOSIGPIPE"
msgstr ""

#: src/1252-open-options.md:410
msgid "O_ALT_IO"
msgstr ""

#: src/1252-open-options.md:411
msgid "O_NOLINKS"
msgstr ""

#: src/1252-open-options.md:412
msgid "O_XATTR"
msgstr ""

#: src/1252-open-options.md:413
msgid ""
"[POSIX](http://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html)"
msgstr ""

#: src/1252-open-options.md:413
msgid "[Linux](http://man7.org/linux/man-pages/man2/open.2.html)"
msgstr ""

#: src/1252-open-options.md:413
msgid ""
"[OS X](https://developer.apple.com/library/mac/documentation/Darwin/"
"Reference/ManPages/man2/open.2.html)"
msgstr ""

#: src/1252-open-options.md:413
msgid "[FreeBSD](https://www.freebsd.org/cgi/man.cgi?query=open&sektion=2)"
msgstr ""

#: src/1252-open-options.md:413
msgid ""
"[OpenBSD](http://www.openbsd.org/cgi-bin/man.cgi/OpenBSD-current/man2/open.2?"
"query=open&sec=2)"
msgstr ""

#: src/1252-open-options.md:413
msgid "[NetBSD](http://netbsd.gw.com/cgi-bin/man-cgi?open+2+NetBSD-current)"
msgstr ""

#: src/1252-open-options.md:413
msgid ""
"[Dragonfly BSD](http://leaf.dragonflybsd.org/cgi/web-man?"
"command=open&section=2)"
msgstr ""

#: src/1252-open-options.md:413
msgid ""
"[Solaris](http://docs.oracle.com/cd/E23824_01/html/821-1463/open-2.html)"
msgstr ""

#: src/1252-open-options.md:416
msgid "Windows-specific flags and attributes"
msgstr ""

#: src/1252-open-options.md:417
msgid ""
"The following variables for CreateFile2 currently have no equivalent "
"functions in Rust to set them:"
msgstr ""

#: src/1252-open-options.md:426
msgid "Changes from current"
msgstr ""

#: src/1252-open-options.md:428
msgid "Access mode"
msgstr ""

#: src/1252-open-options.md:429
msgid ""
"Current: `.append(true)` requires `.write(true)` on Unix, but not on "
"Windows. New: ignore `.write()` if `.append(true)` is specified."
msgstr ""

#: src/1252-open-options.md:431
msgid ""
"Current: when `.append(true)` is set, it is not possible to modify file "
"attributes on Windows, but it is possible to change the file mode on Unix. "
"New: allow file attributes to be modified on Windows in append-mode."
msgstr ""

#: src/1252-open-options.md:434
msgid ""
"Current: On Windows `.read()` and `.write()` set individual bit flags "
"instead of generic flags. New: Set generic flags, as recommend by Microsoft. "
"e.g. `GENERIC_WRITE` instead of `FILE_GENERIC_WRITE` and `GENERIC_READ` "
"instead of `FILE_GENERIC_READ`. Currently truncate is broken on Windows, "
"this fixes it."
msgstr ""

#: src/1252-open-options.md:438
msgid ""
"Current: when no access mode is set, this falls back to opening the file "
"read-only on Unix, and opening with no access permissions on Windows. New: "
"always fail to open if no access mode is set."
msgstr ""

#: src/1252-open-options.md:441
msgid "Rename the Windows-specific `.desired_access()` to `.access_mode()`"
msgstr ""

#: src/1252-open-options.md:443
msgid "Creation mode"
msgstr ""

#: src/1252-open-options.md:444
msgid "Implement `.create_new()`."
msgstr ""

#: src/1252-open-options.md:445
msgid ""
"Do not allow `.truncate(true)` if the access mode is read-only and/or append."
msgstr ""

#: src/1252-open-options.md:446
msgid ""
"Do not allow `.create(true)` or `.create_new (true)` if the access mode is "
"read-only."
msgstr ""

#: src/1252-open-options.md:448
msgid ""
"Remove the Windows-specific `.creation_disposition()`. It has no use, "
"because all its options can be set in a cross-platform way."
msgstr ""

#: src/1252-open-options.md:450
msgid ""
"Split the Windows-specific `.flags_and_attributes()` into `.custom_flags()` "
"and `.attributes()`. This is a form of future-proofing, as the new Windows 8 "
"`Createfile2` also splits these attributes. This has the advantage of a "
"clear separation between file attributes, that are somewhat similar to Unix "
"mode bits, and the custom flags that modify the behaviour of the current "
"file handle."
msgstr ""

#: src/1252-open-options.md:458
msgid "Set the close-on-exec flag atomically on Unix if supported."
msgstr ""

#: src/1252-open-options.md:459
msgid ""
"Implement `.custom_flags()` on Windows and Unix to pass custom flags to the "
"system."
msgstr ""

#: src/1252-open-options.md:463
msgid "Drawbacks"
msgstr ""

#: src/1252-open-options.md:464
msgid ""
"This adds a thin layer on top of the raw operating system calls. In this "
"[pull request](https://github.com/rust-lang/rust/"
"pull/26772#issuecomment-126753342) the conclusion was: this seems like a "
"good idea for a \"high level\" abstraction like OpenOptions."
msgstr ""

#: src/1252-open-options.md:469
msgid ""
"This adds extra options that many applications can do without (otherwise "
"they were already implemented)."
msgstr ""

#: src/1252-open-options.md:472
msgid ""
"Also this RFC is in line with the vision for IO in the [IO-OS-redesign]"
"(https://github.com/rust-lang/rfcs/blob/master/text/0517-io-os-reform."
"md#vision-for-io):"
msgstr ""

#: src/1252-open-options.md:474
msgid ""
"\\[The APIs\\] should impose essentially zero cost over the underlying OS "
"services; the core APIs should map down to a single syscall unless more are "
"needed for cross-platform compatibility."
msgstr ""

#: src/1252-open-options.md:477
msgid ""
"The APIs should largely feel like part of \"Rust\" rather than part of any "
"legacy, and they should enable truly portable code."
msgstr ""

#: src/1252-open-options.md:479
msgid ""
"Coverage. The std APIs should over time strive for full coverage of non-"
"niche, cross-platform capabilities."
msgstr ""

#: src/1252-open-options.md:483
msgid "Alternatives"
msgstr ""

#: src/1252-open-options.md:484
msgid ""
"The first version of this RFC contained a proposal for options that control "
"caching anf file locking. They are out of scope for now, but included here "
"for reference."
msgstr ""

#: src/1252-open-options.md:489
msgid "Sharing / locking"
msgstr ""

#: src/1252-open-options.md:490
msgid ""
"On Unix it is possible for multiple processes to read and write to the same "
"file at the same time."
msgstr ""

#: src/1252-open-options.md:493
msgid ""
"When you open a file on Windows, the system by default denies other "
"processes to read or write to the file, or delete it. By setting the sharing "
"mode, it is possible to allow other processes read, write and/or delete "
"access. For cross-platform consistency, Rust imitates Unix by setting all "
"sharing flags."
msgstr ""

#: src/1252-open-options.md:498
msgid ""
"Unix has no equivalent to the kind of file locking that Windows has. It has "
"two types of advisory locking, POSIX and BSD-style. Advisory means any "
"process that does not use locking itself can happily ignore the locking af "
"another process. As if that is not bad enough, they both have [problems]"
"(http://0pointer.de/blog/projects/locking.html) that make them close to "
"unusable for modern multi-threaded programs. Linux may in some very rare "
"cases support mandatory file locking, but it is just as broken as advisory."
msgstr ""

#: src/1252-open-options.md:507
msgid "Windows-specific: Share mode"
msgstr ""

#: src/1252-open-options.md:508
msgid "`.share_mode(FILE_SHARE_READ | FILE_SHARE_WRITE | FILE_SHARE_DELETE)`"
msgstr ""

#: src/1252-open-options.md:510
msgid ""
"It is possible to set the individual share permissions with `.share_mode()`."
msgstr ""

#: src/1252-open-options.md:512
msgid ""
"The current philosophy of this function is that others should have no "
"rights, unless explicitly granted. I think a better fit for Rust would be to "
"give all others all rights, unless explicitly denied, e.g.: `."
"share_mode(DENY_READ | DENY_WRITE | DENY_DELETE)`."
msgstr ""

#: src/1252-open-options.md:518
msgid "Controlling caching"
msgstr ""

#: src/1252-open-options.md:519
msgid ""
"When dealing file file systems and hard disks, there are several kinds of "
"caches. Giving hints or controlling them may improve performance or data "
"consistency."
msgstr ""

#: src/1252-open-options.md:522
msgid ""
"_read-ahead (performance of reads and overwrites)_ Instead of requesting "
"only the data necessary for a single `read()` call from a storage device, an "
"operating system may request more data than necessary to have it already "
"available for the next read."
msgstr ""

#: src/1252-open-options.md:526
msgid ""
"_os cache  (performance of reads and overwrites)_ The os may keep the data "
"of previous reads and writes in memory to increase the performance of future "
"reads and possibly writes."
msgstr ""

#: src/1252-open-options.md:529
msgid ""
"_os staging area (convenience/performance of reads and writes)_ The size and "
"alignment of data reads and writes to a disk should correspondent to sectors "
"on the storage device, usually 512 or 4096 bytes. The os makes sure a "
"regular `write()` or `read()` doesn't have to care about this. For example a "
"small write (say a 100 bytes) has to rewrite a whole sector. The os often "
"has the surrounding data in its cache and can efficiently combine it to "
"write the whole sector."
msgstr ""

#: src/1252-open-options.md:536
msgid ""
"_delayed writing (performance/correctness of writes)_ The os may delay "
"writes to improve performance, for example by batching consecutive writes, "
"and scheduling with reads to minimize seeking."
msgstr ""

#: src/1252-open-options.md:539
msgid ""
"_on-disk write cache (performance/correctness of writes)_ Most hard disk / "
"storage devices have a small RAM cache. It can speed up reads, and writes "
"can return as soon as the data is written to the devices cache."
msgstr ""

#: src/1252-open-options.md:545
msgid "Read-ahead hint"
msgstr ""

#: src/1252-open-options.md:556
msgid ""
"If you read a file sequentially the read-ahead is beneficial, for completely "
"random access it can become a penalty."
msgstr ""

#: src/1252-open-options.md:559
msgid "`Default` uses the generally good heuristics of the operating system."
msgstr ""

#: src/1252-open-options.md:560
msgid ""
"`Sequential` indicates sequential but not necessary consecutive access. With "
"this the os may increase the amount of data that is read ahead."
msgstr ""

#: src/1252-open-options.md:562
msgid ""
"`Random` indicates mainly random access. The os may disable its read-ahead "
"cache."
msgstr ""

#: src/1252-open-options.md:565
msgid ""
"This option is treated as a hint. It is ignored if the os does not support "
"it, or if the behaviour of the application proves it is set wrong."
msgstr ""

#: src/1252-open-options.md:568 src/1252-open-options.md:647
msgid "Open flags / system calls:"
msgstr ""

#: src/1252-open-options.md:569
msgid ""
"Windows: flags `FILE_FLAG_SEQUENTIAL_SCAN` and `FILE_FLAG_RANDOM_ACCESS`"
msgstr ""

#: src/1252-open-options.md:570
msgid ""
"Linux, FreeBSD, NetBSD: `posix_fadvise()` with the flags "
"`POSIX_FADV_SEQUENTIAL` and `POSIX_FADV_RANDOM`"
msgstr ""

#: src/1252-open-options.md:572
msgid ""
"OS X: `fcntl()` with with `F_RDAHEAD 0` for random (there is no special mode "
"for sequential)."
msgstr ""

#: src/1252-open-options.md:576
msgid "OS cache"
msgstr ""

#: src/1252-open-options.md:577
msgid "`used_once(true)`"
msgstr ""

#: src/1252-open-options.md:579
msgid ""
"When reading many gigabytes of data a process may push useful data from "
"other processes out of the os cache. To keep the performance of the whole "
"system up, a process could indicate to the os whether data is only needed "
"once, or not needed anymore. On Linux, FreeBSD and NetBSD this is possible "
"with fcntl `POSIX_FADV_DONTNEED` after a read or write with sync (or before "
"close). On FreeBSD and NetBSD it is also possible to specify this up-front "
"with fnctl `POSIX_FADV_NOREUSE`, and on OS X with fnctl `F_NOCACHE`. Windows "
"does not seem to provide an option for this."
msgstr ""

#: src/1252-open-options.md:588
msgid ""
"This option may negatively effect the performance of writes smaller than the "
"sector size, as cached data may not be available to the os staging area."
msgstr ""

#: src/1252-open-options.md:591
msgid ""
"This control over the os cache is the main reason some applications use "
"direct io, despite it being less convenient and disabling other useful "
"caches."
msgstr ""

#: src/1252-open-options.md:595
msgid "Delayed writing and on-disk write cache"
msgstr ""

#: src/1252-open-options.md:596
msgid "`.sync_data(true)` and `.sync_all(true)`"
msgstr ""

#: src/1252-open-options.md:598
msgid ""
"There can be two delays (by the os and by the disk cache) between when an "
"application performs a write, and when the data is written to persistent "
"storage. They increase performance, but increase the risk of data loss in "
"case of a systems crash or power outage."
msgstr ""

#: src/1252-open-options.md:603
msgid ""
"When dealing with critical data, it may be useful to control these caches to "
"make the chance of data loss smaller. The application should normally do so "
"by calling Rusts stand-alone functions `sync_data()` or `sync_all()` at "
"meaningful points (e.g. when the file is in a consistent state, or a state "
"it can recover from)."
msgstr ""

#: src/1252-open-options.md:609
msgid ""
"However, `.sync_data()` and `.sync_all()` may also be given as an open "
"option. This guarantees every write will not return before the data is "
"written to disk. These options improve reliability as and you can never "
"accidentally forget a sync."
msgstr ""

#: src/1252-open-options.md:614
msgid ""
"Whether performance with these options is worse than with the stand-alone "
"functions is hard to say. With these options the data maybe has to be "
"synchronised more often. But the stand-alone functions often sync "
"outstanding writes to all files, while the options possibly sync only the "
"current file."
msgstr ""

#: src/1252-open-options.md:619
msgid ""
"The difference between `.sync_all()` and `.sync_data(true)` is that `."
"sync_data(true)` does not update the less critical metadata such as the last "
"modified timestamp (although it will be written eventually)."
msgstr ""

#: src/1252-open-options.md:623
msgid "Open flags:"
msgstr ""

#: src/1252-open-options.md:624
msgid "Windows: `FILE_FLAG_WRITE_THROUGH` for `.sync_all()`"
msgstr ""

#: src/1252-open-options.md:625
msgid "Unix: `O_SYNC` for `.sync_all()` and `O_DSYNC` for `.sync_data()`"
msgstr ""

#: src/1252-open-options.md:627
msgid ""
"If a system does not support syncing only data, this option will fall back "
"to syncing both data and metadata. If `.sync_all(true)` is specified, `."
"sync_data()` is ignored."
msgstr ""

#: src/1252-open-options.md:632
msgid "Direct access / no caching"
msgstr ""

#: src/1252-open-options.md:633
msgid ""
"Most operating systems offer a mode that reads data straight from disk to an "
"application buffer, or that writes straight from a buffer to disk. This "
"avoid the small cost of a memory copy. It has the side effect that the data "
"is not available to the os to provide caching. Also, because this does not "
"use the _os staging area_ all reads and writes have to take care of data "
"sizes and alignment themselves."
msgstr ""

#: src/1252-open-options.md:640
msgid "Overview:"
msgstr ""

#: src/1252-open-options.md:641
msgid "_os staging area_: not used"
msgstr ""

#: src/1252-open-options.md:642
msgid "_read-ahead_: not used"
msgstr ""

#: src/1252-open-options.md:643
msgid "_os cache_: data may be used, but is not added"
msgstr ""

#: src/1252-open-options.md:644
msgid "_delayed writing_: no delay"
msgstr ""

#: src/1252-open-options.md:645
msgid "_on-disk write cache_: maybe"
msgstr ""

#: src/1252-open-options.md:648
msgid "Windows: flag `FILE_FLAG_NO_BUFFERING`"
msgstr ""

#: src/1252-open-options.md:649
msgid "Linux, FreeBSD, NetBSD, Dragonfly BSD: flag `O_DIRECT`"
msgstr ""

#: src/1252-open-options.md:651
msgid ""
"The other options offer a more fine-grained control over caching, and "
"usually offer better performance or correctness guarantees. This option is "
"sometimes used by applications as a crude way to control (disable) the _os "
"cache_."
msgstr ""

#: src/1252-open-options.md:655
msgid ""
"Rust should not currently expose this as an open option, because it should "
"be used with an abstraction / external crate that handles the data size and "
"alignment requirements. If it should be used at all."
msgstr ""

#: src/1252-open-options.md:660
msgid "Unresolved questions"
msgstr ""

#: src/1252-open-options.md:661
msgid "None."
msgstr ""
