msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-01T05:53:03Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Language: en\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/1643-memory-model-strike-team.md:1
msgid "Feature Name: N/A"
msgstr ""

#: src/1643-memory-model-strike-team.md:2
msgid "Start Date: 2016-06-07"
msgstr ""

#: src/1643-memory-model-strike-team.md:3
msgid ""
"RFC PR: [rust-lang/rfcs#1643](https://github.com/rust-lang/rfcs/pull/1643)"
msgstr ""

#: src/1643-memory-model-strike-team.md:4
msgid "Rust Issue: N/A"
msgstr ""

#: src/1643-memory-model-strike-team.md:6
msgid "Summary"
msgstr ""

#: src/1643-memory-model-strike-team.md:9
msgid ""
"Incorporate a strike team dedicated to preparing rules and guidelines for "
"writing unsafe code in Rust (commonly referred to as Rust's \"memory "
"model\"), in cooperation with the lang team. The discussion will generally "
"proceed in phases, starting with establishing high-level principles and "
"gradually getting down to the nitty gritty details (though some back and "
"forth is expected). The strike team will produce various intermediate "
"documents that will be submitted as normal RFCs."
msgstr ""

#: src/1643-memory-model-strike-team.md:18
msgid "Motivation"
msgstr ""

#: src/1643-memory-model-strike-team.md:21
msgid ""
"Rust's safe type system offers very strong aliasing information that "
"promises to be a rich source of compiler optimization.  For example, in safe "
"code, the compiler can infer that if a function takes two `&mut T` "
"parameters, those two parameters must reference disjoint areas of memory "
"(this allows optimizations similar to C99's `restrict` keyword, except that "
"it is both automatic and fully enforced). The compiler also knows that given "
"a shared reference type `&T`, the referent is immutable, except for data "
"contained in an `UnsafeCell`."
msgstr ""

#: src/1643-memory-model-strike-team.md:30
msgid ""
"Unfortunately, there is a fly in the ointment. Unsafe code can easily be "
"made to violate these sorts of rules. For example, using unsafe code, it is "
"trivial to create two `&mut` references that both refer to the same memory "
"(and which are simultaneously usable).  In that case, if the unsafe code "
"were to (say) return those two points to safe code, that would undermine "
"Rust's safety guarantees -- hence it's clear that this code would be "
"\"incorrect\"."
msgstr ""

#: src/1643-memory-model-strike-team.md:38
msgid ""
"But things become more subtle when we just consider what happens _within_ "
"the abstraction. For example, is unsafe code allowed to use two overlapping "
"`&mut` references internally, without returning it to the wild? Is it all "
"right to overlap with `*mut`? And so forth."
msgstr ""

#: src/1643-memory-model-strike-team.md:43
msgid ""
"It is the contention of this RFC that a complete guidelines for unsafe code "
"are far too big a topic to be fruitfully addressed in a single RFC. "
"Therefore, this RFC proposes the formation of a dedicated **strike team** "
"(that is, a temporary, single-purpose team) that will work on hammering out "
"the details over time. Precise membership of this team is not part of this "
"RFC, but will be determined by the lang team as well as the strike team "
"itself."
msgstr ""

#: src/1643-memory-model-strike-team.md:51
msgid ""
"The unsafe guidelines work will proceed in rough stages, described below. An "
"initial goal is to produce a **high-level summary detailing the general "
"approach of the guidelines.** Ideally, this summary should be sufficient to "
"help guide unsafe authors in best practices that are most likely to be "
"forwards compatible. Further work will then expand on the model to produce a "
"more **detailed set of rules**, which may in turn require revisiting the "
"high-level summary if contradictions are uncovered."
msgstr ""

#: src/1643-memory-model-strike-team.md:60
msgid ""
"This new \"unsafe code\" strike team is intended to work in collaboration "
"with the existing lang team. Ultimately, whatever rules are crafted must be "
"adopted with the **general consensus of both the strike team and the lang "
"team**. It is expected that lang team members will be more involved in the "
"early discussions that govern the overall direction and less involved in the "
"fine details."
msgstr ""

#: src/1643-memory-model-strike-team.md:67
msgid "History and recent discussions"
msgstr ""

#: src/1643-memory-model-strike-team.md:69
msgid ""
"The history of optimizing C can be instructive. All code in C is effectively "
"unsafe, and so in order to perform optimizations, compilers have come to "
"lean heavily on the notion of \"undefined behavior\" as well as various ad-"
"hoc rules about what programs ought not to do (see e.g. [these](http://blog."
"llvm.org/2011/05/what-every-c-programmer-should-know.html) [three](http://"
"blog.llvm.org/2011/05/what-every-c-programmer-should-know_14.html) [posts]"
"(http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_21.html) "
"entitled \"What Every C Programmer Should Know About Undefined Behavior\", "
"by Chris Lattner). This can cause some very surprising behavior (see e.g. "
"[\"What Every Compiler Author Should Know About Programmers\"](http://www."
"complang.tuwien.ac.at/kps2015/proceedings/KPS_2015_submission_29.pdf) or "
"[this blog post by John Regehr](http://blog.regehr.org/archives/761), which "
"is quite humorous).  Note that Rust has a big advantage over C here, in that "
"only the authors of unsafe code should need to worry about these rules."
msgstr ""

#: src/1643-memory-model-strike-team.md:87
msgid ""
"In terms of Rust itself, there has been a large amount of discussion over "
"the years. Here is a (non-comprehensive) set of relevant links, with a "
"strong bias towards recent discussion:"
msgstr ""

#: src/1643-memory-model-strike-team.md:91
msgid ""
"[RFC Issue #1447](https://github.com/rust-lang/rfcs/issues/1447) provides a "
"general set of links as well as some discussion."
msgstr ""

#: src/1643-memory-model-strike-team.md:93
msgid ""
"[RFC #1578](https://github.com/rust-lang/rfcs/pull/1578) is an initial "
"proposal for a Rust memory model by ubsan."
msgstr ""

#: src/1643-memory-model-strike-team.md:95
msgid ""
"The [Tootsie Pop](http://smallcultfollowing.com/babysteps/blog/2016/05/27/"
"the-tootsie-pop-model-for-unsafe-code/) blog post by nmatsakis proposed an "
"alternative approach, building on [background about unsafe abstractions]"
"(http://smallcultfollowing.com/babysteps/blog/2016/05/23/unsafe-"
"abstractions/) described in an earlir post. There is also a lot of valuable "
"discussion in [the corresponding internals thread](http://smallcultfollowing."
"com/babysteps/blog/2016/05/23/unsafe-abstractions/)."
msgstr ""

#: src/1643-memory-model-strike-team.md:103
msgid "Other factors"
msgstr ""

#: src/1643-memory-model-strike-team.md:105
msgid ""
"Another factor that must be considered is the interaction with weak memory "
"models. Most of the links above focus purely on sequential code: Rust has "
"more-or-less adopted the C++ memory model for governing interactions across "
"threads. But there may well be subtle cases that arise we delve deeper. For "
"more on the C++ memory model, see [Hans Boehm's excellent webpage](http://"
"www.hboehm.info/c++mm/)."
msgstr ""

#: src/1643-memory-model-strike-team.md:112
msgid "Detailed design"
msgstr ""

#: src/1643-memory-model-strike-team.md:115
msgid "Scope"
msgstr ""

#: src/1643-memory-model-strike-team.md:117
msgid ""
"Here are some of the issues that should be resolved as part of these unsafe "
"code guidelines. The following list is not intended as comprehensive "
"(suggestions for additions welcome):"
msgstr ""

#: src/1643-memory-model-strike-team.md:121
msgid "Legal aliasing rules and patterns of memory accesses"
msgstr ""

#: src/1643-memory-model-strike-team.md:122
msgid ""
"e.g., which of the patterns listed in [rust-lang/rust#19733](https://github."
"com/rust-lang/rust/issues/19733) are legal?"
msgstr ""

#: src/1643-memory-model-strike-team.md:124
msgid "can unsafe code create (but not use) overlapping `&mut`?"
msgstr ""

#: src/1643-memory-model-strike-team.md:125
msgid "under what conditions is it legal to dereference a `*mut T`?"
msgstr ""

#: src/1643-memory-model-strike-team.md:126
msgid "when can an `&mut T` legally alias an `*mut T`?"
msgstr ""

#: src/1643-memory-model-strike-team.md:127
msgid "Struct layout guarantees"
msgstr ""

#: src/1643-memory-model-strike-team.md:128
msgid "Interactions around zero-sized types"
msgstr ""

#: src/1643-memory-model-strike-team.md:129
msgid "e.g., what pointer values can legally be considered a `Box<ZST>`?"
msgstr ""

#: src/1643-memory-model-strike-team.md:130
msgid "Allocator dependencies"
msgstr ""

#: src/1643-memory-model-strike-team.md:132
msgid ""
"One specific area that we can hopefully \"outsource\" is detailed rules "
"regarding the interaction of different threads. Rust exposes atomics that "
"roughly correspond to C++11 atomics, and the intention is that we can layer "
"our rules for sequential execution atop those rules for parallel execution."
msgstr ""

#: src/1643-memory-model-strike-team.md:138
msgid "Termination conditions"
msgstr ""

#: src/1643-memory-model-strike-team.md:140
msgid ""
"The unsafe code guidelines team is intended as a temporary strike team with "
"the goal of producing the documents described below. Once the RFC for those "
"documents have been approved, responsibility for maintaining the documents "
"falls to the lang team."
msgstr ""

#: src/1643-memory-model-strike-team.md:145
msgid "Time frame"
msgstr ""

#: src/1643-memory-model-strike-team.md:147
msgid ""
"Working out a a set of rules for unsafe code is a detailed process and is "
"expected to take months (or longer, depending on the level of detail we "
"ultimately aim for). However, the intention is to publish preliminary "
"documents as RFCs as we go, so hopefully we can be providing ever more "
"specific guidance for unsafe code authors."
msgstr ""

#: src/1643-memory-model-strike-team.md:153
msgid ""
"Note that even once an initial set of guidelines is adopted, problems or "
"inconsistencies may be found. If that happens, the guidelines will be "
"adjusted as needed to correct the problem, naturally with an eye towards "
"backwards compatibility. In other words, the unsafe guidelines, like the "
"rules for Rust language itself, should be considered a \"living document\"."
msgstr ""

#: src/1643-memory-model-strike-team.md:160
msgid ""
"As a note of caution, experience from other languages such as Java or C++ "
"suggests that the work on memory models can take years. Moreover, even once "
"a memory model is adopted, it can be unclear whether [common compiler "
"optimizations are actually permitted](http://www.di.ens.fr/~zappa/readings/"
"c11comp.pdf) under the model. The hope is that by focusing on sequential and "
"Rust-specific issues we can sidestep some of these quandries."
msgstr ""

#: src/1643-memory-model-strike-team.md:167
msgid "Intermediate documents"
msgstr ""

#: src/1643-memory-model-strike-team.md:169
msgid ""
"Because hammering out the finer points of the memory model is expected to "
"possibly take some time, it is important to produce intermediate agreements. "
"This section describes some of the documents that may be useful. These also "
"serve as a rough guideline to the overall \"phases\" of discussion that are "
"expected, though in practice discussion will likely go back and forth:"
msgstr ""

#: src/1643-memory-model-strike-team.md:176
msgid ""
"**Key examples and optimizations**: highlighting code examples that ought to "
"work, or optimizations we should be able to do, as well as some that will "
"not work, or those whose outcome is in doubt."
msgstr ""

#: src/1643-memory-model-strike-team.md:179
msgid ""
"**High-level design**: describe the rules at a high-level. This would likely "
"be the document that unsafe code authors would read to know if their code is "
"correct in the majority of scenarios. Think of this as the \"user's guide\"."
msgstr ""

#: src/1643-memory-model-strike-team.md:183
msgid ""
"**Detailed rules**: More comprehensive rules. Think of this as the "
"\"reference manual\"."
msgstr ""

#: src/1643-memory-model-strike-team.md:186
msgid ""
"Note that both the \"high-level design\" and \"detailed rules\", once "
"considered complete, will be submitted as RFCs and undergo the usual final "
"comment period."
msgstr ""

#: src/1643-memory-model-strike-team.md:190
msgid "Key examples and optimizations"
msgstr ""

#: src/1643-memory-model-strike-team.md:192
msgid ""
"Probably a good first step is to agree on some key examples and overall "
"principles. Examples would fall into several categories:"
msgstr ""

#: src/1643-memory-model-strike-team.md:195
msgid "Unsafe code that we feel **must** be considered **legal** by any model"
msgstr ""

#: src/1643-memory-model-strike-team.md:196
msgid ""
"Unsafe code that we feel **must** be considered **illegal** by any model"
msgstr ""

#: src/1643-memory-model-strike-team.md:197
msgid "Unsafe code that we feel **may or may not** be considered legal"
msgstr ""

#: src/1643-memory-model-strike-team.md:198
msgid "Optimizations that we **must** be able to perform"
msgstr ""

#: src/1643-memory-model-strike-team.md:199
msgid "Optimizations that we **should not** expect to be able to perform"
msgstr ""

#: src/1643-memory-model-strike-team.md:200
msgid ""
"Optimizations that it would be nice to have, but which may be sacrificed if "
"needed"
msgstr ""

#: src/1643-memory-model-strike-team.md:203
msgid ""
"Having such guiding examples naturally helps to steer the effort, but it "
"also helps to provide guidance for unsafe code authors in the meantime. "
"These examples illustrate patterns that one can adopt with reasonable "
"confidence."
msgstr ""

#: src/1643-memory-model-strike-team.md:208
msgid ""
"Deciding about these examples should also help in enumerating the guiding "
"principles we would like to adhere to. The design of a memory model "
"ultimately requires balancing several competing factors and it may be useful "
"to state our expectations up front on how these will be weighed:"
msgstr ""

#: src/1643-memory-model-strike-team.md:214
msgid "**Optimization.** The stricter the rules, the more we can optimize."
msgstr ""

#: src/1643-memory-model-strike-team.md:215
msgid ""
"on the other hand, rules that are overly strict may prevent people from "
"writing unsafe code that they would like to write, ultimately leading to "
"slower execution."
msgstr ""

#: src/1643-memory-model-strike-team.md:218
msgid ""
"**Comprehensibility.** It is important to strive for rules that end users "
"can readily understand. If learning the rules requires diving into academic "
"papers or using Coq, it's a non-starter."
msgstr ""

#: src/1643-memory-model-strike-team.md:221
msgid ""
"**Effect on existing code.** No matter what model we adopt, existing unsafe "
"code may or may not comply. If we then proceed to optimize, this could cause "
"running code to stop working. While [RFC 1122](https://github.com/rust-lang/"
"rfcs/blob/master/text/1122-language-semver.md) explicitly specified that the "
"rules for unsafe code may change, we will have to decide where to draw the "
"line in terms of how much to weight backwards compatibility."
msgstr ""

#: src/1643-memory-model-strike-team.md:229
#: src/1643-memory-model-strike-team.md:258
msgid ""
"It is expected that the lang team will be **highly involved** in this "
"discussion."
msgstr ""

#: src/1643-memory-model-strike-team.md:231
msgid "It is also expected that we will gather examples in the following ways:"
msgstr ""

#: src/1643-memory-model-strike-team.md:233
msgid "survey existing unsafe code;"
msgstr ""

#: src/1643-memory-model-strike-team.md:234
msgid "solicit suggestions of patterns from the Rust-using public:"
msgstr ""

#: src/1643-memory-model-strike-team.md:235
msgid "scenarios where they would like an official judgement;"
msgstr ""

#: src/1643-memory-model-strike-team.md:236
msgid "interesting questions involving the standard library."
msgstr ""

#: src/1643-memory-model-strike-team.md:238
msgid "High-level design"
msgstr ""

#: src/1643-memory-model-strike-team.md:240
msgid ""
"The next document to produce is to settle on a high-level design. There have "
"already been several approaches floated. This phase should build on the "
"examples from before, in that proposals can be weighed against their effect "
"on the examples and optimizations."
msgstr ""

#: src/1643-memory-model-strike-team.md:245
msgid ""
"There will likely also be some feedback between this phase and the previous: "
"as new proposals are considered, that may generate new examples that were "
"not relevant previously."
msgstr ""

#: src/1643-memory-model-strike-team.md:249
msgid ""
"Note that even once a high-level design is adopted, it will be considered "
"\"tentative\" and \"unstable\" until the detailed rules have been worked out "
"to a reasonable level of confidence."
msgstr ""

#: src/1643-memory-model-strike-team.md:253
msgid ""
"Once a high-level design is adopted, it may also be used by the compiler "
"team to inform which optimizations are legal or illegal. However, if changes "
"are later made, the compiler will naturally have to be adjusted to match."
msgstr ""

#: src/1643-memory-model-strike-team.md:260
msgid "Detailed rules"
msgstr ""

#: src/1643-memory-model-strike-team.md:262
msgid ""
"Once we've settled on a high-level path -- and, no doubt, while in the "
"process of doing so as well -- we can begin to enumerate more detailed "
"rules. It is also expected that working out the rules may uncover "
"contradictions or other problems that require revisiting the high-level "
"design."
msgstr ""

#: src/1643-memory-model-strike-team.md:268
msgid "Lints and other checkers"
msgstr ""

#: src/1643-memory-model-strike-team.md:270
msgid ""
"Ideally, the team will also consider whether automated checking for "
"conformance is possible. It is not a responsibility of this strike team to "
"produce such automated checking, but automated checking is naturally a big "
"plus!"
msgstr ""

#: src/1643-memory-model-strike-team.md:275
msgid "Repository"
msgstr ""

#: src/1643-memory-model-strike-team.md:277
msgid ""
"In general, the memory model discussion will be centered on a specific "
"repository (perhaps <https://github.com/nikomatsakis/rust-memory-model>, but "
"perhaps moved to the rust-lang organization). This allows for multi-faced "
"discussion: for example, we can open issues on particular questions, as well "
"as storing the various proposals and litmus tests in their own directories. "
"We'll work out and document the procedures and conventions here as we go."
msgstr ""

#: src/1643-memory-model-strike-team.md:286
msgid "Drawbacks"
msgstr ""

#: src/1643-memory-model-strike-team.md:289
msgid ""
"The main drawback is that this discussion will require time and energy which "
"could be spent elsewhere. The justification for spending time on developing "
"the memory model instead is that it is crucial to enable the compiler to "
"perform aggressive optimizations. Until now, we've limited ourselves by and "
"large to conservative optimizations (though we do supply some LLVM aliasing "
"hints that can be affected by unsafe code). As the transition to MIR comes "
"to fruition, it is clear that we will be in a place to perform more "
"aggressive optimization, and hence the need for rules and guidelines is "
"becoming more acute. We can continue to adopt a conservative course, but "
"this risks growing an ever larger body of code dependent on the compiler not "
"performing aggressive optimization, which may close those doors forever."
msgstr ""

#: src/1643-memory-model-strike-team.md:302
msgid "Alternatives"
msgstr ""

#: src/1643-memory-model-strike-team.md:305
msgid "Adopt a memory model in one fell swoop:"
msgstr ""

#: src/1643-memory-model-strike-team.md:306
msgid "considered too complicated"
msgstr ""

#: src/1643-memory-model-strike-team.md:307
msgid "Defer adopting a memory model for longer:"
msgstr ""

#: src/1643-memory-model-strike-team.md:308
msgid "considered too risky"
msgstr ""

#: src/1643-memory-model-strike-team.md:310
msgid "Unresolved questions"
msgstr ""

#: src/1643-memory-model-strike-team.md:313
msgid "None."
msgstr ""
