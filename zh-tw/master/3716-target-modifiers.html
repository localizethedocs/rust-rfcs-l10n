<!DOCTYPE HTML>
<html lang="zh_TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>3716-target-modifiers - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-c5bb60c5.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: <code>target_modifiers</code></li>
<li>Start Date: 2024-10-24</li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/3716">rust-lang/rfcs#3716</a></li>
<li>Rust Issue: None</li>
</ul>
<h2 id="摘要"><a class="header" href="#摘要">摘要</a></h2>
<ul>
<li>We introduce the concept of “target modifier”. A target modifier is a flag where it may be unsound if you link together two compilation units that disagree on the flag.</li>
<li>We fail the build if rustc can see two Rust compilation units that do not agree on the exact set of target modifier flags.</li>
<li>There are already several existing flags that could fall into this category. There are also hypothetical new flags that do.</li>
<li>The error can be silenced using the <code>-Cunsafe-allow-abi-mismatch</code> escape hatch.</li>
<li>Not having a stable way to build stdlib crates does not block stabilization of target modifiers.</li>
<li>As a future extension we may be able to relax the rules to allow some specific kinds of mismatches.</li>
<li>This RFC does not stabilize any target modifiers. That should happen in follow-up MCPs/FCPs/RFCs/etc.</li>
</ul>
<h2 id="動機"><a class="header" href="#動機">動機</a></h2>
<p>As Rust expands into low-level domains, there will be a need for precise control over how code is compiled. This often manifests as a new compiler flag. Some of these flags trigger undefined behavior if used incorrectly, which is in tension with Rust’s safety goals. This RFC proposes a new mechanism to allow use of such flags while also preventing undefined behavior.</p>
<p>The primary goal of this RFC is to unblock <em>stabilization</em> of target modifier flags. Adding them as unstable (and unsound) flags is already happening today without this RFC.</p>
<h3 id="the-linux-kernel"><a class="header" href="#the-linux-kernel">The Linux Kernel</a></h3>
<p>The Linux Kernel has run into a handful of cases where it is necessary to tweak the ABI used in the kernel. Often, this is done conditionally depending on a configuration option. A few examples:</p>
<ul>
<li>When using <code>CONFIG_SHADOW_CALLSTACK</code> the x18 register must be reserved in the ABI with <code>-Zfixed-x18</code>.</li>
<li>The <code>-Ctarget-feature=-neon</code> flag is used to prevent use of floating points on arm.</li>
<li>On 32-bit x86, <code>-Zreg-struct-return</code> and <code>-Zregparm=3</code> are used.</li>
<li>When using <code>CONFIG_CFI_CLANG</code> the kCFI sanitizer is enabled with <code>-Zsanitizer=kcfi</code>. Unlike most other sanitizers, this sanitizer is used in production.</li>
<li>In several different cases, <code>-Zpatchable-function-entry</code> is used to add nops before or after the function entrypoint. When mixed with <code>-Zsanitizer=kcfi</code> this causes special considerations as kcfi works by placing a tag before the function entrypoint.</li>
<li>To support <code>MITIGATION_RETPOLINE</code> and <code>MITIGATION_SLS</code>, <code>target.json</code> is used on x86.</li>
</ul>
<p>We expect there to be more examples in the future.</p>
<h3 id="sanitizers"><a class="header" href="#sanitizers">Sanitizers</a></h3>
<p>There is <a href="https://github.com/rust-lang/rust/issues/123615">an ongoing effort to stabilize some of the sanitizers</a>. However, this effort explicitly aims to stabilize sanitizers that can be used without rebuilding the stdlib. With this RFC, that is no longer a blocker as the remaining sanitizers can be classified as a target modifier and then stabilized.</p>
<h3 id="embedded-targets"><a class="header" href="#embedded-targets">Embedded Targets</a></h3>
<p>Currently, embedded platforms such as <code>thumb*</code> or <code>rv*</code> use separate targets for configuration with significant ABI changes. For <code>thumb*</code> targets, this is currently limited to Hard- vs Soft-Float which can cause issues when linked. However for RISC-V targets, the F (32-bit hardware float), D (64-bit hardware float), and Q (128-bit hardware float) extensions all can <a href="https://github.com/riscv-non-isa/riscv-elf-psabi-doc/blob/master/riscv-cc.adoc#named-abis">potentially change the ABI</a>, which would increase the number of required targets. The <a href="https://github.com/riscv/riscv-isa-manual/blob/main/src/rv32e.adoc">E extension</a> may also change the ABI by limiting the number of registers used by the I (integer operations) extension.</p>
<h3 id="existing--c-flags-that-are-unsound"><a class="header" href="#existing--c-flags-that-are-unsound">Existing -C flags that are unsound</a></h3>
<p>It has recently been discovered that several existing <code>-C</code> flags modify the ABI, making them unsound. Examples:</p>
<ul>
<li><a href="https://github.com/rust-lang/rust/issues/129893"><code>-Csoft-float</code></a></li>
<li><a href="https://github.com/rust-lang/rust/issues/131058"><code>-Ctarget-feature=-neon</code></a></li>
<li><a href="https://github.com/rust-lang/rust/issues/127979"><code>-Clinker-plugin-lto</code></a></li>
<li><a href="https://github.com/rust-lang/rust/issues/131800#issuecomment-2418595757"><code>-Cllvm-args</code></a></li>
<li>Possibly <code>-Ccode-model</code> and <code>-Crelocation-model</code></li>
</ul>
<p>This problem is a new discovery and it’s still not clear how to solve it. Target modifiers will not solve all of the flags; <a href="https://github.com/rust-lang/rust/issues/130968">some flags are just unfixable and need to be removed</a>. But I expect that target modifiers will be the solution for some of these flags.</p>
<h2 id="guide-level-explanation"><a class="header" href="#guide-level-explanation">Guide-level explanation</a></h2>
<p>The Rust compiler has many flags that affect how source code is turned into machine code. Some flags can be turned on and off for each CU (compilation unit) in your project separately, and other flags must be applied to the entire application as a whole. The typical reason for flags to be in the latter category is that change some aspect of the ABI. For example, <code>-Zreg-struct-return</code> changes how to return a struct from a function call, and both the caller and callee must agree on how to do that even if they are in different CUs.</p>
<p>The Rust compiler will detect if you incorrectly use a flag that must be applied to the application as a whole. For example, if you compile the standard library with <code>-Zreg-struct-return</code>, but don’t pass the flag when compiling a dependency, then you will get the following error:</p>
<pre><code>error: mixing -Zreg-struct-return will cause an ABI mismatch

help: This error occurs because the -Zreg-struct-return flag modifies the ABI, 
      and different crates in your project were compiled with inconsistent
      settings.
help: To resolve this, ensure that -Zreg-struct-return is set to the same value
      for all crates during compilation.
help: To ignore this error, recompile with the following flag:
      -Cunsafe-allow-abi-mismatch=reg-struct-return
</code></pre>
<p>As an escape hatch, you can use <code>-Cunsafe-allow-abi-mismatch=reg-struct-return</code> to disable the error. Using this flag is unsafe as incorrect use of the ABI is undefined behavior. However, there may be some cases where the check is too strict, and you can use the flag to proceed in those cases.</p>
<p>The requirement that all CUs agree includes stdlib crates (core, alloc, std), so using these flags usually requires that you compile your own standard library with <code>-Zbuild-std</code> or by directly invoking <code>rustc</code>. That said, some flags (e.g., <code>-Cpanic</code>) have mechanisms to avoid this requirement.</p>
<h2 id="reference-level-explanation"><a class="header" href="#reference-level-explanation">Reference-level explanation</a></h2>
<p>A compiler flag can be classified as a <em>target modifier</em>. When a flag is a target modifier, it can be undefined behavior to link together two CUs that disagree on the flag.</p>
<p>To avoid unsoundness from mixing target modifiers, rustc will store the set of target modifiers in use in the crate metadata of each crate. Whenever rustc is invoked, it will inspect the crate metadata of all crates that are visible to it (usually the current crate and its direct dependencies) and emit an error if any of them have mismatched target modifiers in use.</p>
<p>The <code>-Cunsafe-allow-abi-mismatch=flagname</code> flag can be used when compiling a crate to indicate that it should not be included in the list of crates when checking that all crates agree on <code>flagname</code>.</p>
<p>Note that <code>-Cunsafe-allow-abi-mismatch=flagname</code> should be passed to rustc when compiling the crate that uses an incompatible value for <code>flagname</code>, which may not be the same rustc invocation as the one where the mismatch is detected. For example, if you build four CUs A,B,C,D where D depends on A,B,C and C is the only one with a different value for <code>flagname</code>, then the mismatch is detected by rustc when compiling D, but <code>-Cunsafe-allow-abi-mismatch</code> should be used when compiling C.</p>
<h3 id="stabilization"><a class="header" href="#stabilization">Stabilization</a></h3>
<p>It is possible to stabilize target modifiers even if they cannot be utilized without an unstable feature such as <code>-Zbuild-std</code>.</p>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<h3 id="teaching"><a class="header" href="#teaching">Teaching</a></h3>
<p>We should be careful to not introduce too many concepts that end-users have to learn.</p>
<p>It is intentional that the guide-level section of this RFC does not use the word “target modifier”. The “target modifier” name is not intended to be used outside of the compiler internals and very technical documentation. Compiler errors should not say “error: trying to mix target modifiers” or something like that; rather the error should just say that mixing <code>-Cfoo</code> may cause ABI issues.</p>
<p>For similar reasons, the flag for silencing the error is called <code>-Cunsafe-allow-abi-mismatch</code> with the word “ABI” to avoid having to teach the user about mismatched flags or target modifiers.</p>
<h2 id="rationale-and-alternatives"><a class="header" href="#rationale-and-alternatives">Rationale and alternatives</a></h2>
<h3 id="why-not-just-add-flags-like-normal"><a class="header" href="#why-not-just-add-flags-like-normal">Why not just add flags like normal?</a></h3>
<p>Preventing undefined behaviour is an important goal of the Rust project. If we add flags that change the abi, then that is in direct opposition to that goal, as mixing them would lead to UB.</p>
<h3 id="why-not-just-add-new-targets"><a class="header" href="#why-not-just-add-new-targets">Why not just add new targets?</a></h3>
<p>The flag that started this entire discussion is <code>-Zfixed-x18</code>. This flag changes the ABI by changing the x18 register from a caller-saved temporary register to a reserved register. At the time, people suggested adding a new target (e.g., <code>aarch64-unknown-none-fixed18</code>), instead of adding a dedicated <code>-Zfixed-x18</code> flag.</p>
<p>The primary benefit of adding a new target is that it’s a workaround for <code>-Zbuild-std</code> being unstable. Each new target will get a prebuilt stdlib, which sidesteps the need for building your own stdlib.</p>
<p>This RFC does not propose this solution because:</p>
<ol>
<li>The primary benefit is not being blocked on stabilization of <code>-Zbuild-std</code>. However, I don’t think we really are blocked on stabilization of <code>-Zbuild-std</code> in the first place. See <a href="#stabilization-of-target-modifiers">the stabilization of target modifier flags section</a> below.</li>
<li>Target modifiers help with other problems such as unblocking the stabilization of sanitizers as well as existing <code>-C</code> flags that are unsound due to ABI issues. Adding new targets would leave these issues unsolved.</li>
<li>Adding new targets risks an exponential number of targets. In the kernel on x86 we would need 8 different targets to support the different possible kernel configurations. It’s not hard to imagine that number growing to 16 or 32 targets in the near future, especially once you consider that other embedded projects may have their own set of target modifier flags.</li>
<li>Adding new prebuilt stdlibs does not actually help the projects that need these flags. Even if a prebuilt stdlib is provided for every combination of ABI-affecting flags that the kernel may need, the kernel has other reasons that require building a custom <code>core</code>.</li>
</ol>
<h3 id="why-not-use-targetjson"><a class="header" href="#why-not-use-targetjson">Why not use <code>target.json</code></a></h3>
<p>Because the <code>target.json</code> feature is perma-unstable, and this RFC primarily concerns itself with unblocking the <em>stabilization</em> of these flags. Adding target modifiers as unstable flags is already happening today. (However, if this RFC gets accepted, it becomes a soundness bug to add such unstable flags without wiring them up with the target modifier machinery.)</p>
<p>One possible alternative would be to stabilize a subset of <code>target.json</code>. However, I don’t think there’s much benefit to this. It just means that you now have to learn two different ways of passing flags to the compiler. See <a href="#teaching">the Teaching section</a> above.</p>
<p>It would also be inconvenient to use in external build systems. Right now, the kernel passes the <code>-Zfixed-x18</code> flag like this:</p>
<pre><code class="language-make">ifeq ($(CONFIG_SHADOW_CALL_STACK), y)
KBUILD_CFLAGS    += -ffixed-x18
KBUILD_RUSTFLAGS += -Zfixed-x18
endif
</code></pre>
<p>If <code>-Zfixed-x18</code> had to be specified in a <code>target.json</code> file, it would need to happen in an entirely different part of the kernel build system. It is better to specify the rustc flag together with the clang/gcc flag.</p>
<h3 id="stabilization-of-target-modifiers"><a class="header" href="#stabilization-of-target-modifiers">Stabilization of target modifiers</a></h3>
<p>Using a target modifier without rebuilding the Rust stdlib is often not possible. This means that some target modifiers can only be used in tandem with <code>-Zbuild-std</code>, which is currently unstable.</p>
<p>However, there’s no reason we <em>have</em> to block the stabilization of target modifiers on the stabilization of <code>-Zbuild-std</code>. If a target modifier <code>-Cfoo</code> is stabilized, then you can break users of <code>-Cfoo</code> with the reason “we changed the way you pass flags to <code>core</code>”, but you can’t break users with the reason “we renamed <code>-Cfoo</code> to <code>-Cbar</code>; this is okay because you’re also using <code>-Zbuild-std</code> even though the rename is unrelated to <code>-Zbuild-std</code>”.</p>
<h3 id="not-all-mismatches-are-unsound"><a class="header" href="#not-all-mismatches-are-unsound">Not all mismatches are unsound</a></h3>
<p>This RFC says that mismatching target modifiers in any way results in a build error. However, there are a lot of cases where the real rules are more complicated than that. For example, with the following three CUs:</p>
<ul>
<li>CU A compiled with <code>-Zfixed-x18 -Zsanitizer=shadow-call-stack</code>.</li>
<li>CU B compiled with <code>-Zfixed-x18</code>.</li>
<li>CU C compiled with neither flag.</li>
</ul>
<p>It is unsound to link together CUs A and C, but linking A with B or B with C is sound.</p>
<p>However, real-world scenarios where mismatching a target modifier is necessary are quite uncommon. The only case I’m aware of is the runtime for a sanitizer. For example, when ASAN (address sanitizer) detects a bug, it calls into a special ASAN-failure-handler function. The function for handling ASAN-failures should not be sanitized.</p>
<p>Making the compiler accept specific mismatches that are sound is out of scope for this RFC. Such decisions will be made on a flag-by-flag basis in follow-up decisions (most likely an MCP). Until then, end-users can use <code>-Cunsafe-allow-abi-mismatch</code> to proceed in such cases.</p>
<h3 id="cases-that-are-not-caught"><a class="header" href="#cases-that-are-not-caught">Cases that are not caught</a></h3>
<p>This RFC proposes to store information in the crate metadata to detect ABI mismatches. However, this means that there are two cases that could result in mismatches being missed:</p>
<ul>
<li>When rustc is not doing the final link, different incompatible leaf modules might not get detected. For instance, using the CUs A,B,C from <a href="#not-all-mismatches-are-unsound">the previous section</a>, then if stdlib is CU B and there are two leaf CUs A and C, then the incompatibility between A and C would not get detected unless rustc performs the final link.</li>
<li>With dynamic linking, you may have two shared objects compiled completely separately with incompatible ABIs.</li>
</ul>
<p>Note that the first situation can never happen with the base proposal: if we require exact matches, then all CUs must agree because all CUs depend on <code>core</code>. The missed detection requires that we don’t consider AB or BC incompatible. This could be an argument in favor of not allowing any mismatches with the shadow call stack sanitizer (which you never want to mix in practice anyway).</p>
<p>The dynamic linking case is considered acceptable. Detecting it is out of scope of this RFC.</p>
<h3 id="name-mangling"><a class="header" href="#name-mangling">Name mangling</a></h3>
<p>It has been proposed that the modified target could be encoded in the name mangling scheme to help catch the two cases from <a href="#cases-that-are-not-caught">the previous section</a>. However, this raises a bunch of open questions:</p>
<ol>
<li>It probably does not help catch the first case. Dynamic function calls between the leaf modules wouldn’t get caught, so that would require that one of the leaf modules references a symbol defined by the other leaf module. However, I find it hard to imagine this happening in the real world unless the symbol is marked <code>#[no_mangle]</code>.</li>
<li>Similarly, if two dynamic objects are compiled completely separately, they probably do not reference each other through anything other than symbols marked <code>#[no_mangle]</code>. While it could potentially identify a mismatch where component A depends on component B, and component B is recompiled with a different ABI while using the old version of A, this scenario is not well-supported to start with because of Rust’s unstable ABI.</li>
<li>Some ABI-affecting flags only change the C ABI, but those symbols are usually using <code>#[no_mangle]</code>.</li>
<li>Do we really want to make our symbol names even longer?</li>
</ol>
<p>For the above reasons, name mangling is not proposed as a mechanism for detection for now. However, it could be a potential future addition.</p>
<h3 id="policy-around-flags-that-might-not-be-abi-affecting"><a class="header" href="#policy-around-flags-that-might-not-be-abi-affecting">Policy around flags that might not be ABI affecting</a></h3>
<p>Some flags have an unclear status where it is unclear whether it affects the ABI. For example, <code>-Zpatchable-function-entry</code> (which adds nop instructions before/after the function entrypoint) generally isn’t considered to affect the ABI, but if combined with <code>-Zsanitizer=kcfi</code> then it does affect it since kcfi works by placing a hash of the function signature before the function entrypoint. Since <code>-Zsanitizer=kcfi</code> already needs to be a target modifier <em>anyway</em>, you could argue that <code>-Zpatchable-function-entry</code> doesn’t need to be one.</p>
<p>However, for these cases where we are uncertain, we take a conservative approach and mark them as a target modifier. It is not breaking to relax the rules in future releases.</p>
<p>As for flags such as <code>-Cllvm-args</code> that can do basically anything, it may make more sense to just rename it to <code>-Cunsafe-llvm-args</code> rather than use the target modifier functionality.</p>
<h3 id="problems-with-mixing-non-target-modifiers"><a class="header" href="#problems-with-mixing-non-target-modifiers">Problems with mixing non-target-modifiers</a></h3>
<p>I discussed this proposal with people from other communities (mainly kernel and C folks), and they shared several other cases where mixing flags are a problem. They pointed out that there are some flags where mixing them is really bad and should be detected, but which are not ABI issues or unsound per se. The most common example of this is exploit mitigations, where mixing the flags will silently lead to a vulnerable binary. On the other hand, ABI mismatches usually fail in a loud way, so they were not as concerned about those.</p>
<p>The sections below describe several such cases. They are intended to provide additional context for the reader to better understand the problem space. We will likely want to use the same infrastructure for detecting some of the mismatches mentioned below, but the precise list is out of scope of this RFC.</p>
<p>Since the cases below are not unsound, the flag for overriding them should not include the word “unsafe”.</p>
<h4 id="exploit-mitigations"><a class="header" href="#exploit-mitigations">Exploit mitigations</a></h4>
<p>There are some mitigations that are used to mitigate CPU speculation vulnerabilities (e.g., SPECTRE) or used to make exploitation of vulnerabilities harder (e.g., control flow protection), which work by either telling the compiler to generate code that include instructions to prevent CPU speculation in some specific locations, or telling the compiler to generate code that checks that destinations of indirect branches are one of their valid destinations in the control flow graph. These mitigations usually don’t change the ABI, as they just change how code is generated within functions.</p>
<p>The problem is that the attacks you are trying to mitigate involve either forcing CPU speculation in some specific locations or changing the control flow to an arbitrary attacker-controlled address. If you have an unprotected specific location or unprotected indirect branch anywhere in your program, an attacker may still be able to use it either forcing CPU speculation in these unprotected specific locations, or by changing addresses in memory used by these unprotected indirect branches. This means that if you only apply the mitigation to some CUs, then the CUs that lack the mitigation will be completely unprotected, and the mitigation might be bypassable.</p>
<h4 id="sanitizers-1"><a class="header" href="#sanitizers-1">Sanitizers</a></h4>
<p>This case is rather similar to exploit mitigations.</p>
<p>Some sanitizers can be mixed and matched between CUs without breaking the ABI. For example, on the Android aarch64 target, the shadow call stack sanitizer does not change the ABI, and can be freely mixed between CUs. However, the sanitizer does not catch violations in CUs that don’t enable the sanitizer.</p>
<p>For sanitizers used in production (such as shadow call stack or kcfi) this is particularly problematic, as a vulnerability in sanitized code may allow you to jump into unsanitized code.</p>
<h4 id="notegnuproperty"><a class="header" href="#notegnuproperty">.note.gnu.property</a></h4>
<p>In the case of BTI (<code>-Zbranch-protection=bti</code>), the mitigation relies on the kernel’s ELF loader setting a special bit in the page table. However, setting this bit is only valid if BTI is enabled everywhere. The compiler will use a section called <code>.note.gnu.property</code> to tell the linker whether BTI is enabled, and the linker only propagates <code>.note.gnu.property</code> if all CUs agree on it. This means that if one CU is missing BTI, the linker will disable it for the entire executable, and the kernel’s ELF loader will not set the bit in the page tables when loading the machine code, rendering BTI ineffective.</p>
<h4 id="performance"><a class="header" href="#performance">Performance</a></h4>
<p>Another reason is performance. One some targets, the precompiled stdlib always comes with panic landing pads, even if you’re using <code>-Cpanic=abort</code>. It’s also usually compiled with a very minimal set of target features for greater compatibility. These discrepancies can have an unacceptable impact on performance.</p>
<h4 id="code-patching"><a class="header" href="#code-patching">Code patching</a></h4>
<p>You might use <code>-Zbranch-protection=pac-ret</code> or <code>-Zpatchable-function-entry</code> to insert special instructions at the beginning/end of all functions so you can use runtime code-patching to replace them later. It is only because of the runtime code-patching logic that these flags need to be used everywhere.</p>
<h4 id="debugging-information"><a class="header" href="#debugging-information">Debugging information</a></h4>
<p>Mixing CUs with different options for <code>-Cforce-unwind-tables</code>, <code>-Zdwarf-version</code>, or <code>-Zdebuginfo-compression</code> may result in a binary that you consider to be invalid as you may be unable to read the debugging information. But it would not be an ABI issue.</p>
<h2 id="prior-art"><a class="header" href="#prior-art">Prior art</a></h2>
<h3 id="the-panic-strategy"><a class="header" href="#the-panic-strategy">The panic strategy</a></h3>
<p>The Rust compiler already <em>has</em> infrastructure to detect flag mismatches: the flags <code>-Cpanic</code> and <code>-Zpanic-in-drop</code>. The prebuilt stdlib comes with different pieces depending on which strategy is used, although panic landing flags are not entirely removed when using <code>-Cpanic=abort</code>, as only part of the prebuilt stdlib is switched out.</p>
<h3 id="global-target-modifiers"><a class="header" href="#global-target-modifiers">Global target modifiers</a></h3>
<p>A suggestion that has come up several times (<a href="https://github.com/rust-lang/rust/issues/116972">1</a>, <a href="https://github.com/rust-lang/rust/issues/116973">2</a>, <a href="https://github.com/rust-lang/rust/issues/121970#issuecomment-1978605782">3</a>) is to have a variation of <code>-Ctarget-feature=</code> that must be applied globally, which could be called <code>-Cglobal-target-features=</code>. This is very similar to this RFC, though it is broader as the “target modifier” concept can apply to any compiler flag and not just to a single <code>-Cglobal-target-features=</code> flag.</p>
<h3 id="stabilization-of-things-that-require-nightly-features"><a class="header" href="#stabilization-of-things-that-require-nightly-features">Stabilization of things that require nightly features</a></h3>
<p>This RFC proposes that we shouldn’t block stabilization of target modifiers on a stable way to build libcore. There is precedent in the rust project for unblocking stabilizations in this manner: When <code>#![no_std]</code> was stabilized, <a href="https://rust-lang.github.io/rfcs/1184-stabilize-no_std.html">the RFC</a> said the following:</p>
<blockquote>
<p>As mentioned above, there are three separate lang items which are required by the libcore library to link correctly. These items are:</p>
<ul>
<li><code>panic_fmt</code></li>
<li><code>stack_exhausted</code></li>
<li><code>eh_personality</code></li>
</ul>
<p>This RFC does not attempt to stabilize these lang items for a number of reasons:</p>
<ul>
<li>The exact set of these lang items is somewhat nebulous and may change over time.</li>
<li>The signatures of each of these lang items can either be platform-specific or it’s just “too weird” to stabilize.</li>
<li>These items are pretty obscure and it’s not very widely known what they do or how they should be implemented.</li>
</ul>
<p>Stabilization of these lang items (in any form) will be considered in a future RFC.</p>
</blockquote>
<p>This means that no-std can’t actually be used without providing these symbols in some other way. Doing so is unstable.</p>
<h3 id="notegnuproperty-1"><a class="header" href="#notegnuproperty-1">.note.gnu.property</a></h3>
<p>The <code>.note.gnu.property</code> section discussed previously is an example of C code detecting mismatches of a flag at link time.</p>
<h2 id="未解決的問題"><a class="header" href="#未解決的問題">未解決的問題</a></h2>
<p>This RFC does not stabilize any target modifiers. Such decisions should be made as a follow-up to this RFC on a flag-by-flag basis using the usual process for stabilizing a compiler flag.</p>
<p>The <code>-Cunsafe-allow-abi-mismatch</code> flag will be stabilized when the first target modifier is stabilized.</p>
<h2 id="future-possibilities"><a class="header" href="#future-possibilities">Future possibilities</a></h2>
<p>A possible future extension could be to detect inconsistencies between the ABI of C code and Rust code. This would be an interesting extension, but it is not critical for target modifiers as calling into C is inherently unsafe to start with. Similarly, another possible future extension could be to catch ABI mismatches when using dynamic linking.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="3698-declarative-derive-macros.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="3722-explicit-extern-abis.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="3698-declarative-derive-macros.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="3722-explicit-extern-abis.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
