<!DOCTYPE HTML>
<html lang="zh_TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>3503-frontmatter - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-c5bb60c5.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: <code>frontmatter</code></li>
<li>Start Date: 2023-09-26</li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/3503">rust-lang/rfcs#3503</a></li>
<li>Rust Issue: <a href="https://github.com/rust-lang/cargo/issues/12207">rust-lang/cargo#12207</a></li>
</ul>
<h2 id="摘要"><a class="header" href="#摘要">摘要</a></h2>
<p>Add a frontmatter syntax to Rust as a way for <a href="https://github.com/rust-lang/rfcs/pull/3502">cargo to have manifests embedded in source code</a>:</p>
<pre><code class="language-rust">#!/usr/bin/env cargo
---
[dependencies]
clap = { version = "4.2", features = ["derive"] }
---

use clap::Parser;

#[derive(Parser, Debug)]
#[clap(version)]
struct Args {
    #[clap(short, long, help = "Path to config")]
    config: Option&lt;std::path::PathBuf&gt;,
}

fn main() {
    let args = Args::parse();
    println!("{:?}", args);
}</code></pre>
<h2 id="動機"><a class="header" href="#動機">動機</a></h2>
<p><a href="https://github.com/rust-lang/rfcs/pull/3502">“cargo script”</a> is in need of a syntax for embedding manifests in source. See that RFC for its motivations.</p>
<h2 id="guide-level-explanation"><a class="header" href="#guide-level-explanation">Guide-level explanation</a></h2>
<p>Static site generators use a frontmatter syntax to embed metadata in markdown files:</p>
<pre><code class="language-md">---
name: My Blog Post
---

## Stuff happened

Hello world!
</code></pre>
<p>We are carrying this concept over to Rust while merging some lessons from commonmark’s fenced code blocks:</p>
<pre><code class="language-rust">#!/usr/bin/env cargo
---
[dependencies]
clap = { version = "4.2", features = ["derive"] }
---

use clap::Parser;

#[derive(Parser, Debug)]
#[clap(version)]
struct Args {
    #[clap(short, long, help = "Path to config")]
    config: Option&lt;std::path::PathBuf&gt;,
}

fn main() {
    let args = Args::parse();
    println!("{:?}", args);
}</code></pre>
<p>Like with <a href="https://spec.commonmark.org/0.30/#info-string">commonmark code fences</a>, an info-string is allowed after the opening <code>---</code> for use by the command interpreting the block to identify the contents of the block.</p>
<h2 id="reference-level-explanation"><a class="header" href="#reference-level-explanation">Reference-level explanation</a></h2>
<p>When parsing Rust source, after stripping the shebang (<code>#!</code>), rustc will strip the frontmatter:</p>
<ul>
<li>May include 0+ blank lines (whitespace + newline)</li>
<li>Opens with 3+ dashes followed by 0+ whitespace, an optional term (one or more characters excluding whitespace and commas), 0+ whitespace, and a newline
<ul>
<li>The variable number of dashes is an escaping mechanism in case <code>---</code> shows up in the content</li>
</ul>
</li>
<li>All content is ignored by <code>rustc</code> until the same number of dashes is found at the start of a line. The line must terminate by 0+ whitespace and then a newline.</li>
<li>Unlike commonmark, it is an error to not close the frontmatter seeing to detect problems earlier in the process seeing as the primary content is what comes after the frontmatter</li>
</ul>
<p>This applies anywhere shebang stripping is performed. For example, if <a href="https://doc.rust-lang.org/std/macro.include.html"><code>include!</code></a> strips shebangs, then it will also frontmatter.</p>
<p>As cargo will be the first step in the process to parse this, the responsibility for high quality error messages will largely fall on cargo.</p>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<ul>
<li>A new concept for Rust syntax, adding to overall cognitive load</li>
<li>Ecosystem tooling updates to deal with new syntax</li>
</ul>
<h2 id="rationale-and-alternatives"><a class="header" href="#rationale-and-alternatives">Rationale and alternatives</a></h2>
<p>Within this solution, we considered starting with only allowing this in the root <code>mod</code> (e.g. <code>main.rs</code>) but decided to allow it in any file mostly for ease of implementation. Like with Python, this allows any file in a package (with the correct deps and <code>mod</code>s) to be executed, allowing easier interacting experiences in verifying behavior.</p>
<h3 id="required-vs-optional-shebang"><a class="header" href="#required-vs-optional-shebang">Required vs Optional Shebang</a></h3>
<p>We could require the shebang to be present for all cargo-scripts. This would most negatively impact Windows users as the shebang is a no-op. We still care about Windows because cargo-scripts can still be used for exploration and prototyping, even if they can’t directly be used as drop-in utilities.</p>
<p>The main reason to require a shebang is to positively identify the associated “interpreter”. However, statically analyzing a shebang is <a href="https://stackoverflow.com/questions/38059830/how-does-perl-avoid-shebang-loops">complicated</a> and we are wanting to avoid it in the core workflow. This isn’t to say that tools like rust-analyzer might choose to require it to help their workflow.</p>
<h3 id="blank-lines"><a class="header" href="#blank-lines">Blank lines</a></h3>
<p>Originally, the proposal viewed the block as being “part of” the shebang and didn’t allow them to be separated by blank lines. However, the shebang is optional and users are likely to assume they can use blanklines (see https://www.youtube.com/watch?v=S8MLYZv_54w).</p>
<p>This could cause ordering confusion (doc comments vs attributes vs frontmatter)</p>
<h3 id="infostring"><a class="header" href="#infostring">Infostring</a></h3>
<p>The main question on infostrings is whether they are tool-defined or rustc-defined. At one time, we proposed requiring the infostring and requiring it be <code>cargo</code> as a way to defer this decision.</p>
<p>As the design requirements are catered to processing by external tools, as opposed to rustc, we are instead reserving this syntax for external tools by making the infostrings tool-defined. The Rust toolchain (rustc, clippy, rustdoc, etc) already have access to attributes for user-provided content. If they need a more ergonomic way of specifying content, we should solve that more generally for attributes.</p>
<p>With that decision made, the infostring can be optional. Can it also be deferred out? Possibly, but we are leaving them in for unpredictable exception cases and in case users want to make the syntax explicit for their editor (especially if its not <code>cargo</code> which more trivial editor implementations will likely assume). We may at least defer stabilization of infostrings.</p>
<p>The infostring syntax was selected to allow file names (e.g. <code>Cargo.lock</code>). Additional attributes are left to a future possibility.</p>
<h3 id="syntax"><a class="header" href="#syntax">Syntax</a></h3>
<p><a href="https://github.com/rust-lang/rfcs/pull/3502">RFC 3502</a> lays out some design principles, including</p>
<ul>
<li>Single-file packages should have a first-class experience
<ul>
<li>Provides a higher quality of experience (doesn’t feel like a hack or tacked on)</li>
<li>Transferable knowledge, whether experience, stackoverflow answers, etc</li>
<li>Easier unassisted migration between single-file and multi-file packages</li>
<li>The more the workflows deviate, the higher the maintenance and support costs for the cargo team</li>
</ul>
</li>
</ul>
<p>This led us to wanting to re-use the existing manifest format inside of Rust code. The question is what that syntax for embedding should be.</p>
<p>When choosing the syntax, our care-abouts are</p>
<ul>
<li>How obvious it is for new users when they see it</li>
<li>How easy it is for newer users to remember it and type it out</li>
<li>How machine editable it is for <code>cargo add</code> and friends</li>
<li>Needs to be valid Rust code for quality of error messages, etc</li>
<li>Simple enough syntax for tools to parse without a full Rust parser
<ul>
<li>Leave Rust syntax errors to rustc, rather than masking them with lower quality ones</li>
<li>Ideally we allows random IDE tools (e.g. <a href="https://github.com/Saecki/crates.nvim"><code>crates.nvim</code></a> to still have easy access to the manifest</li>
</ul>
</li>
<li>Leave the door open in case we want to reuse the syntax for embedded lockfiles</li>
<li>Leave the door open for single-file <code>lib</code>s</li>
</ul>
<h4 id="why-add-to-rust-syntax-rather-than-letting-cargo-handle-it"><a class="header" href="#why-add-to-rust-syntax-rather-than-letting-cargo-handle-it">Why add to Rust syntax, rather than letting Cargo handle it</a></h4>
<p>The most naive way for cargo to handle this is for cargo to strip the manifest, write the Rust file to a temporary file, and compile that. This is what has traditionally been done with various iterations of “cargo script”.</p>
<p>This provides a second-class experience which runs counter to one of the design goals</p>
<ul>
<li>Error messages, <code>cargo metadata</code>, etc point to the stripped source with an “odd” path, rather than the real source</li>
<li>Every tool that plans to support it would need to be updated to do stripping (<code>cargo fmt</code>, <code>cargo clippy</code>, etc)</li>
</ul>
<p>A key part in there is “plan to support”. We’d need to build up buy-in for tools to be supporting a Cargo-only syntax. This becomes more difficult when the tool in question tries to be Cargo-agnostic. By having Cargo-agnostic external tool syntax in Rust, this mostly becomes transparent.</p>
<p>We could build a special relationship with rustc to support this. For example, rustdoc passes code to rustc on stdin and sets <code>UNSTABLE_RUSTDOC_TEST_PATH</code> and <code>UNSTABLE_RUSTDOC_TEST_LINE</code> to control how errors are rendered. We could then also special case the messages inside of cargo. This both adds a major support burden to keep this house of lies standing but still falls short when it comes to tooling support. Now every tool that wants to support the Cargo-only syntax has to build their own house of lies.</p>
<h4 id="frontmatter"><a class="header" href="#frontmatter">Frontmatter</a></h4>
<p>This proposed syntax builds off of the precedence of Rust having syntax specialized for an external tool (doc-comments for rustdoc). However, a new syntax is used instead of extending the comment syntax:</p>
<ul>
<li>Simplified for being parsed by arbitrary tools (cargo, vim plugins, etc) without understanding the full Rust grammar</li>
<li>Side steps compatibility issues with both user expectations with the looseness of comment syntax (which supporting would make it harder to parse) and any existing comments that may look like a new structured comment syntax</li>
</ul>
<p>The difference between this syntax and comments is comments are generally geared towards people, even if a subset (doc-comments) are also able to be somewhat processed by a program, while this is geared mostly towards machine processing.</p>
<p>This proposal mirrors the location of YAML frontmatter (absolutely first). As we learn more of its uses and problems people run into in practice, we can evaluate if we want to loosen any of the rules.</p>
<p>Differences with YAML frontmatter include:</p>
<ul>
<li>Variable number of dashes (for escaping)</li>
<li>Optional frontmatter</li>
</ul>
<p>Besides characters, differences with commonmark code fences include:</p>
<ul>
<li>no indenting of the fenced code block</li>
<li>open/close must be a matching pair, rather than the close having “the same or more”</li>
</ul>
<p>Benefits:</p>
<ul>
<li>Visually/syntactically lightweight</li>
<li>Users can edit/copy/paste the manifest without dealing with leading characters</li>
<li>Has parallels to ideas outside of Rust, building on external knowledge that might exist</li>
<li>Easy for cargo and any third-party tool to parse and modify
<ul>
<li>As cargo will be parsing before rustc, cargo being able to work off of a reduced syntax is paramount for ensuring cargo doesn’t mask the high quality rustc errors with lower-quality errors of its own</li>
</ul>
</li>
<li>In the future, this can be leveraged by other build systems or tools</li>
</ul>
<p>Downsides:</p>
<ul>
<li>Familiar syntax in an unfamiliar use may make users feel unsettled, unsure how to proceed (what works and what doesn’t).</li>
<li>If viewed from the lens of a comment, it isn’t a variant of comment syntax like doc-comments</li>
</ul>
<h4 id="alternative-1-vary-the-openingclosing-character"><a class="header" href="#alternative-1-vary-the-openingclosing-character">Alternative 1: Vary the opening/closing character</a></h4>
<p>Instead of dashes, we could do another character, like</p>
<ul>
<li>backticks, like in commonmark code fences
<ul>
<li><code>~</code>, using a lesser known markdown code fence character</li>
</ul>
</li>
<li><code>+</code> like <a href="https://www.getzola.org/documentation/getting-started/overview/#markdown-content">zola and hugo’s TOML frontmatter</a></li>
<li><code>=</code></li>
<li>Open with <code>&gt;&gt;&gt;</code> and close with <code>&lt;&lt;&lt;</code>, like with HEREDOC (or invert it)</li>
</ul>
<p>In practice (with infostrings):</p>
<pre><code class="language-rust">#!/usr/bin/env cargo
```cargo
[package]
edition = "2018"
```

fn main() {
}</code></pre>
<pre><code class="language-rust">#!/usr/bin/env cargo
~~~cargo
[package]
edition = "2018"
~~~

fn main() {
}</code></pre>
<pre><code class="language-rust">#!/usr/bin/env cargo
+++cargo
[package]
edition = "2018"
+++

fn main() {
}</code></pre>
<pre><code class="language-rust">#!/usr/bin/env cargo
===cargo
[package]
edition = "2018"
===

fn main() {
}</code></pre>
<pre><code class="language-rust">#!/usr/bin/env cargo
&gt;&gt;&gt;cargo
[package]
edition = "2018"
&lt;&lt;&lt;

fn main() {
}</code></pre>
<pre><code class="language-rust">#!/usr/bin/env cargo
&lt;&lt;&lt;cargo
[package]
edition = "2018"
&gt;&gt;&gt;

fn main() {
}</code></pre>
<p>Downsides</p>
<ul>
<li>With <code>&gt;&gt;&gt;</code> it isn’t quite like HEREDOC to have less overhead</li>
<li><code>&gt;&gt;&gt;</code>, <code>&lt;&lt;&lt;</code>, <code>|||</code>, <code>===</code> at the beginning of lines start to look like merge conflicts which might confuse external tools</li>
<li>Backticks have a problem with users knowing how to and remembering to escape these blocks when sharing them in markdown.  Knowing the syntax (only because I’ve implemented a parser for it), I’m at about 50/50 on whether I properly escape.</li>
</ul>
<p>Note:</p>
<ul>
<li><code>"</code> was not considered because that can feel too familiar and users might carry over their expectations for how strings work</li>
</ul>
<h4 id="alternative-2-extended-shebang"><a class="header" href="#alternative-2-extended-shebang">Alternative 2: Extended Shebang</a></h4>
<pre><code class="language-rust">#!/usr/bin/env cargo
<span class="boring">```cargo
</span><span class="boring">[dependencies]
</span><span class="boring">foo = "1.2.3"
</span><span class="boring">```
</span>
fn main() {}</code></pre>
<p>This is a variation on other options that ties itself closer to the shebang syntax. The hope would be that we could get buy-in from other languages.</p>
<ul>
<li>The first line post-shebang-stripping is a hash plus 3+ backticks, then capture all content until a matching pair of backticks on a dedicated line.  This would be captured into a <code>#![frontmatter(info = "cargo", content = "..."]</code>.  <code>frontmatter</code> attribute is reserved for crate roots.  The 3+ with matching pair is a “just in case” a TOML multi-line string has that syntax in it).  Each content line must be indented to at least the same level as the first backtick.
<ul>
<li>Backticks are needed to know to avoid parsing <code>#[dependencies]</code> as an attribute</li>
<li>This also allows an infostring so this isn’t just a cargo feature</li>
</ul>
</li>
<li>Future evolution: Allow <code>cargo</code> being the default <code>info</code> string</li>
<li>Future evolution: Allow any <code>info</code> string with cargo checking for <code>content.starts_with(["cargo", "cargo,"])</code></li>
<li>Future evolution: Allow <code>frontmatter</code> attribute on any module</li>
</ul>
<p>Syntactically, this avoids confusion with attributes by being stripped before lexing. We could make this less ambiguous by using a double hash.</p>
<pre><code class="language-rust">#!/usr/bin/env cargo
# ```cargo
# [dependencies]
# foo = "1.2.3"
# ```

fn main() {}</code></pre>
<p>Benefits</p>
<ul>
<li>Visually connected to the shebang</li>
<li>Has parallels to ideas outside of Rust, building on external knowledge that might exist</li>
<li>Easy for cargo to parse and modify</li>
<li>Can easily be leveraged by buck2, meson, etc in the future</li>
<li>Maybe we can get others on board with this syntax</li>
</ul>
<p>Downsides</p>
<ul>
<li><code>#</code> prefix plus a TOML <code>[heading]</code> looks too much like a Rust <code>#[attribute]</code>.</li>
<li>More syntactically heavy than the frontmatter solution
<ul>
<li>Visually</li>
<li>More work to type it out or copy-paste between cargo scripts and regular manifests</li>
<li>More to get wrong</li>
</ul>
</li>
</ul>
<p>If we dropped future possibilities for additional content, we could remove the opening/closing syntax, greatly reducing the minimum syntax needed in some cases.</p>
<pre><code class="language-rust">#!/usr/bin/env cargo
# package.edition = "2018"

fn main() {}</code></pre>
<h4 id="alternative-3-doc-comment"><a class="header" href="#alternative-3-doc-comment">Alternative 3: Doc-comment</a></h4>
<pre><code class="language-rust">#!/usr/bin/env cargo

//! ```cargo
//! [package]
//! edition = "2018"
//! ```

fn main() {
}</code></pre>
<p>Benefits</p>
<ul>
<li>Parsers are available to make this work (e.g. <code>syn</code>, <code>pulldown-cmark</code>)</li>
<li>Familiar syntax both to read and write.
<ul>
<li>When discussing with a Rust author, it was pointed out many times people preface code with a comment specifying the dependencies (<a href="https://github.com/dtolnay/prettyplease#example">example</a>), this is the same idea but reusable by cargo</li>
<li>When discussing on forums, people expressed how they had never seen the syntax but instantly were able to understand it</li>
</ul>
</li>
<li>Depending on doc-comment style used, users may be able to edit/copy/paste the manifest without dealing with leading characters</li>
</ul>
<p>Downsides:</p>
<ul>
<li><strong>Blocker</strong> Either we expose <code>syn</code>s lesser parse errors or we skip errors, deferring to rustc’s, but then have the wrong behavior on commands that don’t invoke rustc, like <code>cargo metadata</code>
<ul>
<li>If we extend additional restrictions to make it more tool friendly, then we break from user expectations for how this syntax works</li>
</ul>
</li>
<li>When discussing with a Rust crash course teacher, it was felt their students would have a hard time learning to write these manifests from scratch
<ul>
<li>Having the explain the overloading of concepts to new users</li>
<li>Unpredictable location (both the doc comment and the cargo code block within it)</li>
<li>Visual clutter (where clutter is overwhelming already in Rust)</li>
</ul>
</li>
<li>Might be a bit complicated to do edits (translating between location within <code>toml_edit</code> spans to the location within <code>syn</code> spans especially with different comment styles)</li>
<li>Requires pulling in a full markdown parser to extract the manifest
<ul>
<li>Incorrectly formatted markdown would lead to a missing manifest and confusing error messages at best or silent incorrect behavior at worse</li>
</ul>
</li>
</ul>
<h4 id="alternative-4-attribute"><a class="header" href="#alternative-4-attribute">Alternative 4: Attribute</a></h4>
<pre><code class="language-rust">#!/usr/bin/env cargo

#![cargo(manifest = r#"
[package]
edition = "2018"
"#)]

fn main() {
}</code></pre>
<ul>
<li><code>cargo</code> could register this attribute or <code>rustc</code> could get a generic <code>metadata</code> attribute</li>
<li>As an alternative, <code>manifest</code> could a less stringly-typed format but that makes it harder for cargo to parse and edit, makes it harder for users to migrate between single and multi-file packages, and makes it harder to transfer knowledge and experience</li>
</ul>
<p>Benefits</p>
<ul>
<li>Parsers are available to make this work (e.g. <code>syn</code>)</li>
<li>Users can edit/copy/paste the manifest without dealing with leading characters</li>
</ul>
<p>Downsides</p>
<ul>
<li><strong>Blocker</strong> Either we expose <code>syn</code>s lesser parse errors or we skip errors, deferring to rustc’s, but then have the wrong behavior on commands that don’t invoke rustc, like <code>cargo metadata</code>
<ul>
<li>If we extend additional restrictions to make it more tool friendly, then we break from user expectations for how this syntax works</li>
</ul>
</li>
<li>When discussing with a Rust crash course teacher, it was felt their students would have a hard time learning to write these manifests from scratch
<ul>
<li>Unpredictable location (both the doc comment and the cargo code block within it)</li>
</ul>
</li>
<li>From talking to a teacher, users are more forgiving of not understanding the details for structure data in an unstructured format (doc comments / comments) but something that looks meaningful, they will want to understand it all requiring dealing with all of the concepts</li>
<li>The attribute approach requires explaining multiple “advanced” topics: One teacher doesn’t get to teaching any attributes until the second level in his crash course series and two teachers have found it difficult to teach people raw strings</li>
<li>Attributes look “scary” (and they are in some respects for the hidden stuff they do)</li>
</ul>
<h4 id="alternative-5-regular-comment"><a class="header" href="#alternative-5-regular-comment">Alternative 5: Regular Comment</a></h4>
<p>Simple header:</p>
<pre><code class="language-rust">#!/usr/bin/env cargo
/* Cargo.toml:
[package]
edition = "2018"
*/

fn main() {
}</code></pre>
<p>HEREDOC:</p>
<pre><code class="language-rust">#!/usr/bin/env cargo
/* Cargo.toml &gt;&gt;&gt;
[package]
edition = "2018"
&lt;&lt;&lt;
*/

fn main() {
}</code></pre>
<p>The manifest can be a regular comment with a header.  If we were to support multiple types of content (manifest, lockfile), we could either use multiple comments or HEREDOC. This does not prescribe the exact syntax used or supported comments</p>
<p>Benefits</p>
<ul>
<li>Natural to support <code>Cargo.lock</code> as well</li>
<li>Without existing baggage, can use file extensions, making a firmer association in users minds for what is in these (for those used to <code>Cargo.toml</code>)</li>
<li>Depending on the exact syntax decided on, users may be able to edit/copy/paste the manifest without dealing with leading characters</li>
</ul>
<p>Downsides</p>
<ul>
<li><strong>Blocker</strong> Assuming it can’t be parsed with <code>syn</code> and either we need to write a sufficiently compatible comment parser or pull in a much larger rust parser to extract and update comments.
<ul>
<li>If we extend additional restrictions to make it more tool friendly, then we break from user expectations for how this syntax works</li>
<li>Like with doc comments, this should map to an attribute and then we’d just start the MVP with that attribute</li>
</ul>
</li>
<li>Unfamiliar syntax</li>
<li>When discussing with a Rust crash course teacher, it was felt their students would have a hard time learning to write these manifests from scratch
<ul>
<li>Having the explain the overloading of concepts to new users</li>
<li>Unpredictable location (both the doc comment and the cargo code block within it)</li>
<li>Visual clutter (where clutter is overwhelming already in Rust)</li>
</ul>
</li>
<li>New style of structured comment for the ecosystem to support with potential compatibility issues, likely requiring a new edition</li>
</ul>
<h4 id="alternative-6-macro"><a class="header" href="#alternative-6-macro">Alternative 6: Macro</a></h4>
<pre><code class="language-rust">#!/usr/bin/env cargo

cargo! {
[package]
edition = "2018"
}

fn main() {
}</code></pre>
<p>Benefits</p>
<ul>
<li>Parsers are available to make this work (e.g. <code>syn</code>)</li>
<li>Users can edit/copy/paste the manifest without dealing with leading characters</li>
</ul>
<p>Downsides</p>
<ul>
<li><strong>Blocker</strong> Either we expose <code>syn</code>s lesser parse errors or we skip errors, deferring to rustc’s, but then have the wrong behavior on commands that don’t invoke rustc, like <code>cargo metadata</code>
<ul>
<li>If we extend additional restrictions to make it more tool friendly, then we break from user expectations for how this syntax works</li>
</ul>
</li>
<li>When discussing with a Rust crash course teacher, it was felt their students would have a hard time learning to write these manifests from scratch
<ul>
<li>Unpredictable location (both the doc comment and the cargo code block within it)</li>
</ul>
</li>
<li>The <code>cargo</code> macro would need to come from somewhere (<code>std</code>?) which means it is taking on <code>cargo</code>-specific knowledge
<ul>
<li>An unexplored direction we could go with this is a <code>meta!</code> macro (e.g. we’d need to have a format marker in it)</li>
</ul>
</li>
<li>A lot of tools/IDEs have problems in dealing with macros</li>
<li>Free-form rust code makes it harder for cargo to make edits to the manifest</li>
</ul>
<p>Bazel has an <a href="https://github.com/bazelbuild/rules_rust/pull/1142">import proc-macro</a> but its more for simplifying the writing of <code>extern crate</code>.</p>
<h4 id="alternative-7-presentation-streams"><a class="header" href="#alternative-7-presentation-streams">Alternative 7: Presentation Streams</a></h4>
<pre><code class="language-rust">#!/usr/bin/env cargo

fn main() {
}

---Cargo.toml
[package]
edition = "2018"</code></pre>
<p>YAML allows several documents to be concatenated together variant <a href="https://yaml.org/spec/1.2.2/#323-presentation-stream">presentation streams</a> which might seem familiar as this is frequently used in static-site generators for adding frontmatter to pages. What if we extended Rust’s syntax to allow something similar?</p>
<p>Benefits</p>
<ul>
<li>Flexible for other content</li>
<li>Users can edit/copy/paste the manifest without dealing with leading characters</li>
</ul>
<p>Downsides</p>
<ul>
<li><strong>Blocker</strong> Difficult to parse without assistance from something like <code>syn</code> as we’d need to distinguish what the start of a stream is vs content of a string literal</li>
<li>Being a new file format (a “text tar” format), there would be a lot of details to work out, including
<ul>
<li>How to delineate and label documents</li>
<li>How to allow escaping to avoid conflicts with content in a documents</li>
<li>Potentially an API for accessing the document from within Rust</li>
</ul>
</li>
<li>Unfamiliar, new syntax, unclear how it will work out for newer users</li>
</ul>
<h2 id="prior-art"><a class="header" href="#prior-art">Prior art</a></h2>
<p>See also <a href="https://dbohdan.com/scripts-with-dependencies">Single-file scripts that download their dependencies</a> which enumerates the syntax used by different tools.</p>
<h3 id="cargo-script-family"><a class="header" href="#cargo-script-family"><code>cargo-script</code> family</a></h3>
<p>There are several forks of <a href="https://github.com/DanielKeep/cargo-script">cargo script</a>.</p>
<p>doc-comments</p>
<pre><code class="language-rust">#!/usr/bin/env run-cargo-script
//! This is a regular crate doc comment, but it also contains a partial
//! Cargo manifest.  Note the use of a *fenced* code block, and the
//! `cargo` "language".
//!
//! ```cargo
//! [dependencies]
//! time = "0.1.25"
//! ```
extern crate time;
fn main() {
    println!("{}", time::now().rfc822z());
}</code></pre>
<p>short-hand</p>
<pre><code class="language-rust">// cargo-deps: time="0.1.25"
// You can also leave off the version number, in which case, it's assumed
// to be "*".  Also, the `cargo-deps` comment *must* be a single-line
// comment, and it *must* be the first thing in the file, after the
// hashbang.
extern crate time;
fn main() {
    println!("{}", time::now().rfc822z());
}</code></pre>
<h3 id="rustexplorer"><a class="header" href="#rustexplorer">RustExplorer</a></h3>
<p><a href="https://users.rust-lang.org/t/rust-playground-with-the-top-10k-crates/75746">Rust Explorer</a> uses a comment syntax for specifying dependencies</p>
<p>Example:</p>
<pre><code class="language-rust">/*
[dependencies]
actix-web = "*"
ureq = "*"
tokio = { version = "*", features = ["full"] }
*/

use actix_web::App;
use actix_web::get;
use actix_web::HttpResponse;
use actix_web::HttpServer;
use actix_web::post;
use actix_web::Responder;
use actix_web::web;
use tokio::spawn;
use tokio::sync::oneshot;
use tokio::task::spawn_blocking;</code></pre>
<h3 id="plrust"><a class="header" href="#plrust">PL/Rust</a></h3>
<p>Example:</p>
<pre><code class="language-sql">CREATE OR REPLACE FUNCTION randint() RETURNS bigint LANGUAGE plrust AS $$
[dependencies]
rand = "0.8"

[code]
use rand::Rng; 
Ok(Some(rand::thread_rng().gen())) 
$$;
</code></pre>
<p>See <a href="https://github.com/tcdi/plrust/blob/main/doc/src/dependencies.md">External Dependencies</a></p>
<h3 id="yaml-frontmatter"><a class="header" href="#yaml-frontmatter">YAML frontmatter</a></h3>
<p>As a specialization of <a href="https://yaml.org/spec/1.2.2/#323-presentation-stream">YAML presentation streams</a>, static site generators use frontmatter to embed YAML at the top of files. Other systems have extended this for non-YAML use, like <a href="https://www.getzola.org/documentation/content/page/#front-matter">zola using <code>+++</code> for TOML</a>.</p>
<h3 id="proposed-python-syntax"><a class="header" href="#proposed-python-syntax">Proposed Python syntax</a></h3>
<p>Currently the draft <a href="https://peps.python.org/pep-0723/">PEP 723</a> proposes allowing begin/end markers inside of regular comments:</p>
<pre><code class="language-python"># /// pyproject
# [run]
# requires-python = "&gt;=3.11"
# dependencies = [
#   "requests&lt;3",
#   "rich",
# ]
# ///

import requests
from rich.pretty import pprint

resp = requests.get("https://peps.python.org/api/peps.json")
data = resp.json()
pprint([(k, v["title"]) for k, v in data.items()][:10])
</code></pre>
<h2 id="未解決的問題"><a class="header" href="#未解決的問題">未解決的問題</a></h2>
<h2 id="future-possibilities"><a class="header" href="#future-possibilities">Future possibilities</a></h2>
<ul>
<li>Support infostring attributes
<ul>
<li>We need to better understand use cases for how this should be extended, particularly what the syntax should be (see infostring language)</li>
<li>Some tools use comma separated attributes, some use more elaborate syntax wrapped in <code>{}</code></li>
<li>A safe starting point could be to say that a space or comma separates the identifier from the attributes and everything after it is defined as part of the “language”</li>
</ul>
</li>
<li>Add support for a <code>#[frontmatter(info = "", content = "")]</code> attribute that this syntax maps to.
<ul>
<li>Since nothing will read this, whether we do it now or in the future will have no affect</li>
</ul>
</li>
</ul>
<h3 id="multiple-frontmatters"><a class="header" href="#multiple-frontmatters">Multiple frontmatters</a></h3>
<p>At least for cargo’s use cases, the only other file that we would consider supporting is <code>Cargo.lock</code> and we have other avenues we want to explore as future possibilities before we even consider the idea of multiple frontmatters.</p>
<p>So <strong>if</strong> we decide we need to embed additional metadata, we have a couple of options for extending frontmatter support.</p>
<p>Distinct blocks, maybe with newlines</p>
<pre><code class="language-md">---Cargo.toml
---

---Cargo.lock
---
</code></pre>
<p>Continuous blocks</p>
<pre><code class="language-md">---Cargo.toml
---Cargo.lock
---
</code></pre>
<p>Distinct blocks is more like the source inspiration, markdown, though has more noise, places to get things wrong, and syntax questions (newlines).</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="3502-cargo-script.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="3509-prelude-2024-future.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="3502-cargo-script.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="3509-prelude-2024-future.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
