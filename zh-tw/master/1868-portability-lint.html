<!DOCTYPE HTML>
<html lang="zh_TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>1868-portability-lint - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-c5bb60c5.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: nonportable</li>
<li>Start Date: 2016-11-15</li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/1868">rust-lang/rfcs#1868</a></li>
<li>Rust Issue: <a href="https://github.com/rust-lang/rust/issues/41619">rust-lang/rust#41619</a></li>
</ul>
<h2 id="摘要"><a class="header" href="#摘要">摘要</a></h2>
<p>There has long been a desire to expand the number of platform- and architecture-specific APIs in the standard library, and to offer subsets of the standard library for working in constrained environments. At the same time, we want to retain the property that Rust code is portable by default.</p>
<p>This RFC proposes a new <em>portability lint</em>, which threads the needle between these two desires. The lint piggybacks on the existing <code>cfg</code> system, so that using APIs involving <code>cfg</code> will generate a warning unless there is explicit acknowledgment of the portability implications.</p>
<p>The lint is intended to make the existing <code>std::os</code> module obsolete, to allow expansion (and subsetting) of the standard library, and to provide deeper checking for portability across the ecosystem.</p>
<h2 id="動機"><a class="header" href="#動機">動機</a></h2>
<h3 id="background-portability-and-the-standard-library"><a class="header" href="#background-portability-and-the-standard-library">Background: portability and the standard library</a></h3>
<p>One of the goals of the standard library is to provide an interface to hardware and system services. In doing so, there were several competing principles that we wanted to embrace:</p>
<ul>
<li>Rust should provide ergonomic and productive APIs for system services.</li>
<li>Rust should encourage portability by default.</li>
<li>Rust should provide zero-cost access to low-level system services.</li>
<li>Rust should be usable in a wide range of contexts, including resource-constrained and kernel environments.</li>
</ul>
<p>The way we balanced these principles was roughly as follows:</p>
<ul>
<li>
<p>We identified a set of “mainstream” platforms, consisting of 32- and 64-bit machines running Windows, Linux, or macOS. “Portability by default” thus more specifically means portability <em>to mainstream platforms</em>.</p>
</li>
<li>
<p>We present an ergonomic, primary API surface which is portable across these mainstream platforms (see <code>std::{fs, net, env, process, sync}</code> etc.).</p>
</li>
<li>
<p>We <em>also</em> provide separate access to low-level or OS-specific services via the <code>std::os</code> module. APIs in this module are largely traits that extend the cross-platform APIs, and in particular can expose their OS-level representation. The fact that these APIs require explicitly importing from <code>std::os</code> provided a small “speed bump” for venturing out of guaranteed mainstream platform portability.</p>
</li>
<li>
<p>Finally, for working in low-level and embedded contexts, we stabilized <code>libcore</code>, a subset of <code>libstd</code> that excludes all OS services and allocation, but <em>still</em> makes some hardware assumptions (e.g. about atomics and floating point support).</p>
</li>
</ul>
<h3 id="problems-with-the-status-quo"><a class="header" href="#problems-with-the-status-quo">Problems with the status quo</a></h3>
<p>The above strategy has served us fairly well in the first year since Rust 1.0, but it’s increasingly holding us back from enhancements we’d like to make. It’s also suboptimal in a few ways, even for the needs it covers.</p>
<p><strong>Problems with <code>std::os</code></strong>:</p>
<ul>
<li>
<p>The <code>std::os</code> module has submodules that correspond to a hierarchy of OS types. For example, there is a <code>unix</code> submodule that applies to several operating systems, but there’s also a <code>linux</code> submodule with Linux-specific extensions. There are a couple of problems with such an organization. Most importantly, it’s not at all clear how to use the module hierarchy to organize features like <a href="https://github.com/rust-lang/rfcs/pull/1543">fixed-size atomic types</a>, where the types available vary in a fine-grained way based on the CPU family; <a href="https://github.com/rust-lang/rfcs/pull/1199">SIMD</a> is even worse. But even just for operating systems, organizing into a hierarchy becomes difficult as we gain more and more APIs, some of which are only available on particular <em>versions</em> of a given operating system.</p>
</li>
<li>
<p>The “speed bump” for using <code>std::os</code> is minimal and easy to miss; it’s just an import that looks the same as any other. Moreover, it doesn’t provide any help with the ecosystem beyond <code>std</code>. There’s no simple way to tell whether a crate you’re relying on is portable to the same degree as <code>std</code> is, and the <code>os</code> submodule pattern has not really caught on in the wider ecosystem.</p>
</li>
<li>
<p>Platform-specific APIs don’t live in their “natural location”. The majority of <code>std::os</code> works through extension traits to enhance the functionality of standard primitives. For example <code>std::os::unix::io::AsRawFd</code> is a trait with the <code>as_raw_fd</code> method (to extract a file descriptor). If you were to ignore Windows, however, one might expect this API instead to live as a method directly on types like <code>File</code>, <code>TcpStream</code>, etc. Forcing code to live in <code>std::os</code> thus comes at a mild cost for both ergonomics and discoverability. This problem is even worse for features like adding more atomic types or SIMD.</p>
</li>
</ul>
<p><strong>Problems with <code>libcore</code>/the facade</strong>:</p>
<ul>
<li>
<p>Embedded libraries typically wish to never use functions in the standard library that abort on allocation failure (e.g. <code>Vec::push</code>). We’d like to provide some way for these libraries to use and interoperate with the standard collection types, but only have access to an alternative API surface (e.g. a <code>try_push</code> method provided via an extension trait). It’s not clear how to do that with the current <a href="https://github.com/rust-lang/rfcs/pull/40">facade</a> setup.</p>
</li>
<li>
<p>Kernels and embedded environments often want to <a href="https://github.com/rust-lang/rfcs/pull/1596">disable floating point</a>, but the floating point types are currently treated as primitive and shipped in <code>libcore</code>.</p>
</li>
<li>
<p>There are platforms like emscripten where much of the standard library exists for consumption, but APIs like <code>std::thread</code> are unimplementable.  Today these functions simply panic on use, but a compiler error would be better.</p>
</li>
<li>
<p>We’d like to open the door to a growing number of subsets of <code>std</code> and <code>core</code>, dropping hardware features like atomics, or perhaps even supporting 16-bit architectures. But again, it’s not clear how to fit this into the <a href="https://github.com/rust-lang/rfcs/pull/40">facade</a> model without introducing a sprawling, unwieldy collection of crates.</p>
</li>
</ul>
<h3 id="what-are-our-portability-goals"><a class="header" href="#what-are-our-portability-goals">What are our portability goals?</a></h3>
<p>Taking a step back from the specific problems with the status quo, <strong>it’s worth thinking about what it means for Rust to be “portable”, and what is realistic to achieve</strong>. We should be asking this question not just for the standard library, but for the Rust library ecosystem in general.</p>
<p>The premise of this RFC is that there are roughly three desired portability levels for a library. In order of increasing portability:</p>
<ul>
<li>
<p><strong>Platform-specific</strong>. These are libraries whose fundamental purpose depends on a given platform, for which portability doesn’t make sense. Examples include the <code>libc</code> crate, the winapi crates, and crates designed for particular embedded devices.</p>
</li>
<li>
<p><strong>Mainstream portability</strong>. Most libraries take portability as a secondary concern, and in particular don’t want to take a productivity hit just for the sake of maximizing portability. On the other hand, these libraries tend not to use obscure platform features, and it’s usually not too much of a hardship to work across common platforms.</p>
</li>
<li>
<p><strong>Maximal portability</strong>. In some cases, a library author is motivated to push for a greater degree of portability, for example allowing their code to work in the <code>no_std</code> ecosystem. Depending on the library, this may entail a significant amount of work.</p>
</li>
</ul>
<p>There’s a fundamental tradeoff here. On the one hand, we want Rust libraries to be as portable as possible. On the other hand, achieving <em>maximal</em> portability can be a big burden for library authors.  Our approach so far has been to identify “mainstream platform assumptions”, as mentioned above, and <em>guide</em> code to work on all mainstream platforms by default; by convention, such portability is the default expectation of libraries on crates.io. This RFC formalizes that approach in a deeper way.</p>
<p>An important point: while we can expect library authors who are striving for portability to test their code on a variety of target platforms, we can’t make that assumption for the average library. In other words, <strong>if we want to guide all Rust code toward at least mainstream portability, we will need to do so in a way that doesn’t require actually compiling and testing for all mainstream scenarios</strong>.</p>
<h2 id="詳細設計"><a class="header" href="#詳細設計">詳細設計</a></h2>
<h3 id="the-basic-idea"><a class="header" href="#the-basic-idea">The basic idea</a></h3>
<p>The core problem we want to solve is:</p>
<ul>
<li>
<p>We want to make non-mainstream APIs available in their natural location, e.g. as inherent methods directly on standard library types.</p>
</li>
<li>
<p>We want to have some kind of “speed bump” before using such APIs, so that users realize that they may be giving up mainstream portability.</p>
</li>
<li>
<p>We want to do this <em>without</em> requiring testing on platforms that lack the API.</p>
</li>
</ul>
<p>The core idea is that having to write <code>cfg</code> is a sufficient speedbump, as it makes explicit what platform assumptions a piece of code is making. But today, you don’t have to be <em>within</em> a <code>cfg</code> to call something labeled with <code>cfg</code>.</p>
<p>Let’s take a concrete example: the <code>as_raw_fd</code> method. We’d like to provide this API as an inherent method on things like files. But it’s not a “mainstream” API; it only works on Unix. If you tried to use it and compiled your code on Windows, you would discover the problem right away, since the API would not be available due to <code>cfg</code>. But if you were only testing on Linux, you might never notice, since the API is available there.</p>
<p><strong>The basic idea of this RFC is to provide an additional layer of checking on top of the existing <code>cfg</code> system, to avoid usage of an API <em>accidentally working</em> because you happen to be compiling for a given target platform</strong>. This checking is performed through a new <strong>portability lint</strong>, which warns when invoking APIs marked with <code>cfg</code> unless you’ve explicitly acknowledged the portability implications. We’ll see how you do that in a moment.</p>
<p>Going back to our example, we’d like to define methods on <code>File</code> like:</p>
<pre><code class="language-rust">impl File {
    #[cfg(unix)]
    fn as_raw_fd(&amp;self) -&gt; RawFd { ... }

    #[cfg(windows)]
    fn as_raw_handle(&amp;self) -&gt; RawHandle { ... }
}</code></pre>
<p>If you attempted to call <code>as_raw_fd</code>, when compiling on Unix you’d get a warning from the portability lint that you’re calling an API not available on all mainstream platforms. There are basically three ways to react (all of which will make the warning go away):</p>
<ul>
<li>
<p>Decide not to use the API, after discovering that it would reduce portability.</p>
</li>
<li>
<p>Decide to use the API, putting the function using it within a <code>cfg(unix)</code> as well (which will flag that function as Unix-specific).</p>
</li>
<li>
<p>Decide to use the API <em>in a cross-platform way</em>, e.g. by providing a Windows version of the same functionality. In that case you <code>allow</code> the lint, explicitly acknowledging that your code may involve platform-specific APIs but claiming that all platforms of the current <code>cfg</code> are handled. (See the appendix at the end for a possible extension that does more checking).</p>
</li>
</ul>
<p>In code, we’d have:</p>
<pre><code class="language-rust">////////////////////////////////////////////////////////////////////////////////
// The code we might have written initially:
////////////////////////////////////////////////////////////////////////////////

fn unlabeled() {
    // Would generate a warning: calling a `unix`-only API while only
    // assuming a mainstream platform
    let fd = File::open("foo.txt").unwrap().as_raw_fd();
}

////////////////////////////////////////////////////////////////////////////////
// Code that opts into platform-specificness:
////////////////////////////////////////////////////////////////////////////////

#[cfg(unix)]
fn foo() {
    // No warning: we're within code that assumes `unix`
    let fd = File::open("foo.txt").unwrap().as_raw_fd();
}

#[cfg(windows)]
fn foo() {
    // No warning: we're within code that assumes `windows`
    let handle = File::open("foo.txt").unwrap().as_raw_handle();
}

#[cfg(linux)]
fn linux_only() {
    // No warning: we're within code that assumes `linux`, which implies `unix`
    let fd = File::open("foo.txt").unwrap().as_raw_fd();
}

////////////////////////////////////////////////////////////////////////////////
// Code that provides a cross-platform abstraction
////////////////////////////////////////////////////////////////////////////////

// No `cfg` label here; it's a cross-platform function, which we claim
// via the `allow`
#[allow(nonportable)]
fn cross_platform() {
    // invoke an item with a more restrictive `cfg`
    foo()
}</code></pre>
<p>As with many lints, the portability lint is <em>best effort</em>: it is not required to provide airtight guarantees about portability. However, the RFC sketches a plausible implementation route that should cover the vast majority of cases.</p>
<p>Note that this lint will only check code that is actually compiled on the current platform, so the following code would not produce a warning when compiled on <code>unix</code>:</p>
<pre><code class="language-rust">pub fn mycrate_function() {
    // ...
}

#[cfg(windows)]
pub fn windows_specific_mycrate_function() {
    // this call should warn since it makes an additional assumption
    windows_more_specific_mycrate_function();
}

#[cfg(all(windows, target_pointer_width = "64"))]
pub fn windows_more_specific_mycrate_function() {
    // ...
}</code></pre>
<p>However, any such “missed portability issues” are only possible when already using <code>cfg</code>, which means a “speedbump” has already been passed.</p>
<p>With that overview in mind, let’s dig into the details.</p>
<h3 id="the-lint-definition"><a class="header" href="#the-lint-definition">The lint definition</a></h3>
<p>The lint is structured somewhat akin to a type and effect system: roughly speaking, items that are labeled with a given <code>cfg</code> assumption can only be used within code making that same <code>cfg</code> assumption.</p>
<p>More precisely, each item has a <em>portability</em>, consisting of all the lexically-nested uses of <code>cfg</code>. If there are multiple uses of <code>cfg</code>, the portability is taken to be their <em>conjunction</em>:</p>
<pre><code class="language-rust">#[cfg(unix)]
mod foo {
    #[cfg(target_pointer_width = "32")]
    fn bar() {
        // the portability of `bar` is `all(unix, target_pointer_width = "32")`
    }
}</code></pre>
<p>The portability only considers built-in <code>cfg</code> attributes (like <code>target_os</code>), <em>not</em> Cargo features (which are treated as automatically true for the lint purposes).</p>
<p>The lint is then straightforward to define at a high level: it walks over item definitions and checks that the item’s portability is <em>narrower</em> than the portability of items it references or invokes. For example, <code>bar</code> in the above could invoke an item with portability <code>unix</code> and/or <code>target_pointer_width = "32"</code>, but not one with portability <code>linux</code>.</p>
<p>To fully define the lint, though, we need to give more details about what “narrower” means, and how referenced item portability is determined.</p>
<h4 id="comparing-portabilities"><a class="header" href="#comparing-portabilities">Comparing portabilities</a></h4>
<p><strong>What does it mean for a portability to be narrower?</strong> In general, portability is a logical expression, using the operators <code>all</code>, <code>any</code>, <code>not</code> on top of primitive expressions like <code>unix</code>. Portability <code>P</code> is narrower than portability <code>Q</code> if <code>P</code> <em>implies</em> <code>Q</code> as a logic formula.</p>
<p>In general, comparing two portabilities is equivalent to solving SAT, an NP-complete problem – a frightening prospect for a lint! However, note that worst-case execution is exponential in <em>the number of variables</em> (i.e., primitive <code>cfg</code> constraints), not the number/complexity of clauses, and most comparisons should involve a very small number of variables. We can likely get away with a naive SAT implementation, perhaps with a handful of optimiziations specific to our use-case. In the limit, there are also many well-known techniques for solving SAT efficiently even on very large examples that arise in real-world usage.</p>
<h5 id="axioms"><a class="header" href="#axioms">Axioms</a></h5>
<p>Another aspect of portability comparison is the relationship between things like <code>unix</code> and <code>linux</code>. In logical terms, we want to assume that <code>linux</code> implies <code>unix</code>, for example.</p>
<p>The primitive portabilities we’ll be comparing are all <em>built in</em> (since we are not including Cargo features). The solver can thus build in a number of assumptions about these portabilities. The end result is that code like the following should pass the lint:</p>
<pre><code class="language-rust">#[cfg(unix)]
fn unix_only() { .. }

#[cfg(linux)]
fn linux_only() {
    // permitted since `linux` implies `unix`
    unix_only()
}</code></pre>
<p>Of course, primitive portabilities in practice are key-value pairs (like <code>target_os = "unix"</code>). This RFC proposes to treat <em>all</em> keys as multimaps, that is, to not introduce assumptions like <code>nand(target_os = "unix", target_os = "windows")</code> for simplicity’s sake; uses of <code>cfg</code> in practice will not produce such nonsensical situations. However, the precise details of how these implications are specified—and what implications are desired—are left as implementation details that need to be worked out with real-world experience.</p>
<h4 id="determining-the-portability-of-referenced-items"><a class="header" href="#determining-the-portability-of-referenced-items">Determining the portability of referenced items</a></h4>
<p><strong>How is the portability of a referenced item determined?</strong> The lint will resolve an item to its definition, and use the portability of that definition, which will be recorded in metadata. For the case of trait items, however, this will involve attempting to resolve the invocation to a particular impl, to look up the portability of that impl. We can set up trait selection to yield portability information with the selected impl, which will allow us to catch cases like the following:</p>
<pre><code class="language-rust">trait Foo {
    fn foo();
}

struct MyType;

#[cfg(unix)]
impl Foo for MyType {
    fn foo() { .. }
}

fn use_foo&lt;T: Foo&gt;() {
    T::foo()
}

fn invoke() {
    // invokes a `cfg(unix)` item via a generic function, but we can catch it
    // when checking that `MyType: Foo`, since selection will say that we need
    // our context to imply `unix`
    use_foo::&lt;MyType&gt;();
}</code></pre>
<h3 id="the-story-for-std"><a class="header" href="#the-story-for-std">The story for <code>std</code></a></h3>
<p>With these basic mechanisms in hand, let’s sketch out how we might apply them to the standard library to achieve our initial goals. This part of the RFC should not be considered normative; it’s left to the implementation to make the final determination about how to set up the standard library.</p>
<h4 id="the-mainstream-platform"><a class="header" href="#the-mainstream-platform">The mainstream platform</a></h4>
<p>The “mainstream platform” will be expressed via a new primitive <code>cfg</code> pattern called <code>std</code>. This is the <strong>default portability of all crates</strong>, unless opted-out (see below on “subsetting <code>std</code>”). Likewise, most items in <code>std</code> will <em>initially</em> be exported at <code>std</code> portability level (but see subsets below). These two facts together mean that existing uses of <code>std</code> will continue to work without issuing any warnings.</p>
<h4 id="expanding-std"><a class="header" href="#expanding-std">Expanding <code>std</code></a></h4>
<p>With the above setup, handling extensions to <code>std</code> with APIs like <code>as_raw_fd</code> is straightforward. In particular, we can write:</p>
<pre><code class="language-rust">impl File {
    #[cfg(unix)]
    fn as_raw_fd(&amp;self) -&gt; RawFd { ... }

    #[cfg(windows)]
    fn as_raw_handle(&amp;self) -&gt; RawHandle { ... }
}</code></pre>
<p>and the portability of <code>as_raw_fd</code> will be <code>all(std, unix)</code>. Thus, any code using <code>as_raw_fd</code> will need to be in a <code>unix</code> context in particular.</p>
<p>We can thus deprecate the <code>std::os</code> module in favor of these in-place APIs. Doing so leverages the fact that we’re using a portability <em>lint</em>: these new inherent methods will shadow the existing ones in <code>std::os</code>, and may generate new warnings, but this is considered an acceptable change. After all, lints on dependencies are automatically capped, and the lint will not prevent code from compiling–and can be silenced.</p>
<p>For hardware features like additional atomics or SIMD, we can use the <code>target_feature</code> cfg key to label the APIs – which has to be done anyway, but will also do the right thing for the lint.</p>
<p>In short, for expansions there’s basically nothing to do. You just add the API in its natural location, with its natural <code>cfg</code>, and everything works out.</p>
<h4 id="subsetting-std"><a class="header" href="#subsetting-std">Subsetting <code>std</code></a></h4>
<p>What about subsets of <code>std</code>?</p>
<p><strong>What use case do we want to address?</strong> Going back to the Portability Goals discussed earlier, the goal of subsetting <code>std</code> is mostly about helping people who want <em>maximum portability</em>. For this use case, you should opt out of the mainstream platform, and then <em>whitelist</em> the various features you need, thus giving you assistance in using the minimal set of assumptions needed.</p>
<p><strong>Opting out of the mainstream platform</strong>. To opt out of the <code>std</code> platform, you can just apply a <code>cfg</code> to your <em>crate</em> definition. The assumptions of that <code>cfg</code> will form the baseline for the crate.</p>
<p><strong>Carving up <code>std</code> into whitelistable features</strong>. When we want to provide subsets of <code>std</code>, we can introduce a new set of target features, along the following lines:</p>
<ul>
<li>each integer size</li>
<li>each float size</li>
<li>each atomics size</li>
<li>allocation</li>
<li>OS facilities
<ul>
<li>env</li>
<li>fs</li>
<li>net</li>
<li>process</li>
<li>thread</li>
<li>rng</li>
</ul>
</li>
</ul>
<p><strong>To introduce these features, we would change APIs in <code>std</code> from being marked as <code>#[cfg(std)]</code> to instead being labeled with the particular feature</strong>, e.g.:</p>
<pre><code class="language-rust">// previously: #[cfg(std)]
#[cfg(target_feature = "thread")]
mod thread;

// previously: #[cfg(std)]
#[cfg(target_feature = "fs")]
mod fs;</code></pre>
<p>and so on. We can then set up axioms such that <code>std</code> <em>implies</em> all of these features. That way existing code written at the default portability level will not produce warnings when using the standard library. And in general, we can carve out increasingly fine-grained subsets, setting up implications between the previous coarse-grained features and the new subsets.</p>
<p>On the other side, library authors shooting for maximal portability should opt out of <code>cfg(std)</code>, and use <code>cfg</code> as little as possible, adding features to their whitelist only after deciding they’re truly needed, or abstracting over them (such as using threading for parallelism only when it was available).</p>
<h3 id="proposed-rollout"><a class="header" href="#proposed-rollout">Proposed rollout</a></h3>
<p>The most pressing problem in <code>std</code> is the desire for expansion, rather than subsetting, so we should start there. The <code>cfg</code> needed for expansion is totally straightforward, and will allow us to gain experience with the lint.</p>
<p>Later, we can start exploring subsets of <code>std</code>, which will likely require some more thoughtful design to find the right granularity.</p>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<p>There are several potential drawbacks to the approach of this RFC:</p>
<ul>
<li>It adds a significant level of pedanticness about portability to Rust.</li>
<li>It does not provide airtight guarantees.</li>
<li>It may create compiler performance issues, due to the use of SAT solving.</li>
</ul>
<p>The fact that it’s a lint offers some help with the first two points; the use of <code>std</code> as a default portability level should also help quite a bit with pedanticness.</p>
<p>The worry about SAT solving is harder to mitigate; there’s not much concrete evidence in either direction. But it is yet another place where the fact that it’s a lint could help: we may be able to simply skip checking pathological cases, if they indeed arise in practice. In any case, it’s hard to know how concerned to be until we try it.</p>
<p>While the fact that it’s a lint gives us more leeway to experiment, it’s also a lint that could produce widespread warnings throughout the ecosystem, so we need to exercise care.</p>
<h2 id="替代方案"><a class="header" href="#替代方案">替代方案</a></h2>
<p>The main alternatives are:</p>
<ul>
<li>
<p><strong>Give up on encouraging “portability by default”</strong>, and instead just land APIs in their natural location using today’s <code>cfg</code> system. This is certainly the less costly way to go. It’s also <em>forward-compatible</em> with implementing the proposed lint, so we should discuss the possibility of landing APIs under <code>cfg</code> even before the lint is implemented.</p>
</li>
<li>
<p><strong>Use a less precise checking strategy.</strong> In particular, rather than trying to compare portabilities in a detailed, item-level way, we might just require some crate-level “opt in”. That could either take the form of acknowledging “this code makes assumptions beyond the mainstream platform”, or might list the specific <code>cfg</code> assumptions the code is allowed to make. Of course, the downside is that you get much less help making sure that your APIs are properly labeled in place.</p>
</li>
</ul>
<h2 id="how-we-teach-this"><a class="header" href="#how-we-teach-this">How we teach this</a></h2>
<p>For people simply using libraries, this feature “teaches itself” by generating warnings. Those warnings should make clear what to do to fix the problem, and ideally provide extended error information that describes the system in more detail.</p>
<p>For library authors, the documentation for <code>cfg</code> and <code>match_cfg</code> would explain the implications for the lint, and walk through several examples illustrating the scenarios that arise in practice.</p>
<h2 id="未解決的問題"><a class="header" href="#未解決的問題">未解決的問題</a></h2>
<h3 id="extensions-to-cfg-itself"><a class="header" href="#extensions-to-cfg-itself">Extensions to <code>cfg</code> itself</a></h3>
<p>If we allow <code>cfg</code> to go beyond simple key-value pairs, for example to talk about ranges, we will need to accommodate that somehow in the lint. One plausible approach would be to use something more like SMT solving, which incorporates reasoning about things like ordering constraints in addition to basic SAT questions.</p>
<h3 id="external-libraries"><a class="header" href="#external-libraries">External libraries</a></h3>
<p>It’s not clear what the story should be for a library like <code>libc</code>, which currently involves intricate uses of <code>cfg</code>. We should have some idea for how to approach such cases before landing the RFC.</p>
<h3 id="the-standard-library"><a class="header" href="#the-standard-library">The standard library</a></h3>
<p>To what extent does this proposal obviate the need for the <code>std</code> facade? Might it be possible to deprecate <code>libcore</code> in favor of the “subsetting <code>std</code>” approach?</p>
<h3 id="cargo-features"><a class="header" href="#cargo-features">Cargo features</a></h3>
<p>It’s unclear whether, or how, to extend this approach to deal with Cargo features. In particular, features are namespaced per crate, so there’s no way to use the <code>cfg</code> system today to talk about upstream features.</p>
<h2 id="appendix-possible-extensions"><a class="header" href="#appendix-possible-extensions">Appendix: possible extensions</a></h2>
<h3 id="match_cfg"><a class="header" href="#match_cfg"><code>match_cfg</code></a></h3>
<p>The original version of this RFC was more expansive, and proposed a <code>match_cfg</code> macro that provided some additional checking.</p>
<p>The <code>match_cfg</code> macro takes a sequence of <code>cfg</code> patterns, followed by <code>=&gt;</code> and an expression. Its syntax and semantics resembles that of <code>match</code>. However, there are some special considerations when checking portability:</p>
<ul>
<li>
<p>When descending into an arm of a <code>match_cfg</code>, the arm is checked against portability that includes the pattern for the arm.</p>
</li>
<li>
<p>The portability for the <code>match_cfg</code> itself is understood as <code>any(p1, ..., p_n)</code> where the <code>match_cfg</code> patterns are <code>p1</code> through <code>p_n</code>.</p>
</li>
</ul>
<p>Thus, for example, the following code will pass the lint:</p>
<pre><code class="language-rust">#[cfg(windows)]
fn windows_only() { .. }

#[cfg(unix)]
fn unix_only() { .. }

#[cfg(any(windows, unix))]
fn portable() {
    // the expression here has portability `any(windows, unix)`
    match_cfg! {
        windows =&gt; {
            // allowed because we are within a scope with
            // portability `all(any(windows, unix), windows)`
            windows_only()
        }
        unix =&gt; {
            // allowed because we are within a scope with
            // portability `all(any(windows, unix), unix)`
            unix_only()
        }
    }
}</code></pre>
<p>If you have a <code>match_case</code> that covers <em>all</em> cases (like <code>windows</code> and <code>not(windows)</code>), then it imposes <em>no</em> portability constraints on its context.</p>
<p>On more reflection, though, this extension doesn’t seem so worthwhile: while it provides some additional checking, the fact remains that only the currently-enabled <code>cfg</code> is fully checked, so the additional guarantee you get is somewhat mixed. It’s also a rare (maybe non-existent) error to explicitly write code that’s broken down by platforms, but forget one of the platforms you wish to cover.</p>
<p>We can, however, add <code>match_cfg</code> as a backwards-compatible extension at any time.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="1866-more-readable-assert-eq.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="1869-eprintln.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="1866-more-readable-assert-eq.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="1869-eprintln.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
