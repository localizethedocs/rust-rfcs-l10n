<!DOCTYPE HTML>
<html lang="zh_TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>0544-rename-int-uint - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-c5bb60c5.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Start Date: 2014-12-28</li>
<li>RFC PR #: <a href="https://github.com/rust-lang/rfcs/pull/544">rust-lang/rfcs#544</a></li>
<li>Rust Issue #: <a href="https://github.com/rust-lang/rust/issues/20639">rust-lang/rust#20639</a></li>
</ul>
<h2 id="摘要"><a class="header" href="#摘要">摘要</a></h2>
<p>This RFC proposes that we rename the pointer-sized integer types <code>int/uint</code>, so as to avoid misconceptions and misuses. After extensive community discussions and several revisions of this RFC, the finally chosen names are <code>isize/usize</code>.</p>
<h2 id="動機"><a class="header" href="#動機">動機</a></h2>
<p>Currently, Rust defines two <a href="http://doc.rust-lang.org/reference.html#machine-dependent-integer-types">machine-dependent integer types</a> <code>int/uint</code> that have the same number of bits as the target platform’s pointer type. These two types are used for many purposes: indices, counts, sizes, offsets, etc.</p>
<p>The problem is, <code>int/uint</code> <em>look</em> like default integer types, but pointer-sized integers are not good defaults, and it is desirable to discourage people from overusing them.</p>
<p>And it is a quite popular opinion that, the best way to discourage their use is to rename them.</p>
<p>Previously, the latest renaming attempt <a href="https://github.com/rust-lang/rfcs/pull/464">RFC PR 464</a> was rejected. (Some parts of this RFC is based on that RFC.) <a href="http://discuss.rust-lang.org/t/a-tale-of-twos-complement/1062">A tale of two’s complement</a> states the following reasons:</p>
<ul>
<li>Changing the names would affect literally every Rust program ever written.</li>
<li>Adjusting the guidelines and tutorial can be equally effective in helping people to select the correct type.</li>
<li>All the suggested alternative names have serious drawbacks.</li>
</ul>
<p>However:</p>
<p>Rust was and is undergoing quite a lot of breaking changes. Even though the <code>int/uint</code> renaming will “break the world”, it is not unheard of, and it is mainly a “search &amp; replace”. Also, a transition period can be provided, during which <code>int/uint</code> can be deprecated, while the new names can take time to replace them. So “to avoid breaking the world” shouldn’t stop the renaming.</p>
<p><code>int/uint</code> have a long tradition of being the default integer type names, so programmers <em>will</em> be tempted to use them in Rust, even the experienced ones, no matter what the documentation says. The semantics of <code>int/uint</code> in Rust is quite different from that in many other mainstream languages. Worse, the Swift programming language, which is heavily influenced by Rust, has the types <code>Int/UInt</code> with <em>almost</em> the <em>same semantics</em> as Rust’s <code>int/uint</code>, but it <em>actively encourages</em> programmers to use <code>Int</code> as much as possible. From <a href="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html#//apple_ref/doc/uid/TP40014097-CH5-ID319">the Swift Programming Language</a>:</p>
<blockquote>
<p>Swift provides an additional integer type, Int, which has the same size as the current platform’s native word size: …</p>
</blockquote>
<blockquote>
<p>Swift also provides an unsigned integer type, UInt, which has the same size as the current platform’s native word size: …</p>
</blockquote>
<blockquote>
<p>Unless you need to work with a specific size of integer, always use Int for integer values in your code. This aids code consistency and interoperability.</p>
</blockquote>
<blockquote>
<p>Use UInt only when you specifically need an unsigned integer type with the same size as the platform’s native word size. If this is not the case, Int is preferred, even when the values to be stored are known to be non-negative.</p>
</blockquote>
<p>Thus, it is very likely that newcomers will come to Rust, expecting <code>int/uint</code> to be the preferred integer types, <em>even if they know that they are pointer-sized</em>.</p>
<p>Not renaming <code>int/uint</code> violates the principle of least surprise, and is not newcomer friendly.</p>
<p>Before the rejection of <a href="https://github.com/rust-lang/rfcs/pull/464">RFC PR 464</a>, the community largely settled on two pairs of candidates: <code>imem/umem</code> and <code>iptr/uptr</code>. As stated in previous discussions, the names have some drawbacks that may be unbearable. (Please refer to <a href="http://discuss.rust-lang.org/t/a-tale-of-twos-complement/1062">A tale of two’s complement</a> and related discussions for details.)</p>
<p>This RFC originally proposed a new pair of alternatives <code>intx/uintx</code>.</p>
<p>However, given the discussions about the previous revisions of this RFC, and the discussions in <a href="http://discuss.rust-lang.org/t/restarting-the-int-uint-discussion/1131">Restarting the <code>int/uint</code> Discussion</a>, this RFC author (@CloudiDust) now believes that <code>intx/uintx</code> are not ideal. Instead, one of the other pairs of alternatives should be chosen. The finally chosen names are <code>isize/usize</code>.</p>
<h2 id="詳細設計"><a class="header" href="#詳細設計">詳細設計</a></h2>
<ul>
<li>Rename <code>int/uint</code> to <code>isize/usize</code>, with them being their own literal suffixes.</li>
<li>Update code and documentation to use pointer-sized integers more narrowly for their intended purposes. Provide a deprecation period to carry out these updates.</li>
</ul>
<p><code>usize</code> in action:</p>
<pre><code class="language-rust">fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;usize, to: &amp;usize) -&gt; &amp;'b [T]</code></pre>
<p>There are different opinions about which literal suffixes to use. The following section would discuss the alternatives.</p>
<h3 id="choosing-literal-suffixes"><a class="header" href="#choosing-literal-suffixes">Choosing literal suffixes:</a></h3>
<h4 id="isizeusize"><a class="header" href="#isizeusize"><code>isize/usize</code>:</a></h4>
<ul>
<li>Pros: They are the same as the type names, very consistent with the rest of the integer primitives.</li>
<li>Cons: They are too long for some, and may stand out too much as suffixes. However, discouraging people from overusing <code>isize/usize</code> is the point of this RFC. And if they are not overused, then this will not be a problem in practice.</li>
</ul>
<h4 id="isus"><a class="header" href="#isus"><code>is/us</code>:</a></h4>
<ul>
<li>Pros: They are succinct as suffixes.</li>
<li>Cons: They are actual English words, with <code>is</code> being a keyword in many programming languages and <code>us</code> being an abbreviation of “unsigned” (losing information) or “microsecond” (misleading). Also, <code>is/us</code> may be <em>too</em> short (shorter than <code>i64/u64</code>) and <em>too</em> pleasant to use, which can be a problem.</li>
</ul>
<p>Note: No matter which suffixes get chosen, it can be beneficial to reserve <code>is</code> as a keyword, but this is outside the scope of this RFC.</p>
<h4 id="izuz"><a class="header" href="#izuz"><code>iz/uz</code>:</a></h4>
<ul>
<li>Pros and cons: Similar to those of <code>is/us</code>, except that <code>iz/uz</code> are not actual words, which is an additional advantage. However it may not be immediately clear that <code>iz/uz</code> are abbreviations of <code>isize/usize</code>.</li>
</ul>
<h4 id="iu"><a class="header" href="#iu"><code>i/u</code>:</a></h4>
<ul>
<li>Pros: They are very succinct.</li>
<li>Cons: They are <em>too</em> succinct and carry the “default integer types” connotation, which is undesirable.</li>
</ul>
<h4 id="iszusz"><a class="header" href="#iszusz"><code>isz/usz</code>:</a></h4>
<ul>
<li>Pros: They are the middle grounds between <code>isize/usize</code> and <code>is/us</code>, neither too long nor too short. They are not actual English words and it’s clear that they are short for <code>isize/usize</code>.</li>
<li>Cons: Not everyone likes the appearances of <code>isz/usz</code>, but this can be said about all the candidates.</li>
</ul>
<p>After community discussions, it is deemed that using <code>isize/usize</code> directly as suffixes is a fine choice and there is no need to introduce other suffixes.</p>
<h3 id="advantages-of-isizeusize"><a class="header" href="#advantages-of-isizeusize">Advantages of <code>isize/usize</code>:</a></h3>
<ul>
<li>The names indicate their common use cases (container sizes/indices/offsets), so people will know where to use them, instead of overusing them everywhere.</li>
<li>The names follow the <code>i/u + {suffix}</code> pattern that is used by all the other primitive integer types like <code>i32/u32</code>.</li>
<li>The names are newcomer friendly and have familiarity advantage over almost all other alternatives.</li>
<li>The names are easy on the eyes.</li>
</ul>
<p>See <strong>Alternatives B to L</strong> for the alternatives to <code>isize/usize</code> that have been rejected.</p>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<h3 id="drawbacks-of-the-renaming-in-general"><a class="header" href="#drawbacks-of-the-renaming-in-general">Drawbacks of the renaming in general:</a></h3>
<ul>
<li>Renaming <code>int</code>/<code>uint</code> requires changing much existing code. On the other hand, this is an ideal opportunity to fix integer portability bugs.</li>
</ul>
<h3 id="drawbacks-of-isizeusize"><a class="header" href="#drawbacks-of-isizeusize">Drawbacks of <code>isize/usize</code>:</a></h3>
<ul>
<li>The names fail to indicate the precise semantics of the types - <em>pointer-sized integers</em>. (And they don’t follow the <code>i32/u32</code> pattern as faithfully as possible, as <code>32</code> indicates the exact size of the types, but <code>size</code> in <code>isize/usize</code> is vague in this aspect.)</li>
<li>The names favour some of the types’ use cases over the others.</li>
<li>The names remind people of C’s <code>ssize_t/size_t</code>, but <code>isize/usize</code> don’t share the exact same semantics with the C types.</li>
</ul>
<p>Familiarity is a double edged sword here. <code>isize/usize</code> are chosen not because they are perfect, but because they represent a good compromise between semantic accuracy, familiarity and code readability. Given good documentation, the drawbacks listed here may not matter much in practice, and the combined familiarity and readability advantage outweighs them all.</p>
<h2 id="替代方案"><a class="header" href="#替代方案">替代方案</a></h2>
<h3 id="a-keep-the-status-quo"><a class="header" href="#a-keep-the-status-quo">A. Keep the status quo:</a></h3>
<p>Which may hurt in the long run, especially when there is at least one (would-be?) high-profile language (which is Rust-inspired) taking the opposite stance of Rust.</p>
<p>The following alternatives make different trade-offs, and choosing one would be quite a subjective matter. But they are all better than the status quo.</p>
<h3 id="b-iptruptr"><a class="header" href="#b-iptruptr">B. <code>iptr/uptr</code>:</a></h3>
<ul>
<li>Pros: “Pointer-sized integer”, exactly what they are.</li>
<li>Cons: C/C++ have <code>intptr_t/uintptr_t</code>, which are typically <em>only</em> used for storing casted pointer values. We don’t want people to confuse the Rust types with the C/C++ ones, as the Rust ones have more typical use cases. Also, people may wonder why all data structures have “pointers” in their method signatures. Besides the “funny-looking” aspect, the names may have an incorrect “pointer fiddling and unsafe staff” connotation there, as <code>ptr</code> isn’t usually seen in safe Rust code.</li>
</ul>
<p>In the following snippet:</p>
<pre><code class="language-rust">fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;uptr, to: &amp;uptr) -&gt; &amp;'b [T]</code></pre>
<p>It feels like working with pointers, not integers.</p>
<h3 id="c-imemumem"><a class="header" href="#c-imemumem">C. <code>imem/umem</code>:</a></h3>
<p>When originally proposed, <code>mem</code>/<code>m</code> are interpreted as “memory numbers” (See @1fish2’s comment in <a href="https://github.com/rust-lang/rfcs/pull/464">RFC PR 464</a>):</p>
<blockquote>
<p><code>imem</code>/<code>umem</code> are “memory numbers.” They’re good for indexes, counts, offsets, sizes, etc. As memory numbers, it makes sense that they’re sized by the address space.</p>
</blockquote>
<p>However this interpretation seems vague and not quite convincing, especially when all other integer types in Rust are named precisely in the “<code>i</code>/<code>u</code> + <code>{size}</code>” pattern, with no “indirection” involved. What is “memory-sized” anyway? But actually, they can be interpreted as <strong>_mem_ory-pointer-sized</strong>, and be a <em>precise</em> size specifier just like <code>ptr</code>.</p>
<ul>
<li>Pros: Types with similar names do not exist in mainstream languages, so people will not make incorrect assumptions.</li>
<li>Cons: <code>mem</code> -&gt; <em>memory-pointer-sized</em> is definitely not as obvious as <code>ptr</code> -&gt; <em>pointer-sized</em>. The unfamiliarity may turn newcomers away from Rust.</li>
</ul>
<p>Also, for some, <code>imem/umem</code> just don’t feel like integers no matter how they are interpreted, especially under certain circumstances. In the following snippet:</p>
<pre><code class="language-rust">fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;umem, to: &amp;umem) -&gt; &amp;'b [T]</code></pre>
<p><code>umem</code> still feels like a pointer-like construct here (from “some memory” to “some other memory”), even though it doesn’t have <code>ptr</code> in its name.</p>
<h3 id="d-intpuintp-and-intmuintm"><a class="header" href="#d-intpuintp-and-intmuintm">D. <code>intp/uintp</code> and <code>intm/uintm</code>:</a></h3>
<p>Variants of Alternatives B and C. Instead of stressing the <code>ptr</code> or <code>mem</code> part, they stress the <code>int</code> or <code>uint</code> part.</p>
<p>They are more integer-like than <code>iptr/uptr</code> or <code>imem/umem</code> if one knows where to split the words.</p>
<p>The problem here is that they don’t strictly follow the <code>i/u + {size}</code> pattern, are of different lengths, and the more frequently used type <code>uintp</code>(<code>uintm</code>) has a longer name. Granted, this problem already exists with <code>int/uint</code>, but those two are names that everyone is familiar with.</p>
<p>So they may not be as pretty as <code>iptr/uptr</code> or <code>imem/umem</code>.</p>
<pre><code class="language-rust">fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;uintm, to: &amp;uintm) -&gt; &amp;'b [T]
fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;uintp, to: &amp;uintp) -&gt; &amp;'b [T]</code></pre>
<h3 id="e-intxuintx"><a class="header" href="#e-intxuintx">E. <code>intx/uintx</code>:</a></h3>
<p>The original proposed names of this RFC, where <code>x</code> means “unknown/variable/platform-dependent”.</p>
<p>They share the same problems with <code>intp/uintp</code> and <code>intm/uintm</code>, while <em>in addition</em> failing to be specific enough. There are other kinds of platform-dependent integer types after all (like register-sized ones), so which ones are <code>intx/uintx</code>?</p>
<h3 id="f-idiffusize"><a class="header" href="#f-idiffusize">F. <code>idiff/usize</code>:</a></h3>
<p>There is a problem with <code>isize</code>: it most likely will remind people of C/C++ <code>ssize_t</code>. But <code>ssize_t</code> is in the POSIX standard, not the C/C++ ones, and is <em>not for index offsets</em> according to POSIX. The correct type for index offsets in C99 is <code>ptrdiff_t</code>, so for a type representing offsets, <code>idiff</code> may be a better name.</p>
<p>However, <code>isize/usize</code> have the advantage of being symmetrical, and ultimately, even with a name like <code>idiff</code>, some semantic mismatch between <code>idiff</code> and <code>ptrdiff_t</code> would still exist. Also, for fitting a casted pointer value, a type named <code>isize</code> is better than one named <code>idiff</code>. (Though both would lose to <code>iptr</code>.)</p>
<h3 id="g-iptruptr-and-idiffusize"><a class="header" href="#g-iptruptr-and-idiffusize">G. <code>iptr/uptr</code> <em>and</em> <code>idiff/usize</code>:</a></h3>
<p>Rename <code>int/uint</code> to <code>iptr/uptr</code>, with <code>idiff/usize</code> being aliases and used in container method signatures.</p>
<p>This is for addressing the “not enough use cases covered” problem. Best of both worlds at the first glance.</p>
<p><code>iptr/uptr</code> will be used for storing casted pointer values, while <code>idiff/usize</code> will be used for offsets and sizes/indices, respectively.</p>
<p><code>iptr/uptr</code> and <code>idiff/usize</code> may even be treated as different types to prevent people from accidentally mixing their usage.</p>
<p>This will bring the Rust type names quite in line with the standard C99 type names, which may be a plus from the familiarity point of view.</p>
<p>However, this setup brings two sets of types that share the same underlying representations. C distinguishes between <code>size_t</code>/<code>uintptr_t</code>/<code>intptr_t</code>/<code>ptrdiff_t</code> not only because they are used under different circumstances, but also because the four may have representations that are potentially different from <em>each other</em> on some architectures. Rust assumes a flat memory address space and its <code>int/uint</code> types don’t exactly share semantics with any of the C types if the C standard is strictly followed.</p>
<p>Thus, even introducing four names would not fix the “failing to express the precise semantics of the types” problem. Rust just doesn’t need to, and <em>shouldn’t</em> distinguish between <code>iptr/idiff</code> and <code>uptr/usize</code>, doing so would bring much confusion for very questionable gain.</p>
<h3 id="h-isizusiz"><a class="header" href="#h-isizusiz">H. <code>isiz/usiz</code>:</a></h3>
<p>A pair of variants of <code>isize/usize</code>. This author believes that the missing <code>e</code> may be enough to warn people that these are not <code>ssize_t/size_t</code> with “Rustfied” names. But at the same time, <code>isiz/usiz</code> mostly retain the familiarity of <code>isize/usize</code>.</p>
<p>However, <code>isiz/usiz</code> still hide the actual semantics of the types, and omitting but a single letter from a word does feel too hack-ish.</p>
<pre><code class="language-rust">fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;usiz, to: &amp;usiz) -&gt; &amp;'b [T]</code></pre>
<h3 id="i-iptr_sizeuptr_size"><a class="header" href="#i-iptr_sizeuptr_size">I. <code>iptr_size/uptr_size</code>:</a></h3>
<p>The names are very clear about the semantics, but are also irregular, too long and feel out of place.</p>
<pre><code class="language-rust">fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;uptr_size, to: &amp;uptr_size) -&gt; &amp;'b [T]</code></pre>
<h3 id="j-iptrszuptrsz"><a class="header" href="#j-iptrszuptrsz">J. <code>iptrsz/uptrsz</code>:</a></h3>
<p>Clear semantics, but still a bit too long (though better than <code>iptr_size/uptr_size</code>), and the <code>ptr</code> parts are still a bit concerning (though to a much less extent than <code>iptr/uptr</code>). On the other hand, being “a bit too long” may not be a disadvantage here.</p>
<pre><code class="language-rust">fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;uptrsz, to: &amp;uptrsz) -&gt; &amp;'b [T]</code></pre>
<h3 id="k-ipszupsz"><a class="header" href="#k-ipszupsz">K. <code>ipsz/upsz</code>:</a></h3>
<p>Now (and only now, which is the problem) it is clear where this pair of alternatives comes from.</p>
<p>By shortening <code>ptr</code> to <code>p</code>, <code>ipsz/upsz</code> no longer stress the “pointer” parts in anyway. Instead, the <code>sz</code> or “size” parts are (comparatively) stressed. Interestingly, <code>ipsz/upsz</code> look similar to <code>isiz/usiz</code>.</p>
<p>So this pair of names actually reflects both the precise semantics of “pointer-sized integers” and the fact that they are commonly used for “sizes”. However,</p>
<pre><code class="language-rust">fn slice_or_fail&lt;'b&gt;(&amp;'b self, from: &amp;upsz, to: &amp;upsz) -&gt; &amp;'b [T]</code></pre>
<p><code>ipsz/upsz</code> have gone too far. They are completely incomprehensible without the documentation. Many rightfully do not like letter soup. The only advantage here is that, no one would be very likely to think he/she is dealing with pointers. <code>iptrsz/uptrsz</code> are better in the comprehensibility aspect.</p>
<h3 id="l-others"><a class="header" href="#l-others">L. Others:</a></h3>
<p>There are other alternatives not covered in this RFC. Please refer to this RFC’s comments and <a href="https://github.com/rust-lang/rfcs/pull/464">RFC PR 464</a> for more.</p>
<h2 id="未解決的問題"><a class="header" href="#未解決的問題">未解決的問題</a></h2>
<p>None. Necessary decisions about Rust’s general integer type policies have been made in <a href="http://discuss.rust-lang.org/t/restarting-the-int-uint-discussion/1131">Restarting the <code>int/uint</code> Discussion</a>.</p>
<h2 id="history"><a class="header" href="#history">History</a></h2>
<p>Amended by <a href="https://github.com/rust-lang/rfcs/pull/573">RFC 573</a> to change the suffixes from <code>is</code> and <code>us</code> to <code>isize</code> and <code>usize</code>. Tracking issue for this amendment is <a href="https://github.com/rust-lang/rust/issues/22496">rust-lang/rust#22496</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="0534-deriving2derive.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="0546-Self-not-sized-by-default.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="0534-deriving2derive.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="0546-Self-not-sized-by-default.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
