msgid ""
msgstr ""
"Project-Id-Version: The Rust RFC Book\n"
"POT-Creation-Date: 2025-12-22T09:04:42Z\n"
"PO-Revision-Date: \n"
"Last-Translator: \n"
"Language-Team: \n"
"Language: zh_CN\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"

#: src/0218-empty-struct-with-braces.md:1
msgid "Start Date: 2014-08-28"
msgstr ""

#: src/0218-empty-struct-with-braces.md:2
msgid ""
"RFC PR: [rust-lang/rfcs#218](https://github.com/rust-lang/rfcs/pull/218)"
msgstr ""

#: src/0218-empty-struct-with-braces.md:3
msgid ""
"Rust Issue: [rust-lang/rust#24266](https://github.com/rust-lang/rust/"
"issues/24266)"
msgstr ""

#: src/0218-empty-struct-with-braces.md:5
msgid "Summary"
msgstr ""

#: src/0218-empty-struct-with-braces.md:7
msgid ""
"When a struct type `S` has no fields (a so-called \"empty struct\"), allow "
"it to be defined via either `struct S;` or `struct S {}`. When defined via "
"`struct S;`, allow instances of it to be constructed and pattern-matched via "
"either `S` or `S {}`. When defined via `struct S {}`, require instances to "
"be constructed and pattern-matched solely via `S {}`."
msgstr ""

#: src/0218-empty-struct-with-braces.md:14
msgid "Motivation"
msgstr ""

#: src/0218-empty-struct-with-braces.md:16
msgid ""
"Today, when writing code, one must treat an empty struct as a special case, "
"distinct from structs that include fields. That is, one must write code like "
"this:"
msgstr ""

#: src/0218-empty-struct-with-braces.md:21
#: src/0218-empty-struct-with-braces.md:24
msgid "// kind of different from the above.\n"
msgstr ""

#: src/0218-empty-struct-with-braces.md:28
msgid "// you can see my pattern here\n"
msgstr ""

#: src/0218-empty-struct-with-braces.md:29
msgid "\"Hello from S2({}, {}) and S0\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:33
msgid ""
"While this yields code that is relatively free of extraneous curly-braces, "
"this special case handling of empty structs presents problems for two cases "
"of interest: automatic code generators (including, but not limited to, Rust "
"macros) and conditionalized code (i.e. code with `cfg` attributes; see the "
"[CFG problem](#the-cfg-problem) appendix). The heart of the code-generator "
"argument is: Why force all to-be-written code-generators and macros with "
"special-case handling of the empty struct case (in terms of whether or not "
"to include the surrounding braces), especially since that special case is "
"likely to be forgotten (yielding a latent bug in the code generator)."
msgstr ""

#: src/0218-empty-struct-with-braces.md:44
msgid ""
"The special case handling of empty structs is also a problem for programmers "
"who actively add and remove fields from structs during development; such "
"changes cause a struct to switch from being empty and non-empty, and the "
"associated revisions of changing removing and adding curly braces is "
"aggravating (both in effort revising the code, and also in extra noise "
"introduced into commit histories)."
msgstr ""

#: src/0218-empty-struct-with-braces.md:51
msgid ""
"This RFC proposes an approach similar to the one we used circa February "
"2013, when both `S0` and `S0 { }` were accepted syntaxes for an empty "
"struct.  The parsing ambiguity that motivated removing support for `S0 { }` "
"is no longer present (see the [Ancient History](#ancient-history) appendix). "
"Supporting empty braces in the syntax for empty structs is easy to do in the "
"language now."
msgstr ""

#: src/0218-empty-struct-with-braces.md:58
msgid "Detailed design"
msgstr ""

#: src/0218-empty-struct-with-braces.md:60
msgid ""
"There are two kinds of empty structs: Braced empty structs and flexible "
"empty structs.  Flexible empty structs are a slight generalization of the "
"structs that we have today."
msgstr ""

#: src/0218-empty-struct-with-braces.md:64
msgid ""
"Flexible empty structs are defined via the syntax `struct S;` (as today)."
msgstr ""

#: src/0218-empty-struct-with-braces.md:66
msgid ""
"Braced empty structs are defined via the syntax `struct S { }` (\"new\")."
msgstr ""

#: src/0218-empty-struct-with-braces.md:68
msgid ""
"Both braced and flexible empty structs can be constructed via the expression "
"syntax `S { }` (\"new\").  Flexible empty structs, as today, can also be "
"constructed via the expression syntax `S`."
msgstr ""

#: src/0218-empty-struct-with-braces.md:72
msgid ""
"Both braced and flexible empty structs can be pattern-matched via the "
"pattern syntax `S { }` (\"new\").  Flexible empty structs, as today, can "
"also be pattern-matched via the pattern syntax `S`."
msgstr ""

#: src/0218-empty-struct-with-braces.md:76
msgid ""
"Braced empty struct definitions solely affect the type namespace, just like "
"normal non-empty structs. Flexible empty structs affect both the type and "
"value namespaces."
msgstr ""

#: src/0218-empty-struct-with-braces.md:80
msgid ""
"As a matter of style, using braceless syntax is preferred for constructing "
"and pattern-matching flexible empty structs.  For example, pretty-printer "
"tools are encouraged to emit braceless forms if they know that the "
"corresponding struct is a flexible empty struct. (Note that pretty printers "
"that handle incomplete fragments may not have such information available.)"
msgstr ""

#: src/0218-empty-struct-with-braces.md:87
msgid ""
"There is no ambiguity introduced by this change, because we have already "
"introduced a restriction to the Rust grammar to force the use of parentheses "
"to disambiguate struct literals in such contexts.  (See [Rust RFC 25]"
"(https://github.com/rust-lang/rfcs/blob/master/complete/0025-struct-grammar."
"md))."
msgstr ""

#: src/0218-empty-struct-with-braces.md:92
msgid ""
"The expectation is that when migrating code from a flexible empty struct to "
"a non-empty struct, it can start by first migrating to a braced empty struct "
"(and then have a tool indicate all of the locations where braces need to be "
"added); after that step has been completed, one can then take the next step "
"of adding the actual field."
msgstr ""

#: src/0218-empty-struct-with-braces.md:98
msgid "Drawbacks"
msgstr ""

#: src/0218-empty-struct-with-braces.md:100
msgid ""
"Some people like \"There is only one way to do it.\"  But, there is "
"precedent in Rust for violating \"one way to do it\" in favor of syntactic "
"convenience or regularity; see the [Precedent for flexible syntax in Rust]"
"(#precedent-for-flexible-syntax-in-rust) appendix. Also, see the [Always "
"Require Braces](#always-require-braces) alternative below."
msgstr ""

#: src/0218-empty-struct-with-braces.md:106
msgid ""
"I have attempted to summarize the previous discussion from [RFC PR 147]"
"(https://github.com/rust-lang/rfcs/pull/147) in the [Recent History](#recent-"
"history) appendix; some of the points there include drawbacks to this "
"approach and to the [Always Require Braces](#always-require-braces) "
"alternative."
msgstr ""

#: src/0218-empty-struct-with-braces.md:111
msgid "Alternatives"
msgstr ""

#: src/0218-empty-struct-with-braces.md:113
msgid "Always Require Braces"
msgstr ""

#: src/0218-empty-struct-with-braces.md:115
msgid ""
"Alternative 1: \"Always Require Braces\".  Specifically, require empty curly "
"braces on empty structs.  People who like the current syntax of curly-brace "
"free structs can encode them this way: `enum S0 { S0 }` This would address "
"all of the same issues outlined above. (Also, the author (pnkfelix) would be "
"happy to take this tack.)"
msgstr ""

#: src/0218-empty-struct-with-braces.md:121
msgid ""
"The main reason not to take this tack is that some people may like writing "
"empty structs without braces, but do not want to switch to the unary enum "
"version described in the previous paragraph. See \"I wouldn't want to force "
"noisier syntax ...\" in the [Recent History](#recent-history) appendix."
msgstr ""

#: src/0218-empty-struct-with-braces.md:127
msgid "Status quo"
msgstr ""

#: src/0218-empty-struct-with-braces.md:129
msgid ""
"Alternative 2: Status quo.  Macros and code-generators in general will need "
"to handle empty structs as a special case.  We may continue hitting bugs "
"like [CFG parse bug](https://github.com/rust-lang/rust/issues/16819).  Some "
"users will be annoyed but most will probably cope."
msgstr ""

#: src/0218-empty-struct-with-braces.md:134
msgid "Synonymous in all contexts"
msgstr ""

#: src/0218-empty-struct-with-braces.md:136
msgid ""
"Alternative 3: An earlier version of this RFC proposed having `struct S;` be "
"entirely synonymous with `struct S { }`, and the expression `S { }` be "
"synonymous with `S`."
msgstr ""

#: src/0218-empty-struct-with-braces.md:140
msgid ""
"This was deemed problematic, since it would mean that `S { }` would put an "
"entry into both the type and value namespaces, while `S { x: int }` would "
"only put an entry into the type namespace. Thus the current draft of the RFC "
"proposes the \"flexible\" versus \"braced\" distinction for empty structs."
msgstr ""

#: src/0218-empty-struct-with-braces.md:146
msgid "Never synonymous"
msgstr ""

#: src/0218-empty-struct-with-braces.md:148
msgid ""
"Alternative 4: Treat `struct S;` as requiring `S` at the expression and "
"pattern sites, and `struct S { }` as requiring `S { }` at the expression and "
"pattern sites."
msgstr ""

#: src/0218-empty-struct-with-braces.md:152
msgid ""
"This in some ways follows a principle of least surprise, but it also is "
"really hard to justify having both syntaxes available for empty structs with "
"no flexibility about how they are used.  (Note again that one would have the "
"option of choosing between `enum S { S }`, `struct S;`, or `struct S { }`, "
"each with their own idiosyncrasies about whether you have to write `S` or `S "
"{ }`.) I would rather adopt \"Always Require Braces\" than \"Never "
"Synonymous\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:160
msgid "Empty Tuple Structs"
msgstr ""

#: src/0218-empty-struct-with-braces.md:162
msgid ""
"One might say \"why are you including support for curly braces, but not "
"parentheses?\"  Or in other words, \"what about empty tuple structs?\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:165
msgid ""
"The code-generation argument could be applied to tuple-structs as well, to "
"claim that we should allow the syntax `S0()`.  I am less inclined to add a "
"special case for that; I think tuple-structs are less frequently used "
"(especially with many fields); they are largely for ad-hoc data such as "
"newtype wrappers, not for code generators."
msgstr ""

#: src/0218-empty-struct-with-braces.md:171
msgid ""
"Note that we should not attempt to generalize this RFC as proposed to "
"include tuple structs, i.e. so that given `struct S0 {}`, the expressions "
"`T0`, `T0 {}`, and `T0()` would be synonymous.  The reason is that given a "
"tuple struct `struct T2(int, int)`, the identifier `T2` is _already_ bound "
"to a constructor function:"
msgstr ""

#: src/0218-empty-struct-with-braces.md:183
msgid "\"Hello from {} and {}\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:189
msgid ""
"So if we were to attempt to generalize the leniency of this RFC to tuple "
"structs, we would be in the unfortunate situation given `struct T0();` of "
"trying to treat `T0` simultaneously as an instance of the struct and as a "
"constructor function.  So, the handling of empty structs proposed by this "
"RFC does not generalize to tuple structs."
msgstr ""

#: src/0218-empty-struct-with-braces.md:195
msgid ""
"(Note that if we adopt alternative 1, [Always Require Braces](#always-"
"require-braces), then the issue of how tuple structs are handled is totally "
"orthogonal -- we could add support for `struct T0()` as a distinct type from "
"`struct S0 {}`, if we so wished, or leave it aside.)"
msgstr ""

#: src/0218-empty-struct-with-braces.md:200
msgid "Unresolved questions"
msgstr ""

#: src/0218-empty-struct-with-braces.md:202
msgid "None"
msgstr ""

#: src/0218-empty-struct-with-braces.md:204
msgid "Appendices"
msgstr ""

#: src/0218-empty-struct-with-braces.md:206
msgid "The CFG problem"
msgstr ""

#: src/0218-empty-struct-with-braces.md:208
msgid "A program like this works today:"
msgstr ""

#: src/0218-empty-struct-with-braces.md:225
msgid "\"Hello from {}\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:229
msgid "Observe what happens when one modifies the above just a bit:"
msgstr ""

#: src/0218-empty-struct-with-braces.md:242
msgid ""
"Now, certain `cfg` settings yield an empty struct, even though it is "
"surrounded by braces.  Today this leads to a [CFG parse bug](https://github."
"com/rust-lang/rust/issues/16819) when one attempts to actually construct "
"such a struct."
msgstr ""

#: src/0218-empty-struct-with-braces.md:246
msgid ""
"If we want to support situations like this properly, we will probably need "
"to further extend the `cfg` attribute so that it can be placed before "
"individual fields in a struct constructor, like this:"
msgstr ""

#: src/0218-empty-struct-with-braces.md:251
msgid ""
"// You cannot do this today,\n"
"// but maybe in the future (after a different RFC)\n"
msgstr ""

#: src/0218-empty-struct-with-braces.md:260
msgid ""
"Supporting such a syntax consistently in the future should start today with "
"allowing empty braces as legal code.  (Strictly speaking, it is not "
"_necessary_ that we add support for empty braces at the parsing level to "
"support this feature at the semantic level.  But supporting empty-braces in "
"the syntax still seems like the most consistent path to me.)"
msgstr ""

#: src/0218-empty-struct-with-braces.md:267
msgid "Ancient History"
msgstr ""

#: src/0218-empty-struct-with-braces.md:269
msgid ""
"A parsing ambiguity was the original motivation for disallowing the syntax "
"`S {}` in favor of `S` for constructing an instance of an empty struct.  The "
"ambiguity and various options for dealing with it were well documented on "
"the [rust-dev thread](https://mail.mozilla.org/pipermail/rust-dev/2013-"
"February/003282.html). Both syntaxes were simultaneously supported at the "
"time."
msgstr ""

#: src/0218-empty-struct-with-braces.md:275
msgid ""
"In particular, at the time that mailing list thread was created, the code "
"match `match x {} ...` would be parsed as `match (x {}) ...`, not as `(match "
"x {}) ...` (see [Rust PR 5137](https://github.com/rust-lang/rust/"
"pull/5137)); likewise, `if x {}` would be parsed as an if-expression whose "
"test component is the struct literal `x {}`.  Thus, at the time of [Rust PR "
"5137](https://github.com/rust-lang/rust/pull/5137), if the input to a "
"`match` or `if` was an identifier expression, one had to put parentheses "
"around the identifier to force it to be interpreted as input to the `match`/"
"`if`, and not as a struct constructor."
msgstr ""

#: src/0218-empty-struct-with-braces.md:284
msgid ""
"Of the options for resolving this discussed on the mailing list thread, the "
"one selected (removing `S {}` construction expressions) was chosen as the "
"most expedient option."
msgstr ""

#: src/0218-empty-struct-with-braces.md:288
msgid ""
"At that time, the option of \"Place a parser restriction on those contexts "
"where `{` terminates the expression and say that struct literals cannot "
"appear there unless they are in parentheses.\" was explicitly not chosen, in "
"favor of continuing to use the disambiguation rule in use at the time, "
"namely that the presence of a label (e.g. `S { a_label: ... }`) was _the_ "
"way to distinguish a struct constructor from an identifier followed by a "
"control block, and thus, \"there must be one label.\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:297
msgid ""
"Naturally, if the construction syntax were to be disallowed, it made sense "
"to also remove the `struct S {}` declaration syntax."
msgstr ""

#: src/0218-empty-struct-with-braces.md:300
msgid ""
"Things have changed since the time of that mailing list thread; namely, we "
"have now adopted the aforementioned parser restriction [Rust RFC 25](https://"
"github.com/rust-lang/rfcs/blob/master/complete/0025-struct-grammar.md).  "
"(The text of RFC 25 does not explicitly address `match`, but we have "
"effectively expanded it to include a curly-brace delimited block of match-"
"arms in the definition of \"block\".)  Today, one uses parentheses around "
"struct literals in some contexts (such as `for e in (S {x: 3}) { ... }` or "
"`match (S {x: 3}) { ... }`"
msgstr ""

#: src/0218-empty-struct-with-braces.md:308
msgid ""
"Note that there was never an ambiguity for uses of `struct S0 { }` in item "
"position.  The issue was solely about expression position prior to the "
"adoption of [Rust RFC 25](https://github.com/rust-lang/rfcs/blob/master/"
"complete/0025-struct-grammar.md)."
msgstr ""

#: src/0218-empty-struct-with-braces.md:312
msgid "Precedent for flexible syntax in Rust"
msgstr ""

#: src/0218-empty-struct-with-braces.md:314
msgid ""
"There is precedent in Rust for violating \"one way to do it\" in favor of "
"syntactic convenience or regularity."
msgstr ""

#: src/0218-empty-struct-with-braces.md:317
msgid ""
"For example, one can often include an optional trailing comma, for example "
"in: `let x : &[int] = [3, 2, 1, ];`."
msgstr ""

#: src/0218-empty-struct-with-braces.md:320
msgid ""
"One can also include redundant curly braces or parentheses, for example in:"
msgstr ""

#: src/0218-empty-struct-with-braces.md:323
msgid "\"hi: {}\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:323
msgid "\"whoa\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:323
msgid "\"there\""
msgstr ""

#: src/0218-empty-struct-with-braces.md:326
msgid "One can even mix the two together when delimiting match arms:"
msgstr ""

#: src/0218-empty-struct-with-braces.md:335
msgid ""
"We do have lints for some style violations (though none catch the cases "
"above), but lints are different from fundamental language restrictions."
msgstr ""

#: src/0218-empty-struct-with-braces.md:339
msgid "Recent history"
msgstr ""

#: src/0218-empty-struct-with-braces.md:341
msgid ""
"There was a previous [RFC PR](https://github.com/rust-lang/rfcs/pull/147) "
"that was effectively the same in spirit to this one.  It was closed because "
"it was not sufficient well fleshed out for further consideration by the core "
"team.  However, to save people the effort of reviewing the comments on that "
"PR (and hopefully stave off potential bikeshedding on this PR), I here "
"summarize the various viewpoints put forward on the comment thread there, "
"and note for each one, whether that viewpoint would be addressed by this RFC "
"(accept both syntaxes), by [Always Require Braces](#always-require-braces), "
"or by [Status Quo](#status-quo)."
msgstr ""

#: src/0218-empty-struct-with-braces.md:351
msgid ""
"Note that this list of comments is _just_ meant to summarize the list of "
"views; it does not attempt to reflect the number of commenters who agreed or "
"disagreed with a particular point.  (But since the RFC process is not a "
"democracy, the number of commenters should not matter anyway.)"
msgstr ""

#: src/0218-empty-struct-with-braces.md:356
msgid ""
"\"+1\" ==> Favors: This RFC (or potentially [Always Require Braces](#always-"
"require-braces); I think the content of [RFC PR 147](https://github.com/rust-"
"lang/rfcs/pull/147) shifted over time, so it is hard to interpret the \"+1\" "
"comments now)."
msgstr ""

#: src/0218-empty-struct-with-braces.md:357
msgid ""
"\"I find `let s = S0;` jarring, think its an enum initially.\" ==> Favors: "
"Always Require Braces"
msgstr ""

#: src/0218-empty-struct-with-braces.md:358
msgid ""
"\"Frequently start out with an empty struct and add fields as I need them.\" "
"==> Favors: This RFC or Always Require Braces"
msgstr ""

#: src/0218-empty-struct-with-braces.md:359
msgid ""
"\"Foo{} suggests is constructing something that it's not; all uses of the "
"value `Foo` are indistinguishable from each other\" ==> Favors: Status Quo"
msgstr ""

#: src/0218-empty-struct-with-braces.md:360
msgid ""
"\"I find it strange anyone would prefer `let x = Foo{};` over `let x = Foo;"
"`\" ==> Favors Status Quo; strongly opposes Always Require Braces."
msgstr ""

#: src/0218-empty-struct-with-braces.md:361
msgid ""
"\"I agree that 'instantiation-should-follow-declaration', that is, structs "
"declared `;, (), {}` should only be instantiated \\[via\\] `;, (), { }` "
"respectively\" ==> Opposes leniency of this RFC in that it allows expression "
"to use include or omit `{}` on an empty struct, regardless of declaration "
"form, and vice-versa."
msgstr ""

#: src/0218-empty-struct-with-braces.md:362
msgid ""
"\"The code generation argument is reasonable, but I wouldn't want to force "
"noisier syntax on all 'normal' code just to make macros work better.\" ==> "
"Favors: This RFC"
msgstr ""
