<!DOCTYPE HTML>
<html lang="zh_CN" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>1236-stabilize-catch-panic - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-b61d75f0.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: <code>recover</code></li>
<li>Start Date: 2015-07-24</li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/1236">rust-lang/rfcs#1236</a></li>
<li>Rust Issue: <a href="https://github.com/rust-lang/rust/issues/27719">rust-lang/rust#27719</a></li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Move <code>std::thread::catch_panic</code> to <code>std::panic::recover</code> after replacing the <code>Send + 'static</code> bounds on the closure parameter with a new <code>PanicSafe</code> marker trait.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>In today’s stable Rust it’s not possible to catch a panic on the thread that caused it. There are a number of situations, however, where this is either required for correctness or necessary for building a useful abstraction:</p>
<ul>
<li>
<p>It is currently defined as undefined behavior to have a Rust program panic across an FFI boundary. For example if C calls into Rust and Rust panics, then this is undefined behavior. Being able to catch a panic will allow writing C APIs in Rust that do not risk aborting the process they are embedded into.</p>
</li>
<li>
<p>Abstractions like thread pools want to catch the panics of tasks being run instead of having the thread torn down (and having to spawn a new thread).</p>
</li>
</ul>
<p>Stabilizing the <code>catch_panic</code> function would enable these two use cases, but let’s also take a look at the current signature of the function:</p>
<pre><code class="language-rust">fn catch_panic&lt;F, R&gt;(f: F) -&gt; thread::Result&lt;R&gt;
    where F: FnOnce() -&gt; R + Send + 'static</code></pre>
<p>This function will run the closure <code>f</code> and if it panics return <code>Err(Box&lt;Any&gt;)</code>. If the closure doesn’t panic it will return <code>Ok(val)</code> where <code>val</code> is the returned value of the closure. The closure, however, is restricted to only close over <code>Send</code> and <code>'static</code> data. These bounds can be overly restrictive, and due to thread-local storage <a href="https://github.com/rust-lang/rust/issues/25662">they can be subverted</a>, making it unclear what purpose they serve. This RFC proposes to remove the bounds as well.</p>
<p>Historically Rust has purposefully avoided the foray into the situation of catching panics, largely because of a problem typically referred to as “exception safety”. To further understand the motivation of stabilization and relaxing the bounds, let’s review what exception safety is and what it means for Rust.</p>
<h2 id="background-what-is-exception-safety"><a class="header" href="#background-what-is-exception-safety">Background: What is exception safety?</a></h2>
<p>Languages with exceptions have the property that a function can “return” early if an exception is thrown. While exceptions aren’t too hard to reason about when thrown explicitly, they can be problematic when they are thrown by code being called – especially when that code isn’t known in advance. Code is <strong>exception safe</strong> if it works correctly even when the functions it calls into throw exceptions.</p>
<p>The idea of throwing an exception causing bugs may sound a bit alien, so it’s helpful to drill down into exactly why this is the case. Bugs related to exception safety are comprised of two critical components:</p>
<ol>
<li>An invariant of a data structure is broken.</li>
<li>This broken invariant is the later observed.</li>
</ol>
<p>Exceptional control flow often exacerbates this first component of breaking invariants. For example many data structures have a number of invariants that are dynamically upheld for correctness, and the type’s routines can temporarily break these invariants to be fixed up before the function returns.  If, however, an exception is thrown in this interim period the broken invariant could be accidentally exposed.</p>
<p>The second component, observing a broken invariant, can sometimes be difficult in the face of exceptions, but languages often have constructs to enable these sorts of witnesses. Two primary methods of doing so are something akin to finally blocks (code run on a normal or exceptional return) or just catching the exception. In both cases code which later runs that has access to the original data structure will see the broken invariants.</p>
<p>Now that we’ve got a better understanding of how an exception might cause a bug (e.g. how code can be “exception unsafe”), let’s take a look how we can make code exception safe. To be exception safe, code needs to be prepared for an exception to be thrown whenever an invariant it relies on is broken, for example:</p>
<ul>
<li>Code can be audited to ensure it only calls functions which are statically known to not throw an exception.</li>
<li>Local “cleanup” handlers can be placed on the stack to restore invariants whenever a function returns, either normally or exceptionally. This can be done through finally blocks in some languages or via destructors in others.</li>
<li>Exceptions can be caught locally to perform cleanup before possibly re-raising the exception.</li>
</ul>
<p>With all that in mind, we’ve now identified problems that can arise via exceptions (an invariant is broken and then observed) as well as methods to ensure that prevent this from happening. In languages like C++ this means that we can be memory safe in the face of exceptions and in languages like Java we can ensure that our logical invariants are upheld. Given this background let’s take a look at how any of this applies to Rust.</p>
<h2 id="background-what-is-exception-safety-in-rust"><a class="header" href="#background-what-is-exception-safety-in-rust">Background: What is exception safety in Rust?</a></h2>
<blockquote>
<p>Note: This section describes the current state of Rust today without this RFC implemented</p>
</blockquote>
<p>Up to now we’ve been talking about exceptions and exception safety, but from a Rust perspective we can just replace this with panics and panic safety. Panics in Rust are currently implemented essentially as a C++ exception under the hood. As a result, <strong>exception safety is something that needs to be handled in Rust code today</strong>.</p>
<p>One of the primary examples where panics need to be handled in Rust is unsafe code. Let’s take a look at an example where this matters:</p>
<pre><code class="language-rust">pub fn push_ten_more&lt;T: Clone&gt;(v: &amp;mut Vec&lt;T&gt;, t: T) {
    unsafe {
        v.reserve(10);
        let len = v.len();
        v.set_len(len + 10);
        for i in 0..10 {
            ptr::write(v.as_mut_ptr().offset(len + i), t.clone());
        }
    }
}</code></pre>
<p>While this code may look correct, it’s actually not memory safe. <code>Vec</code> has an internal invariant that its first <code>len</code> elements are safe to drop at any time. Our function above has temporarily broken this invariant with the call to <code>set_len</code> (the next 10 elements are uninitialized). If the type <code>T</code>’s <code>clone</code> method panics then this broken invariant will escape the function. The broken <code>Vec</code> is then observed during its destructor, leading to the eventual memory unsafety.</p>
<p>It’s important to keep in mind that panic safety in Rust is not solely limited to memory safety. <em>Logical invariants</em> are often just as critical to keep correct during execution and no <code>unsafe</code> code in Rust is needed to break a logical invariant. In practice, however, these sorts of bugs are rarely observed due to Rust’s design:</p>
<ul>
<li>Rust doesn’t expose uninitialized memory</li>
<li>Panics cannot be caught in a thread</li>
<li>Across threads data is poisoned by default on panics</li>
<li>Idiomatic Rust must opt in to extra sharing across boundaries (e.g. <code>RefCell</code>)</li>
<li>Destructors are relatively rare and uninteresting in safe code</li>
</ul>
<p>These mitigations all address the <em>second</em> aspect of exception unsafety: observation of broken invariants. With the tactics in place, it ends up being the case that <strong>safe Rust code can largely ignore exception safety concerns</strong>. That being said, it does not mean that safe Rust code can <em>always</em> ignore exception safety issues. There are a number of methods to subvert the mitigation strategies listed above:</p>
<ol>
<li>When poisoning data across threads, antidotes are available to access poisoned data. Namely the <a href="http://doc.rust-lang.org/std/sync/struct.PoisonError.html"><code>PoisonError</code> type</a> allows safe access to the poisoned information.</li>
<li>Single-threaded types with interior mutability, such as <code>RefCell</code>, allow for sharing data across stack frames such that a broken invariant could eventually be observed.</li>
<li>Whenever a thread panics, the destructors for its stack variables will be run as the thread unwinds. Destructors may have access to data which was also accessible lower on the stack (such as through <code>RefCell</code> or <code>Rc</code>) which has a broken invariant, and the destructor may then witness this.</li>
</ol>
<p>But all of these “subversions” fall outside the realm of normal, idiomatic, safe Rust code, and so they all serve as a “heads up” that panic safety might be an issue. Thus, in practice, Rust programmers worry about exception safety far less than in languages with full-blown exceptions.</p>
<p>Despite these methods to subvert the mitigations placed by default in Rust, a key part of exception safety in Rust is that <strong>safe code can never lead to memory unsafety</strong>, regardless of whether it panics or not. Memory unsafety triggered as part of a panic can always be traced back to an <code>unsafe</code> block.</p>
<p>With all that background out of the way now, let’s take a look at the guts of this RFC.</p>
<h2 id="detailed-design"><a class="header" href="#detailed-design">Detailed design</a></h2>
<p>At its heart, the change this RFC is proposing is to move <code>std::thread::catch_panic</code> to a new <code>std::panic</code> module and rename the function to <code>recover</code>. Additionally, the <code>Send + 'static</code> bounds on the closure parameter will be replaced with a new trait <code>PanicSafe</code>, modifying the signature to be:</p>
<pre><code class="language-rust">fn recover&lt;F: FnOnce() -&gt; R + PanicSafe, R&gt;(f: F) -&gt; thread::Result&lt;R&gt;</code></pre>
<p>Before analyzing this new signature, let’s take a look at this new <code>PanicSafe</code> trait.</p>
<h3 id="a-panicsafe-marker-trait"><a class="header" href="#a-panicsafe-marker-trait">A <code>PanicSafe</code> marker trait</a></h3>
<p>As discussed in the motivation section above, the current bounds of <code>Send + 'static</code> on the closure parameter are too restrictive for common use cases, but they can serve as a “speed bump” (like poisoning on mutexes) to add to the repertoire of mitigation strategies that Rust has by default for dealing with panics.</p>
<p>The purpose of this marker trait will be to identify patterns which do not need to worry about exception safety and allow them by default. In situations where exception safety <em>may</em> be concerned then an explicit annotation will be needed to allow the usage. In other words, this marker trait will act similarly to a “targeted <code>unsafe</code> block”.</p>
<p>For the implementation details, the following items will be added to the <code>std::panic</code> module.</p>
<pre><code class="language-rust">pub trait PanicSafe {}
impl PanicSafe for .. {}

impl&lt;'a, T&gt; !PanicSafe for &amp;'a mut T {}
impl&lt;'a, T: NoUnsafeCell&gt; PanicSafe for &amp;'a T {}
impl&lt;T&gt; PanicSafe for Mutex&lt;T&gt; {}

pub trait NoUnsafeCell {}
impl NoUnsafeCell for .. {}
impl&lt;T&gt; !NoUnsafeCell for UnsafeCell&lt;T&gt; {}

pub struct AssertPanicSafe&lt;T&gt;(pub T);
impl&lt;T&gt; PanicSafe for AssertPanicSafe&lt;T&gt; {}

impl&lt;T&gt; Deref for AssertPanicSafe&lt;T&gt; {
    type Target = T;
    fn deref(&amp;self) -&gt; &amp;T { &amp;self.0 }
}
impl&lt;T&gt; DerefMut for AssertPanicSafe&lt;T&gt; {
    fn deref_mut(&amp;mut self) -&gt; &amp;mut T { &amp;mut self.0 }
}</code></pre>
<p>Let’s take a look at each of these items in detail:</p>
<ul>
<li><code>impl PanicSafe for .. {}</code> - this makes this trait a marker trait, implying that a the trait is implemented for all types by default so long as the constituent parts implement the trait.</li>
<li><code>impl&lt;T&gt; !PanicSafe for &amp;mut T {}</code> - this indicates that exception safety needs to be handled when dealing with mutable references. Thinking about the <code>recover</code> function, this means that the pointer could be modified inside the block, but once it exits the data may or may not be in an invalid state.</li>
<li><code>impl&lt;T: NoUnsafeCell&gt; PanicSafe for &amp;T {}</code> - similarly to the above implementation for <code>&amp;mut T</code>, the purpose here is to highlight points where data can be mutated across a <code>recover</code> boundary. If <code>&amp;T</code> does not contains an <code>UnsafeCell</code>, then no mutation should be possible and it is safe to allow.</li>
<li><code>impl&lt;T&gt; PanicSafe for Mutex&lt;T&gt; {}</code> - as mutexes are poisoned by default, they are considered exception safe.</li>
<li><code>pub struct AssertPanicSafe&lt;T&gt;(pub T);</code> - this is the “opt out” structure of exception safety. Wrapping something in this type indicates an assertion that it is exception safe and shouldn’t be warned about when crossing the <code>recover</code> boundary. Otherwise this type simply acts like a <code>T</code>.</li>
</ul>
<h4 id="example-usage"><a class="header" href="#example-usage">Example usage</a></h4>
<p>The only consumer of the <code>PanicSafe</code> bound is the <code>recover</code> function on the closure type parameter, and this ends up meaning that the <em>environment</em> needs to be exception safe. In terms of error messages, this causes the compiler to emit an error per closed-over-variable to indicate whether or not it is exception safe to share across the boundary.</p>
<p>It is also a critical design aspect that usage of <code>PanicSafe</code> or <code>AssertPanicSafe</code> does not require <code>unsafe</code> code. As discussed above, panic safety does not directly lead to memory safety problems in otherwise safe code.</p>
<p>In the normal usage of <code>recover</code>, neither <code>PanicSafe</code> nor <code>AssertPanicSafe</code> should be necessary to mention. For example when defining an FFI function:</p>
<pre><code class="language-rust">#[no_mangle]
pub extern fn called_from_c(ptr: *const c_char, num: i32) -&gt; i32 {
    let result = panic::recover(|| {
        let s = unsafe { CStr::from_ptr(ptr) };
        println!("{}: {}", s, num);
    });
    match result {
        Ok(..) =&gt; 0,
        Err(..) =&gt; 1,
    }
}</code></pre>
<p>Additionally, if FFI functions instead use normal Rust types, <code>AssertPanicSafe</code> still need not be mentioned at all:</p>
<pre><code class="language-rust">#[no_mangle]
pub extern fn called_from_c(ptr: &amp;i32) -&gt; i32 {
    let result = panic::recover(|| {
        println!("{}", *ptr);
    });
    match result {
        Ok(..) =&gt; 0,
        Err(..) =&gt; 1,
    }
}</code></pre>
<p>If, however, types are coming in which are flagged as not exception safe then the <code>AssertPanicSafe</code> wrapper can be used to leverage <code>recover</code>:</p>
<pre><code class="language-rust">fn foo(data: &amp;RefCell&lt;i32&gt;) {
    panic::recover(|| {
        println!("{}", data.borrow()); //~ ERROR RefCell is not panic safe
    });
}</code></pre>
<p>This can be fixed with a simple assertion that the usage here is indeed exception safe:</p>
<pre><code class="language-rust">fn foo(data: &amp;RefCell&lt;i32&gt;) {
    let data = AssertPanicSafe(data);
    panic::recover(|| {
        println!("{}", data.borrow()); // ok
    });
}</code></pre>
<h4 id="future-extensions"><a class="header" href="#future-extensions">Future extensions</a></h4>
<p>In the future, this RFC proposes adding the following implementation of <code>PanicSafe</code>:</p>
<pre><code class="language-rust">impl&lt;T: Send + 'static&gt; PanicSafe for T {}</code></pre>
<p>This implementation block encodes the “exception safe” boundary of <code>thread::spawn</code> but is unfortunately not allowed today due to coherence rules. If available, however, it would possibly reduce the number of false positives which require using <code>AssertPanicSafe</code>.</p>
<h4 id="global-complexity"><a class="header" href="#global-complexity">Global complexity</a></h4>
<p>Adding a new marker trait is a pretty hefty move for the standard library. The current marker traits, <code>Send</code> and <code>Sync</code>, are well known and are ubiquitous throughout the ecosystem and standard library. Due to the way that these properties are derived, adding a new marker trait can lead to a multiplicative increase in global complexity (as all types must consider the marker trait).</p>
<p>With <code>PanicSafe</code>, however, it is expected that this is not the case. The <code>recover</code> function is not intended to be used commonly outside of FFI or thread pool-like abstractions. Within FFI the <code>PanicSafe</code> trait is typically not mentioned due to most types being relatively simple. Thread pools, on the other hand, will need to mention <code>AssertPanicSafe</code>, but will likely propagate panics to avoid exposing <code>PanicSafe</code> as a bound.</p>
<p>Overall, the expected idiomatic usage of <code>recover</code> should mean that <code>PanicSafe</code> is rarely mentioned, if at all. It is intended that <code>AssertPanicSafe</code> is ideally only necessary where it actually needs to be considered (which idiomatically isn’t too often) and even then it’s lightweight to use.</p>
<h3 id="will-rust-have-exceptions"><a class="header" href="#will-rust-have-exceptions">Will Rust have exceptions?</a></h3>
<p>In a technical sense this RFC is not “adding exceptions to Rust” as they already exist in the form of panics. What this RFC is adding, however, is a construct via which to catch these exceptions within a thread, bringing the standard library closer to the exception support in other languages.</p>
<p>Catching a panic makes it easier to observe broken invariants of data structures shared across the <code>catch_panic</code> boundary, which can possibly increase the likelihood of exception safety issues arising.</p>
<p>The risk of this step is that catching panics becomes an idiomatic way to deal with error-handling, thereby making exception safety much more of a headache than it is today (as it’s more likely that a broken invariant is later witnessed). The <code>catch_panic</code> function is intended to only be used where it’s absolutely necessary, e.g. for FFI boundaries, but how can it be ensured that <code>catch_panic</code> isn’t overused?</p>
<p>There are two key reasons <code>catch_panic</code> likely won’t become idiomatic:</p>
<ol>
<li>
<p>There are already strong and established conventions around error handling, and in particular around the use of panic and <code>Result</code> with stabilized usage of them in the standard library. There is little chance these conventions would change overnight.</p>
</li>
<li>
<p>There has long been a desire to treat every use of <code>panic!</code> as an abort which is motivated by portability, compile time, binary size, and a number of other factors. Assuming this step is taken, it would be extremely unwise for a library to signal expected errors via panics and rely on consumers using <code>catch_panic</code> to handle them.</p>
</li>
</ol>
<p>For reference, here’s a summary of the conventions around <code>Result</code> and <code>panic</code>, which still hold good after this RFC:</p>
<h4 id="result-vs-panic"><a class="header" href="#result-vs-panic">Result vs Panic</a></h4>
<p>There are two primary strategies for signaling that a function can fail in Rust today:</p>
<ul>
<li>
<p><code>Results</code> represent errors/edge-cases that the author of the library knew about, and expects the consumer of the library to handle.</p>
</li>
<li>
<p><code>panic</code>s represent errors that the author of the library did not expect to occur, such as a contract violation, and therefore does not expect the consumer to handle in any particular way.</p>
</li>
</ul>
<p>Another way to put this division is that:</p>
<ul>
<li>
<p><code>Result</code>s represent errors that carry additional contextual information. This information allows them to be handled by the caller of the function producing the error, modified with additional contextual information, and eventually converted into an error message fit for a top-level program.</p>
</li>
<li>
<p><code>panic</code>s represent errors that carry no contextual information (except, perhaps, debug information). Because they represented an unexpected error, they cannot be easily handled by the caller of the function or presented to the top-level program (except to say “something unexpected has gone wrong”).</p>
</li>
</ul>
<p>Some pros of <code>Result</code> are that it signals specific edge cases that you as a consumer should think about handling and it allows the caller to decide precisely how to handle the error. A con with <code>Result</code> is that defining errors and writing down <code>Result</code> + <code>try!</code> is not always the most ergonomic.</p>
<p>The pros and cons of <code>panic</code> are essentially the opposite of <code>Result</code>, being easy to use (nothing to write down other than the panic) but difficult to determine when a panic can happen or handle it in a custom fashion, even with <code>catch_panic</code>.</p>
<p>These divisions justify the use of <code>panic</code>s for things like out-of-bounds indexing: such an error represents a programming mistake that (1) the author of the library was not aware of, by definition, and (2) cannot be meaningfully handled by the caller.</p>
<p>In terms of heuristics for use, <code>panic</code>s should rarely if ever be used to report routine errors for example through communication with the system or through IO. If a Rust program shells out to <code>rustc</code>, and <code>rustc</code> is not found, it might be tempting to use a panic because the error is unexpected and hard to recover from. A user of the program, however, would benefit from intermediate code adding contextual information about the in-progress operation, and the program could report the error in terms a they can understand. While the error is rare, <strong>when it happens it is not a programmer error</strong>. In short, panics are roughly analogous to an opaque “an unexpected error has occurred” message.</p>
<p>Stabilizing <code>catch_panic</code> does little to change the tradeoffs around <code>Result</code> and <code>panic</code> that led to these conventions.</p>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<p>A drawback of this RFC is that it can water down Rust’s error handling story. With the addition of a “catch” construct for exceptions, it may be unclear to library authors whether to use panics or <code>Result</code> for their error types. As we discussed above, however, Rust’s design around error handling has always had to deal with these two strategies, and our conventions don’t materially change by stabilizing <code>catch_panic</code>.</p>
<h2 id="alternatives"><a class="header" href="#alternatives">Alternatives</a></h2>
<p>One alternative, which is somewhat more of an addition, is to have the standard library entirely abandon all exception safety mitigation tactics. As explained in the motivation section, exception safety will not lead to memory unsafety unless paired with unsafe code, so it is perhaps within the realm of possibility to remove the tactics of poisoning from mutexes and simply require that consumers deal with exception safety 100% of the time.</p>
<p>This alternative is often motivated by saying that there are enough methods to subvert the default mitigation tactics that it’s not worth trying to plug some holes and not others. Upon closer inspection, however, the areas where safe code needs to worry about exception safety are isolated to the single-threaded situations. For example <code>RefCell</code>, destructors, and <code>catch_panic</code> all only expose data possibly broken through a panic in a single thread.</p>
<p>Once a thread boundary is crossed, the only current way to share data mutably is via <code>Mutex</code> or <code>RwLock</code>, both of which are poisoned by default. This sort of sharing is fundamental to threaded code, and poisoning by default allows safe code to freely use many threads without having to consider exception safety across threads (as poisoned data will tear down all connected threads).</p>
<p>This property of multithreaded programming in Rust is seen as strong enough that poisoning should not be removed by default, and in fact a new hypothetical <code>thread::scoped</code> API (a rough counterpart of <code>catch_panic</code>) could also propagate panics by default (like poisoning) with an ability to opt out (like <code>PoisonError</code>).</p>
<h2 id="unresolved-questions"><a class="header" href="#unresolved-questions">Unresolved questions</a></h2>
<ul>
<li>
<p>Is it worth keeping the <code>'static</code> and <code>Send</code> bounds as a mitigation measure in practice, even if they aren’t enforceable in theory? That would require thread pools to use unsafe code, but that could be acceptable.</p>
</li>
<li>
<p>Should <code>catch_panic</code> be stabilized within <code>std::thread</code> where it lives today, or somewhere else?</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="1229-compile-time-asserts.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="1238-nonparametric-dropck.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="1229-compile-time-asserts.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="1238-nonparametric-dropck.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
