<!DOCTYPE HTML>
<html lang="zh_CN" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>3516-public-private-dependencies - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-b61d75f0.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: <code>public_private_dependencies</code></li>
<li>Start Date: 2023-10-13</li>
<li>Prior RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/1977">rust-lang/rfcs#1977</a></li>
<li>Pre-RFC: <a href="https://internals.rust-lang.org/t/pre-rfc-superseding-public-private-dependencies/19708">Pre-RFC: Superseding public/private dependencies</a></li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/3516">rust-lang/rfcs#3516</a></li>
<li>Rust Issue: <a href="https://github.com/rust-lang/rust/issues/44663">rust-lang/rust#44663</a></li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Introduce a public/private distinction to crate dependencies.</p>
<p>Note: this supersedes <a href="https://github.com/rust-lang/rfcs/pull/1977">RFC 1977</a> Enough has changed in the time since that RFC was approved that we felt we needed to go back and get wider input on this, rather than handling decisions through the tracking issue.</p>
<ul>
<li><a href="https://github.com/rust-lang/rfcs/pull/1977">RFC 1977</a> was written before Editions, <code>cfg</code> dependencies, and package renaming which can all affect it</li>
<li>The resolver changes were a large part of <a href="https://github.com/rust-lang/rfcs/pull/1977">RFC 1977</a> but there are concerns with it and we feel it’d be best to decouple it, offering a faster path to stabilization</li>
</ul>
<p>Note: The 2024 Edition is referenced in this RFC but that is a placeholder for whatever edition next comes up after stabilization.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>The crates ecosystem has greatly expanded since Rust 1.0. With that, a few patterns for dependencies have evolved that challenge the existing dependency declaration system in Cargo and Rust. The most common problem is that a crate <code>A</code> depends on another crate <code>B</code> but some of the types from crate <code>B</code> are exposed through the API in crate <code>A</code>.</p>
<ul>
<li>Brittle semver compatibility as <code>A</code> might not have intended to expose <code>B</code>, like when adding <code>impl From&lt;B::error&gt; for AError</code> for convenience in using <code>?</code> in the implementation of <code>A</code>.</li>
<li>When self-hosting documentation, you may want to render documentation for all of your public dependencies as well</li>
<li>When running <code>cargo doc</code>, users may want to render <a href="https://github.com/rust-lang/cargo/issues/2025">documentation for their accessible dependencies</a> <a href="https://github.com/rust-lang/cargo/issues/4049">without the cost of their inaccessible dependencies</a></li>
<li>When linting for semver compatibility <a href="https://github.com/obi1kenobi/cargo-semver-checks/issues/121">there isn’t enough information to reason about dependencies</a></li>
</ul>
<p>Related problems with this scenario not handled by this RFC:</p>
<ul>
<li>Poor error messages when a user directly depends on <code>A</code> and <code>B</code> but with a version requirement on <code>B</code> that is semver incompatible with <code>A</code>s version requirement on <code>B</code>.
<ul>
<li>See <a href="#rationale-and-alternatives">Dependency visibility and the resolver</a> for why this is excluded.</li>
</ul>
</li>
<li>Allow mutually exclusive features or overly-constrained version requirements by not requiring private dependencies to be unified.
<ul>
<li>Private dependencies are not sufficient on their own for this</li>
<li>There are likely better alternatives, like <a href="https://internals.rust-lang.org/t/pre-rfc-mutually-excusive-global-features/19618">Pre-RFC: Mutually-exclusive, global features</a></li>
</ul>
</li>
<li>Help check for missing feature declarations by duplicating dependencies, rather than unifying features
<ul>
<li>See <a href="#future-possibilities">Missing feature declaration check</a></li>
</ul>
</li>
</ul>
<h2 id="guide-level-explanation"><a class="header" href="#guide-level-explanation">Guide-level explanation</a></h2>
<p>As a trivial, artificial example:</p>
<pre><code class="language-toml">[package]
name = "diagnostic"
version = "1.0.0"

[dependencies]
serde = { version = "1", features = ["derive"] }
serde_json = "1"
</code></pre>
<pre><code class="language-rust">#[derive(Clone, Debug, PartialEq, Eq, serde::Deserialize, serde::Serialize)]
pub struct Diagnostic {
    code: String,
    message: String,
    file: std::path::PathBuf,
    span: std::ops::Range&lt;usize&gt;,
}

impl std::str::FromStr for Diagnostic {
    type Err = serde_json::Error;

    fn from_str(s: &amp;str) -&gt; Result&lt;Self, Self::Err&gt; {
        serde_json::from_str(s)
    }
}</code></pre>
<p>The dependencies <code>serde</code> and <code>serde_json</code> are both public dependencies, meaning their types are referenced in the public API. This has the implication that a semver incompatible upgrade of these dependencies is a breaking change for this package.</p>
<p>With this RFC, in pre-2024 editions, you can enable add <code>lints.rust.exported_private_dependencies = "warn"</code> to your manifest and rustc will warn saying that <code>serde</code> and <code>serde_json</code> are private dependencies in a public API. In 2024+ editions, this will be an error.</p>
<p>To resolve the warning in a semver compatible way, they would need to declare both dependencies as public:</p>
<pre><code class="language-toml">[package]
name = "diagnostic"
version = "1.0.0"

[dependencies]
serde = { version = "1", features = ["derive"], public = true }
serde_json = { version = "1", public = true }
</code></pre>
<p>For edition migrations, <code>cargo fix</code> will look for the warning code and mark those dependencies as <code>public</code>.</p>
<p>However, for this example, it was an oversight in exposing <code>serde_json</code> in the public API. Note that removing it from the public API is a semver incompatible change.</p>
<pre><code class="language-toml">[package]
name = "diagnostic"
version = "1.0.0"

[dependencies]
serde = { version = "1", features = ["derive"], public = true }
serde_json = "1"
</code></pre>
<pre><code class="language-rust">#[derive(Clone, Debug, PartialEq, Eq, serde::Deserialize, serde::Serialize)]
pub struct Diagnostic {
    code: String,
    message: String,
    file: std::path::PathBuf,
    span: std::ops::Range&lt;usize&gt;,
}

impl std::str::FromStr for Diagnostic {
    type Err = Error

    fn from_str(s: &amp;str) -&gt; Result&lt;Self, Self::Err&gt; {
        serde_json::from_str(s).map_err(Error)
    }
}

pub struct Error(serde_json::Error);</code></pre>
<p>If you then had a public dependency on <code>diagnostic</code>, then <code>serde</code> would automatically be considered a public dependency of yours.</p>
<p>At times, some public dependencies are effectively private. Take this code from older versions of <code>clap</code></p>
<pre><code class="language-rust">#[doc(hidden)]
#[cfg(feature = "derive")]
pub mod __derive_refs {
    #[doc(hidden)]
    pub use once_cell;
}</code></pre>
<p>Since the proc-macro can only guarantee that the namespace <code>clap</code> is accessible, <code>clap</code> must re-export any functionality that is needed at runtime by the generated code. As a last-ditch way of dealing with this, a user may allow the error:</p>
<pre><code class="language-rust">#[doc(hidden)]
#[allow(exported_private_dependencies)]
#[cfg(feature = "derive")]
pub mod __derive_refs {
    #[doc(hidden)]
    pub use once_cell;
}</code></pre>
<p>A similar case is pub-in-private:</p>
<pre><code class="language-rust">mod private {
    #[allow(exported_private_dependencies)]
    pub struct Foo { pub x: some_dependency::SomeType }
}</code></pre>
<p>Though this might be worked around by reducing the visibility to <code>pub(crate)</code>.</p>
<p>I say “last ditch” because in most other cases, a user would be better served by wrapping the API which would be helped with features like <code>impl Trait</code> in type aliases if we had it.</p>
<h2 id="reference-level-explanation"><a class="header" href="#reference-level-explanation">Reference-level explanation</a></h2>
<h3 id="rustc"><a class="header" href="#rustc">rustc</a></h3>
<p>The main change to the compiler will be to accept a new modifier on the <code>--extern</code> flag that Cargo supplies which marks it as a private dependency. The modifier will be called <code>priv</code> (e.g. <code>--extern priv:serde</code>). The compiler then emits the lint <code>exported-private-dependencies</code> if it encounters private dependencies exposed as <code>public</code>.</p>
<p><code>exported-private-dependencies</code> will be <code>allow</code> by default for pre-2024 editions. It will be a member of the <code>rust-2024-compatibility</code> lint group so that it gets automatically picked up by <code>cargo fix --edition</code>. In the 2024 edition, this lint will be <code>deny</code>.</p>
<p>In some situations, it can be necessary to allow private dependencies to become part of the public API. In that case one can permit this with <code>#[allow(exported_private_dependencies)]</code>. This is particularly useful when paired with <code>#[doc(hidden)]</code> and other already existing hacks. This most likely will also be necessary for the more complex relationship of <code>libcore</code> and <code>libstd</code> in Rust itself.</p>
<h3 id="cargo"><a class="header" href="#cargo">cargo</a></h3>
<p>A new dependency field, <code>public = &lt;bool&gt;</code> will be added that defaults to <code>false</code>. This field can be specified in <code>workspace.dependencies</code> and be overridden when <code>workspace = true</code> is in a dependency. When building a <code>lib</code>, Cargo will use the <code>priv</code> modifier with <code>--extern</code> for all private dependencies. What is private is what is left after recursively walking public dependencies (<code>public = true</code>). For other <a href="https://doc.rust-lang.org/cargo/reference/cargo-targets.html#the-crate-type-field"><code>crate-type</code>s</a> (e.g. <code>bin</code>), we’ll tell rustc that all dependencies are public to reduce noise from inaccessible <code>public</code> items.</p>
<p>Cargo will not force a <code>rust-version</code> bump when using this feature as someone building with an old version of cargo depending on packages that set <code>public = true</code> will not start to fail when upgrading to new versions of cargo.</p>
<p><code>cargo add</code> will gain <code>--public &lt;bool&gt;</code> flags to control this field. When adding a dependency today, the version requirement is reused from other dependency tables within your manifest. With this RFC, that will be extended to also checking your dependencies for any <code>public</code> dependencies, and reusing their version requirement. This would be most easily done by having the field in the Index but <code>cargo add</code> could also read the <code>.crate</code> files as a fallback.</p>
<h3 id="cratesio"><a class="header" href="#cratesio">crates.io</a></h3>
<p>Crates.io should show public dependencies more prominently than private ones.</p>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<p>It might not be clear how to resolve the warning/error, as it’s emitted by rustc but is resolved by changing information in the build system, generally, but not always, cargo. As a last resort, we could put a hack in cargo to intercept the lint and emit a new version of it that explains things in terms of cargo.</p>
<p>There are risks with the <code>cargo fix</code> approach as it requires us to take a non-machine applicable lint, parsing out the information we need to identify the corresponding <code>Cargo.toml</code>, and translate it into a change for <code>Cargo.toml</code>.</p>
<p>In the case where you depend on <code>foo = "300"</code>, there isn’t a way to clarify that what is public is actually from <code>foo-core = "1"</code> without explicitly depending on it.</p>
<p>This doesn’t cover the case where a dependency is public only if a feature is enabled.</p>
<p>The warning/error is emitted even when a <code>pub</code> item isn’t accessible. We at least reduced the impact of this by not marking dependencies as private for <code>crate-type=["bin"]</code>.</p>
<p>You can’t definitively lint when a <code>public = true</code> is unused since it may depend on which platform or features.</p>
<h2 id="rationale-and-alternatives"><a class="header" href="#rationale-and-alternatives">Rationale and alternatives</a></h2>
<h3 id="misc"><a class="header" href="#misc">Misc</a></h3>
<ul>
<li><code>Cargo.toml</code>: instead of <code>public</code> (like <a href="https://github.com/rust-lang/rfcs/pull/1977">RFC 1977</a>), we could name the field <code>pub</code> (named after the <a href="https://doc.rust-lang.org/reference/visibility-and-privacy.html">Rust keyword</a>) or name the field <code>visibility = "&lt;public|private&gt;"</code>
<ul>
<li><code>pub</code> has a nice parallel with Rust</li>
<li><code>pub</code>: Cargo doesn’t use abbreviations as much as Rust (though some are used)</li>
<li><code>pub</code> could be seen as ambiguous with <code>publish</code></li>
<li><code>public</code> already is reserved and requires a <code>cargo_features</code>, meaning using it requires an MSRV bump</li>
<li>While <code>visibility</code> would offer greater flexibility, it is unclear if we need that flexibility and if the friction of any feature leveraging it would be worth it</li>
</ul>
</li>
<li><code>rustc</code>: Instead of <code>allow</code> by default for pre-2024 editions, we could warn by default
<ul>
<li>More people would get the benefit of the feature now</li>
<li>However, this would be extremely noisy and likely make people grumpy</li>
<li>If we did this, we’d likely want to not require an MSRV bump so people can immediately silence the warning which would require using a key besides <code>public</code> (since it’s already reserved) and treating the field as an unused key when the <code>-Z</code> isn’t enabled.</li>
</ul>
</li>
<li><code>Cargo.toml</code>: Instead of <code>public = false</code> being the default and changing the warning level on an edition boundary, we could instead start with <code>public = true</code> and change the default on an edition boundary.
<ul>
<li>This would require <code>cargo fix</code> marking all dependencies as <code>public = true</code>, while using the warning means we can limit it to only those dependencies that need it.</li>
</ul>
</li>
<li><code>Cargo.toml</code>: Instead of <code>public = false</code> being the default, we could have a “unchecked” / “unset” state
<ul>
<li>This would require <code>cargo fix</code> marking all dependencies as <code>public = true</code>, while using the warning means we can limit it to only those dependencies that need it.</li>
</ul>
</li>
<li><code>Cargo.toml</code>: In the long term, we decided on the default being <code>public = false</code> as that is the common case and gives us more information than supporting a <code>public = "unchecked"</code> and having that be the long term solution.</li>
<li><code>cargo add</code>: instead of <code>--public &lt;bool&gt;</code> it could be <code>--public</code> / <code>--no-public</code> like <code>--optional</code> or <code>--public</code> / <code>--private</code></li>
<li><code>cargo add</code>: when adding a dependency, we could automatically add all of its <code>public</code> dependencies.
<ul>
<li>This was passed up as being too noisy, especially when dealing with facade crates, those that fully re-export their <code>public = true</code> dependency</li>
</ul>
</li>
<li>We leave whether <code>public</code> is in the Index as unspecified
<ul>
<li>It isn’t strictly needed now</li>
<li>It would make <code>cargo add</code> easier</li>
<li>If we rely on <code>public</code> in the resolver, we might need it but we can always backfill it</li>
<li>Parts of the implementation are already there from the original RFC</li>
</ul>
</li>
</ul>
<h3 id="minimal-version-resolution"><a class="header" href="#minimal-version-resolution">Minimal version resolution</a></h3>
<p><a href="https://github.com/rust-lang/rfcs/pull/1977">RFC 1977</a> included the idea of verifying version requirements are high enough. This is a problem whether the dependency is private or not. This should be handled independent of this RFC.</p>
<h3 id="dependency-visibility-and-the-resolver"><a class="header" href="#dependency-visibility-and-the-resolver">Dependency visibility and the resolver</a></h3>
<p>This is deferred to <a href="#future-possibilities">Future possibilities</a></p>
<ul>
<li>This has been the main hang-up for stabilization over the last 6 years since the RFC was approved
<ul>
<li>For more on the complexity involved, see the thread starting at <a href="https://github.com/rust-lang/rust/issues/44663#issuecomment-881965668">this comment</a></li>
</ul>
</li>
<li>More thought is needed as we found that making a dependency <code>public = true</code> can be a breaking change if the caller also depends on it but with a different semver incompatible version</li>
<li>More thought is needed on what happens if you have multiple versions of a package that are public (via renaming like <code>tokio_03</code> and <code>tokio_1</code>)</li>
</ul>
<p>Related problems potentially blocked on this</p>
<ul>
<li>It is hoped that the resolver change would help with <a href="https://github.com/rust-lang/cargo/issues/9029">cargo#9029</a></li>
<li>If we allow duplication of private semver compatible dependencies, it would help with <a href="https://github.com/rust-lang/cargo/issues/10053">cargo#10053</a></li>
</ul>
<h2 id="prior-art"><a class="header" href="#prior-art">Prior art</a></h2>
<p>Within the cargo ecosystem:</p>
<ul>
<li><a href="https://github.com/davidpdrsn/cargo-public-api-crates">cargo public-api-crates</a></li>
</ul>
<h2 id="unresolved-questions"><a class="header" href="#unresolved-questions">Unresolved questions</a></h2>
<h2 id="future-possibilities"><a class="header" href="#future-possibilities">Future possibilities</a></h2>
<h3 id="help-keep-versions-in-sync"><a class="header" href="#help-keep-versions-in-sync">Help keep versions in-sync</a></h3>
<p>When upgrading one dependency, you might need to upgrade another because you use it to interact with the first, like <code>clap</code> and <code>clap_complete</code>. The existing error messages are not great, along the lines of “expected <code>clap::Command</code>, found <code>clap::Command</code>”. Ideally, you would be presented instead with a message saying “clap_complete 3.4 is not compatible with clap 4.0, try upgrading to clap_complete 4.0”. Even better if we could help users do this upgrade automatically.</p>
<p>As solving this, via the resolver, has been the main sticking point for <a href="https://github.com/rust-lang/rfcs/pull/1977">RFC 1977</a>, this was deferred out to take smaller, more incremental steps, that open the door for more experimentation in the future to understand how best to solve these problems.</p>
<p>Some possible routes:</p>
<h4 id="dependency-visibility-and-the-resolver-1"><a class="header" href="#dependency-visibility-and-the-resolver-1">Dependency visibility and the resolver</a></h4>
<p><a href="https://github.com/rust-lang/rfcs/pull/1977">RFC 1977</a> originally proposed handling this within the resolver</p>
<p>Cargo will specifically reject graphs that contain two different versions of the same crate being publicly depended upon and reachable from each other. This will prevent the strange errors possible today at version resolution time rather than at compile time.</p>
<p>How this will work:</p>
<ul>
<li>First, a resolution graph has a bunch of nodes. These nodes are “package ids” which are a triple of (name, source, version). Basically this means that different versions of the same crate are different nodes, and different sources of the same name (e.g. git and crates.io) are also different nodes.</li>
<li>There are <em>directed edges</em> between nodes. A directed edge represents a dependency. For example if A depends on B then there’s a directed edge from A to B.</li>
<li>With public/private dependencies, we can now say that every edge is either tagged with public or private.</li>
<li>This means that we can have a collection of subgraphs purely connected by public dependency edges. The directionality of the public dependency edges within the subgraph doesn’t matter. Each of these subgraphs represents an “ecosystem” of crates publicly depending on each other. These subgraphs are “pools of public types” where if you have access to the subgraph, you have access to all types within that pool of types.</li>
<li>We can place a constraint that each of these “publicly connected subgraphs” are required to have exactly one version of all crates internally. For example, each subgraph can only have one version of Hyper.</li>
<li>Finally, we can consider all pairs of edges coming out of one node in the resolution graph. If the two edges point to <em>two distinct publicly connected subgraphs from above</em> and those subgraphs contain two different versions of the same crate, we consider that an error. This basically means that if you privately depend on Hyper 0.3 and Hyper 0.4, that’s an error.</li>
</ul>
<p>If we want to go this route, some hurdles to overcome include:</p>
<ul>
<li>Difficulties in working with cargo’s resolver as this has been the main hang-up for stabilization over the last 6 years since the <a href="https://github.com/rust-lang/rfcs/pull/1977">RFC 1977</a> was approved
<ul>
<li>For more on the complexity involved, see the thread starting at <a href="https://github.com/rust-lang/rust/issues/44663#issuecomment-881965668">this comment</a></li>
</ul>
</li>
<li>More thought is needed as we found that making a dependency <code>public = true</code> can be a breaking change if the caller also depends on it but with a different semver incompatible version</li>
<li>More thought is needed on what happens if you have multiple versions of a package that are public (via renaming like <code>tokio_03</code> and <code>tokio_1</code>)</li>
</ul>
<h4 id="caller-declared-relations"><a class="header" href="#caller-declared-relations">Caller-declared relations</a></h4>
<p>As an alternative, when declaring dependencies, a user could <a href="https://github.com/rust-lang/cargo/issues/4641">explicitly delegate the version requirement to another package</a></p>
<p>One possible approach for this:</p>
<pre><code class="language-toml">[package]
name = "some-cli"

[dependencies]
clap = { from = ["clap_complete", "clap_mangen"] }
clap_complete = "3.4"
clap_mangen = "3.4"
</code></pre>
<p>When resolving the dependencies for <code>some-cli</code>, the resolver will not explicitly choose a version for <code>clap</code> but will continue resolving the graph. Upon completion, it will look to see what instance of <code>clap_complete</code> was resolved and act as if that was what was specified inside of the in-memory <code>clap</code> dependency.</p>
<p>The package using <code>from</code> must be a public dependency of the <code>from</code> package. In this case, <code>clap</code> must be a public dependency of <code>clap_complete</code>. If the different packages in <code>from</code> do not agree on what the package version should resolve to (clap 3.4 vs clap 4.0), then it is an error.</p>
<p>Compared to the resolver doing this implicitly</p>
<ul>
<li>It is unclear if this would be any more difficult to implement in the resolver</li>
<li>Changing a dependency from <code>public = false</code> to <code>public = true</code> is backwards compatible because it has no effect on existing callers.</li>
<li>It is unclear how this would handle multiple versions of a package that are public</li>
</ul>
<p>The downside is it feels like the declaration is backwards. If you have one core crate (e.g. <code>clap</code>) and many crates branching off (e.g. <code>clap_complete</code>, <code>clap_mangen</code>), it seems like those helper crates should have their version picked from <code>clap</code>. This can be worked around by publishing a <code>clap_distribution</code> package that has dependencies on every package. Users would depend on <code>clap_distribution</code> through a never-matching target-dependency so it doesn’t affect builds. It exists so users would <code>version.from = ["clap_distribution"]</code> it, keeping the set in sync. This only helps when the packages are managed by a single project.</p>
<p>Whether this should be specified across all sources (<code>from</code>) or per source (<code>registry.from</code>, <code>git.from</code>, <code>path.from</code>) will need to be worked out. See <a href="https://github.com/rust-lang/cargo/issues/6921">rust-lang/cargo#6921</a> for an example of using this for git dependencies.</p>
<h3 id="missing-feature-declaration-check"><a class="header" href="#missing-feature-declaration-check">Missing feature declaration check</a></h3>
<p>It is easy for packages to accidentally rely on a dependency enabling a feature for them. We could add a mode that limits feature unification to reachable dependencies, forcing duplication and longer builds for the sake of checking if any features need specifying.</p>
<p>However, this will still likely miss a lot of cases, making the pay off questionable. This also has the risk of being abused as a workaround so people can use mutually exclusive features. If packages start relying on it, it could coerce callers into abusing this mechanism, having a cascading effect in the ecosystem in the wrong direction.</p>
<h3 id="warn-about-semver-incompatible-public-dependency"><a class="header" href="#warn-about-semver-incompatible-public-dependency">Warn about semver incompatible public dependency</a></h3>
<p><code>cargo update</code> (or a manifest linter) could warn about public new incompatible public dependencies that are available to help the ecosystem progress in lockstep.</p>
<h3 id="warn-about-pre-10-public-dependencies-in-10-packages"><a class="header" href="#warn-about-pre-10-public-dependencies-in-10-packages">Warn about pre-1.0 public dependencies in 1.0+ packages</a></h3>
<p>See <a href="https://github.com/rust-lang/cargo/issues/6018">rust-lang/cargo#6018</a></p>
<h3 id="flag-for-cargo-doc-to-skip-inaccessible-dependencies"><a class="header" href="#flag-for-cargo-doc-to-skip-inaccessible-dependencies">Flag for <code>cargo doc</code> to skip inaccessible dependencies</a></h3>
<p>When building documentation for local development, a lot of times only the direct dependencies and their public dependencies are relevant but you can get stuck generating documentation for large dependencies (<a href="https://github.com/rust-lang/cargo/issues/4049">rust-lang/cargo#4049</a>). Instead, <code>cargo doc</code> could have a flag to skip any of the dependencies that aren’t relevant to local development which are private transitive dependencies. See <a href="https://github.com/rust-lang/cargo/issues/2025">rust-lang/cargo#2025</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="3514-float-semantics.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="3519-arbitrary-self-types-v2.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="3514-float-semantics.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="3519-arbitrary-self-types-v2.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
