<!DOCTYPE HTML>
<html lang="zh_CN" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>1522-conservative-impl-trait - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-b61d75f0.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: conservative_impl_trait</li>
<li>Start Date: 2016-01-31</li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/1522">rust-lang/rfcs#1522</a></li>
<li>Rust Issue: <a href="https://github.com/rust-lang/rust/issues/34511">rust-lang/rust#34511</a></li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Add a conservative form of abstract return types, also known as <code>impl Trait</code>, that will be compatible with most possible future extensions by initially being restricted to:</p>
<ul>
<li>Only free-standing or inherent functions.</li>
<li>Only return type position of a function.</li>
</ul>
<p>Abstract return types allow a function to hide a concrete return type behind a trait interface similar to trait objects, while still generating the same statically dispatched code as with concrete types.</p>
<p>With the placeholder syntax used in discussions so far, abstract return types would be used roughly like this:</p>
<pre><code class="language-rust">fn foo(n: u32) -&gt; impl Iterator&lt;Item = u32&gt; {
    (0..n).map(|x| x * 100)
}
// ^ behaves as if it had return type Map&lt;Range&lt;u32&gt;, Closure&gt;
// where Closure = type of the |x| x * 100 closure.

for x in foo(10) {
    // x = 0, 100, 200, ...
}</code></pre>
<h2 id="background"><a class="header" href="#background">Background</a></h2>
<p>There has been much discussion around the <code>impl Trait</code> feature already, with different proposals extending the core idea into different directions:</p>
<ul>
<li>The <a href="https://github.com/rust-lang/rfcs/pull/105">original proposal</a>.</li>
<li>A <a href="http://aturon.github.io/blog/2015/09/28/impl-trait/">blog post</a> reviving the proposal and further exploring the design space.</li>
<li>A <a href="https://github.com/rust-lang/rfcs/pull/1305">more recent proposal</a> with a substantially more ambitious scope.</li>
</ul>
<p>This RFC is an attempt to make progress on the feature by proposing a minimal subset that should be forwards-compatible with a whole range of extensions that have been discussed (and will be reviewed in this RFC). However, even this small step requires resolving some of the core questions raised in <a href="http://aturon.github.io/blog/2015/09/28/impl-trait/">the blog post</a>.</p>
<p>This RFC is closest in spirit to the <a href="https://github.com/rust-lang/rfcs/pull/105">original RFC</a>, and we’ll repeat its motivation and some other parts of its text below.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<blockquote>
<p>Why are we doing this? What use cases does it support? What is the expected outcome?</p>
</blockquote>
<p>In today’s Rust, you can write a function signature like</p>
<pre><code class="language-rust">fn consume_iter_static&lt;I: Iterator&lt;Item = u8&gt;&gt;(iter: I)
fn consume_iter_dynamic(iter: Box&lt;Iterator&lt;Item = u8&gt;&gt;)</code></pre>
<p>In both cases, the function does not depend on the exact type of the argument. The type is held “abstract”, and is assumed only to satisfy a trait bound.</p>
<ul>
<li>
<p>In the <code>_static</code> version using generics, each use of the function is specialized to a concrete, statically-known type, giving static dispatch, inline layout, and other performance wins.</p>
</li>
<li>
<p>In the <code>_dynamic</code> version using trait objects, the concrete argument type is only known at runtime using a vtable.</p>
</li>
</ul>
<p>On the other hand, while you can write</p>
<pre><code class="language-rust">fn produce_iter_dynamic() -&gt; Box&lt;Iterator&lt;Item = u8&gt;&gt;</code></pre>
<p>you <em>cannot</em> write something like</p>
<pre><code class="language-rust">fn produce_iter_static() -&gt; Iterator&lt;Item = u8&gt;</code></pre>
<p>That is, in today’s Rust, abstract return types can only be written using trait objects, which can be a significant performance penalty. This RFC proposes “unboxed abstract types” as a way of achieving signatures like <code>produce_iter_static</code>. Like generics, unboxed abstract types guarantee static dispatch and inline data layout.</p>
<p>Here are some problems that unboxed abstract types solve or mitigate:</p>
<ul>
<li>
<p><em>Returning unboxed closures</em>. Closure syntax generates an anonymous type implementing a closure trait. Without unboxed abstract types, there is no way to use this syntax while returning the resulting closure unboxed because there is no way to write the name of the generated type.</p>
</li>
<li>
<p><em>Leaky APIs</em>. Functions can easily leak implementation details in their return type, when the API should really only promise a trait bound. For example, a function returning <code>Rev&lt;Splits&lt;'a, u8&gt;&gt;</code> is revealing exactly how the iterator is constructed, when the function should only promise that it returns <em>some</em> type implementing <code>Iterator&lt;Item = u8&gt;</code>. Using newtypes/structs with private fields helps, but is extra work. Unboxed abstract types make it as easy to promise only a trait bound as it is to return a concrete type.</p>
</li>
<li>
<p><em>Complex types</em>. Use of iterators in particular can lead to huge types:</p>
<pre><code class="language-rust">Chain&lt;Map&lt;'a, (i32, u8), u16, Enumerate&lt;Filter&lt;'a, u8, vec::MoveItems&lt;u8&gt;&gt;&gt;&gt;, SkipWhile&lt;'a, u16, Map&lt;'a, &amp;u16, u16, slice::Items&lt;u16&gt;&gt;&gt;&gt;</code></pre>
<p>Even when using newtypes to hide the details, the type still has to be written out, which can be very painful. Unboxed abstract types only require writing the trait bound.</p>
</li>
<li>
<p><em>Documentation</em>. In today’s Rust, reading the documentation for the <code>Iterator</code> trait is needlessly difficult. Many of the methods return new iterators, but currently each one returns a different type (<code>Chain</code>, <code>Zip</code>, <code>Map</code>, <code>Filter</code>, etc), and it requires drilling down into each of these types to determine what kind of iterator they produce.</p>
</li>
</ul>
<p>In short, unboxed abstract types make it easy for a function signature to promise nothing more than a trait bound, and do not generally require the function’s author to write down the concrete type implementing the bound.</p>
<h2 id="detailed-design"><a class="header" href="#detailed-design">Detailed design</a></h2>
<p>As explained at the start of the RFC, the focus here is a relatively narrow introduction of abstract types limited to the return type of inherent methods and free functions. While we still need to resolve some of the core questions about what an “abstract type” means even in these cases, we avoid some of the complexities that come along with allowing the feature in other locations or with other extensions.</p>
<h3 id="syntax"><a class="header" href="#syntax">Syntax</a></h3>
<p>Let’s start with the bikeshed: The proposed syntax is <code>impl Trait</code> in return type position, composing like trait objects to forms like <code>impl Foo + Send + 'a</code>.</p>
<p>It can be explained as “a type that implements <code>Trait</code>”, and has been used in that form in most earlier discussions and proposals.</p>
<p>Initial versions of this RFC proposed <code>@Trait</code> for brevity reasons, since the feature is supposed to be used commonly once implemented, but due to strong negative reactions by the community this has been changed back to the current form.</p>
<p>There are other possibilities, like <code>abstract Trait</code> or <code>~Trait</code>, with good reasons for or against them, but since the concrete choice of syntax is not a blocker for the implementation of this RFC, it is intended for a possible follow-up RFC to address syntax changes if needed.</p>
<h3 id="semantics"><a class="header" href="#semantics">Semantics</a></h3>
<p>The core semantics of the feature is described below.</p>
<p>Note that the sections after this one go into more detail on some of the design decisions, and that <strong>it is likely for many of the mentioned limitations to be lifted at some point in the future</strong>. For clarity, we’ll separately categorize the <em>core semantics</em> of the feature (aspects that would stay unchanged with future extensions) and the <em>initial limitations</em> (which are likely to be lifted later).</p>
<p><strong>Core semantics</strong>:</p>
<ul>
<li>
<p>If a function returns <code>impl Trait</code>, its body can return values of any type that implements <code>Trait</code>, but all return values need to be of the same type.</p>
</li>
<li>
<p>As far as the typesystem and the compiler is concerned, the return type outside of the function would not be a entirely “new” type, nor would it be a simple type alias. Rather, its semantics would be very similar to that of <em>generic type parameters</em> inside a function, with small differences caused by being an <em>output</em> rather than an <em>input</em> of the function.</p>
<ul>
<li>The type would be known to implement the specified traits.</li>
<li>The type would not be known to implement any other trait, with the exception of OIBITS (aka “auto traits”) and default traits like <code>Sized</code>.</li>
<li>The type would not be considered equal to the actual underlying type.</li>
<li>The type would not be allowed to appear as the <code>Self</code> type for an <code>impl</code> block.</li>
</ul>
</li>
<li>
<p>Because OIBITS like <code>Send</code> and <code>Sync</code> will leak through an abstract return type, there will be some additional complexity in the compiler due to some non-local type checking becoming necessary.</p>
</li>
<li>
<p>The return type has an identity based on all generic parameters the function body is parameterized by, and by the location of the function in the module system. This means type equality behaves like this:</p>
<pre><code class="language-rust">fn foo&lt;T: Trait&gt;(t: T) -&gt; impl Trait {
    t
}

fn bar() -&gt; impl Trait {
    123
}

fn equal_type&lt;T&gt;(a: T, b: T) {}

equal_type(bar(), bar());                      // OK
equal_type(foo::&lt;i32&gt;(0), foo::&lt;i32&gt;(0));      // OK
equal_type(bar(), foo::&lt;i32&gt;(0));              // ERROR, `impl Trait {bar}` is not the same type as `impl Trait {foo&lt;i32&gt;}`
equal_type(foo::&lt;bool&gt;(false), foo::&lt;i32&gt;(0)); // ERROR, `impl Trait {foo&lt;bool&gt;}` is not the same type as `impl Trait {foo&lt;i32&gt;}`</code></pre>
</li>
<li>
<p>The code generation passes of the compiler would not draw a distinction between the abstract return type and the underlying type, just like they don’t for generic parameters. This means:</p>
<ul>
<li>The same trait code would be instantiated, for example, <code>-&gt; impl Any</code> would return the type id of the underlying type.
<ul>
<li>Specialization would specialize based on the underlying type.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Initial limitations</strong>:</p>
<ul>
<li>
<p><code>impl Trait</code> may only be written within the return type of a freestanding or inherent-impl function, not in trait definitions or any non-return type position. They may also not appear in the return type of closure traits or function pointers, unless these are themselves part of a legal return type.</p>
<ul>
<li>Eventually, we will want to allow the feature to be used within traits, and likely in argument position as well (as an ergonomic improvement over today’s generics).</li>
<li>Using <code>impl Trait</code> multiple times in the same return type would be valid, like for example in <code>-&gt; (impl Foo, impl Bar)</code>.</li>
</ul>
</li>
<li>
<p>The type produced when a function returns <code>impl Trait</code> would be effectively unnameable, just like closures and function items.</p>
<ul>
<li>We will almost certainly want to lift this limitation in the long run, so that abstract return types can be placed into structs and so on. There are a few ways we could do so, all related to getting at the “output type” of a function given all of its generic arguments.</li>
</ul>
</li>
<li>
<p>The function body cannot see through its own return type, so code like this would be forbidden just like on the outside:</p>
<pre><code class="language-rust">fn sum_to(n: u32) -&gt; impl Display {
    if n == 0 {
        0
    } else {
        n + sum_to(n - 1)
    }
}</code></pre>
<ul>
<li>It’s unclear whether we’ll want to lift this limitation, but it should be possible to do so.</li>
</ul>
</li>
</ul>
<h3 id="rationale"><a class="header" href="#rationale">Rationale</a></h3>
<h4 id="why-these-semantics-for-the-return-type"><a class="header" href="#why-these-semantics-for-the-return-type">Why these semantics for the return type?</a></h4>
<p>There has been a lot of discussion about what the semantics of the return type should be, with the theoretical extremes being “full return type inference” and “fully abstract type that behaves like a autogenerated newtype wrapper”. (This was in fact the main focus of the <a href="http://aturon.github.io/blog/2015/09/28/impl-trait/">blog post</a> on <code>impl Trait</code>.)</p>
<p>The design as chosen in this RFC lies somewhat in between those two, since it allows OIBITs to leak through, and allows specialization to “see” the full type being returned. That is, <code>impl Trait</code> does not attempt to be a “tightly sealed” abstraction boundary. The rationale for this design is a mixture of pragmatics and principles.</p>
<h5 id="specialization-transparency"><a class="header" href="#specialization-transparency">Specialization transparency</a></h5>
<p><strong>Principles for specialization transparency</strong>:</p>
<p>The <a href="https://github.com/rust-lang/rfcs/pull/1210">specialization RFC</a> has given us a basic principle for how to understand bounds in function generics: they represent a <em>minimum</em> contract between the caller and the callee, in that the caller must meet at least those bounds, and the callee must be prepared to work with any type that meets at least those bounds. However, with specialization, the callee may choose different behavior when additional bounds hold.</p>
<p>This RFC abides by a similar interpretation for return types: the signature represents the minimum bound that the callee must satisfy, and the caller must be prepared to work with any type that meets at least that bound. Again, with specialization, the caller may dispatch on additional type information beyond those bounds.</p>
<p>In other words, to the extent that returning <code>impl Trait</code> is intended to be symmetric with taking a generic <code>T: Trait</code>, transparency with respect to specialization maintains that symmetry.</p>
<p><strong>Pragmatics for specialization transparency</strong>:</p>
<p>The practical reason we want <code>impl Trait</code> to be transparent to specialization is the same as the reason we want specialization in the first place: to be able to break through abstractions with more efficient special-case code.</p>
<p>This is particularly important for one of the primary intended usecases: returning <code>impl Iterator</code>. We are very likely to employ specialization for various iterator types, and making the underlying return type invisible to specialization would lose out on those efficiency wins.</p>
<h5 id="oibit-transparency"><a class="header" href="#oibit-transparency">OIBIT transparency</a></h5>
<p>OIBITs leak through an abstract return type. This might be considered controversial, since it effectively opens a channel where the result of function-local type inference affects item-level API, but has been deemed worth it for the following reasons:</p>
<ul>
<li>
<p>Ergonomics: Trait objects already have the issue of explicitly needing to declare <code>Send</code>/<code>Sync</code>-ability, and not extending this problem to abstract return types is desirable. In practice, most uses of this feature would have to add explicit bounds for OIBITS if they wanted to be maximally usable.</p>
</li>
<li>
<p>Low real change, since the situation already somewhat exists on structs with private fields:</p>
<ul>
<li>In both cases, a change to the private implementation might change whether a OIBIT is implemented or not.</li>
<li>In both cases, the existence of OIBIT impls is not visible without documentation tools</li>
<li>In both cases, you can only assert the existence of OIBIT impls by adding explicit trait bounds either to the API or to the crate’s test suite.</li>
</ul>
</li>
</ul>
<p>In fact, a large part of the point of OIBITs in the first place was to cut across abstraction barriers and provide information about a type without the type’s author having to explicitly opt in.</p>
<p>This means, however, that it has to be considered a silent breaking change to change a function with an abstract return type in a way that removes OIBIT impls, which might be a problem. (As noted above, this is already the case for <code>struct</code> definitions.)</p>
<p>But since the number of used OIBITs is relatively small, deducing the return type in a function body and reasoning about whether such a breakage will occur has been deemed as a manageable amount of work.</p>
<h5 id="wherefore-type-abstraction"><a class="header" href="#wherefore-type-abstraction">Wherefore type abstraction?</a></h5>
<p>In the <a href="https://github.com/rust-lang/rfcs/pull/1305">most recent RFC</a> related to this feature, a more “tightly sealed” abstraction mechanism was proposed. However, part of the discussion on specialization centered on precisely the issue of what type abstraction provides and how to achieve it.  A particular salient point there is that, in Rust, <em>privacy</em> is already our primary mechanism for hiding (<a href="https://github.com/rust-lang/rfcs/pull/1210#issuecomment-181992044">“privacy is the new parametricity”</a>). In practice, that means that if you want opacity against specialization, you should use something like a newtype.</p>
<h4 id="anonymity"><a class="header" href="#anonymity">Anonymity</a></h4>
<p>An abstract return type cannot be named in this proposal, which means that it cannot be placed into <code>structs</code> and so on. This is not a fundamental limitation in any sense; the limitation is there both to keep this RFC simple, and because the precise way we might want to allow naming of such types is still a bit unclear. Some possibilities include a <code>typeof</code> operator, or explicit named abstract types.</p>
<h4 id="limitation-to-only-return-type-position"><a class="header" href="#limitation-to-only-return-type-position">Limitation to only return type position</a></h4>
<p>There have been various proposed additional places where abstract types might be usable. For example, <code>fn x(y: impl Trait)</code> as shorthand for <code>fn x&lt;T: Trait&gt;(y: T)</code>.</p>
<p>Since the exact semantics and user experience for these locations are yet unclear (<code>impl Trait</code> would effectively behave completely different before and after the <code>-&gt;</code>), this has also been excluded from this proposal.</p>
<h4 id="type-transparency-in-recursive-functions"><a class="header" href="#type-transparency-in-recursive-functions">Type transparency in recursive functions</a></h4>
<p>Functions with abstract return types can not see through their own return type, making code like this not compile:</p>
<pre><code class="language-rust">fn sum_to(n: u32) -&gt; impl Display {
    if n == 0 {
        0
    } else {
        n + sum_to(n - 1)
    }
}</code></pre>
<p>This limitation exists because it is not clear how much a function body can and should know about different instantiations of itself.</p>
<p>It would be safe to allow recursive calls if the set of generic parameters is identical, and it might even be safe if the generic parameters are different, since you would still be inside the private body of the function, just differently instantiated.</p>
<p>But variance caused by lifetime parameters and the interaction with specialization makes it uncertain whether this would be sound.</p>
<p>In any case, it can be initially worked around by defining a local helper function like this:</p>
<pre><code class="language-rust">fn sum_to(n: u32) -&gt; impl Display {
    fn sum_to_(n: u32) -&gt; u32 {
        if n == 0 {
            0
        } else {
            n + sum_to_(n - 1)
        }
    }
    sum_to_(n)
}</code></pre>
<h4 id="not-legal-in-function-pointersclosure-traits"><a class="header" href="#not-legal-in-function-pointersclosure-traits">Not legal in function pointers/closure traits</a></h4>
<p>Because <code>impl Trait</code> defines a type tied to the concrete function body, it does not make much sense to talk about it separately in a function signature, so the syntax is forbidden there.</p>
<h4 id="compatibility-with-conditional-trait-bounds"><a class="header" href="#compatibility-with-conditional-trait-bounds">Compatibility with conditional trait bounds</a></h4>
<p>One valid critique for the existing <code>impl Trait</code> proposal is that it does not cover more complex scenarios where the return type would implement one or more traits depending on whether a type parameter does so with another.</p>
<p>For example, an iterator adapter might want to implement <code>Iterator</code> and <code>DoubleEndedIterator</code>, depending on whether the adapted one does:</p>
<pre><code class="language-rust">fn skip_one&lt;I&gt;(i: I) -&gt; SkipOne&lt;I&gt; { ... }
struct SkipOne&lt;I&gt; { ... }
impl&lt;I: Iterator&gt; Iterator for SkipOne&lt;I&gt; { ... }
impl&lt;I: DoubleEndedIterator&gt; DoubleEndedIterator for SkipOne&lt;I&gt; { ... }</code></pre>
<p>Using just <code>-&gt; impl Iterator</code>, this would not be possible to reproduce.</p>
<p>Since there have been no proposals so far that would address this in a way that would conflict with the fixed-trait-set case, this RFC punts on that issue as well.</p>
<h4 id="limitation-to-freeinherent-functions"><a class="header" href="#limitation-to-freeinherent-functions">Limitation to free/inherent functions</a></h4>
<p>One important usecase of abstract return types is to use them in trait methods.</p>
<p>However, there is an issue with this, namely that in combinations with generic trait methods, they are effectively equivalent to higher kinded types. Which is an issue because Rust’s HKT story is not yet figured out, so any “accidental implementation” might cause unintended fallout.</p>
<p>HKT allows you to be generic over a type constructor, a.k.a. a “thing with type parameters”, and then instantiate them at some later point to get the actual type. For example, given a HK type <code>T</code> that takes one type as parameter, you could write code that uses <code>T&lt;u32&gt;</code> or <code>T&lt;bool&gt;</code> without caring about whether <code>T = Vec</code>, <code>T = Box</code>, etc.</p>
<p>Now if we look at abstract return types, we have a similar situation:</p>
<pre><code class="language-rust">trait Foo {
    fn bar&lt;U&gt;() -&gt; impl Baz
}</code></pre>
<p>Given a <code>T: Foo</code>, we could instantiate <code>T::bar::&lt;u32&gt;</code> or <code>T::bar::&lt;bool&gt;</code>, and could get arbitrary different return types of <code>bar</code> instantiated with a <code>u32</code> or <code>bool</code>, just like <code>T&lt;u32&gt;</code> and <code>T&lt;bool&gt;</code> might give us <code>Vec&lt;u32&gt;</code> or <code>Box&lt;bool&gt;</code> in the example above.</p>
<p>The problem does not exist with trait method return types today because they are concrete:</p>
<pre><code class="language-rust">trait Foo {
    fn bar&lt;U&gt;() -&gt; X&lt;U&gt;
}</code></pre>
<p>Given the above code, there is no way for <code>bar</code> to choose a return type <code>X</code> that could fundamentally differ between instantiations of <code>Self</code> while still being instantiable with an arbitrary <code>U</code>.</p>
<p>At most you could return a associated type, but then you’d lose the generics from <code>bar</code></p>
<pre><code class="language-rust">trait Foo {
    type X;
    fn bar&lt;U&gt;() -&gt; Self::X // No way to apply U
}</code></pre>
<p>So, in conclusion, since Rust’s HKT story is not yet fleshed out, and the compatibility of the current compiler with it is unknown, it is not yet possible to reach a concrete solution here.</p>
<p>In addition to that, there are also different proposals as to whether an abstract return type is its own thing or sugar for a associated type, how it interacts with other associated items and so on, so forbidding them in traits seems like the best initial course of action.</p>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<blockquote>
<p>Why should we <em>not</em> do this?</p>
</blockquote>
<h3 id="drawbacks-due-to-the-proposals-minimalism"><a class="header" href="#drawbacks-due-to-the-proposals-minimalism">Drawbacks due to the proposal’s minimalism</a></h3>
<p>As has been elaborated on above, there are various way this feature could be extended and combined with the language, so implementing it might cause issues down the road if limitations or incompatibilities become apparent. However, variations of this RFC’s proposal have been under discussion for quite a long time at this point, and this proposal is carefully designed to be future-compatible with them, while resolving the core issue around transparency.</p>
<p>A drawback of limiting the feature to return type position (and not arguments) is that it creates a somewhat inconsistent mental model: it forces you to understand the feature in a highly special-cased way, rather than as a general way to talk about unknown-but-bounded types in function signatures. This could be particularly bewildering to newcomers, who must choose between <code>T: Trait</code>, <code>Box&lt;Trait&gt;</code>, and <code>impl Trait</code>, with the latter only usable in one place.</p>
<h3 id="drawbacks-due-to-partial-transparency"><a class="header" href="#drawbacks-due-to-partial-transparency">Drawbacks due to partial transparency</a></h3>
<p>The fact that specialization and OIBITs can “see through” <code>impl Trait</code> may be surprising, to the extent that one wants to see <code>impl Trait</code> as an abstraction mechanism. However, as the RFC argued in the rationale section, this design is probably the most consistent with our existing post-specialization abstraction mechanisms, and lead to the relatively simple story that <em>privacy</em> is the way to achieve hiding in Rust.</p>
<h2 id="alternatives"><a class="header" href="#alternatives">Alternatives</a></h2>
<blockquote>
<p>What other designs have been considered? What is the impact of not doing this?</p>
</blockquote>
<p>See the links in the motivation section for detailed analysis that we won’t repeat here.</p>
<p>But basically, without this feature certain things remain hard or impossible to do in Rust, like returning a efficiently usable type parameterized by types private to a function body, for example an iterator adapter containing a closure.</p>
<h2 id="unresolved-questions"><a class="header" href="#unresolved-questions">Unresolved questions</a></h2>
<blockquote>
<p>What parts of the design are still to be determined?</p>
</blockquote>
<p>The precise implementation details for OIBIT transparency are a bit unclear: in general, it means that type checking may need to proceed in a particular order, since you cannot get the full type information from the signature alone (you have to typecheck the function body to determine which OIBITs apply).</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="1521-copy-clone-semantics.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="1525-cargo-workspace.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="1521-copy-clone-semantics.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="1525-cargo-workspace.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
