<!DOCTYPE HTML>
<html lang="en_US" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>2394-async_await - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-0060737d.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: async_await</li>
<li>Start Date: 2018-03-30</li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/2394">rust-lang/rfcs#2394</a></li>
<li>Rust Issues:
<ul>
<li><a href="https://github.com/rust-lang/rust/issues/50547">rust-lang/rust#50547</a></li>
<li><a href="https://github.com/rust-lang/rust/issues/62290">rust-lang/rust#62290</a> - #!feature(async_closure)</li>
</ul>
</li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Add async &amp; await syntaxes to make it more ergonomic to write code manipulating
futures.</p>
<p>This has <a href="2592-futures.html">a companion RFC</a> to add a small futures API to libstd and libcore.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>High performance network services frequently use asynchronous IO, rather than
blocking IO, because it can be easier to get optimal performance when handling
many concurrent connections. Rust has seen some adoption in the network
services space, and we wish to continue to enable those users - and to enable
adoption by other users - by making it more ergonomic to write asynchronous
network services in Rust.</p>
<p>The development of asynchronous IO in Rust has gone through multiple phases.
Prior to 1.0, we experimented with having a green-threading runtime built into
the language. However, this proved too opinionated - because it impacted every
program written in Rust - and it was removed shortly before 1.0. After 1.0,
asynchronous IO initially focused around the mio library, which provided a
cross-platform abstraction over the async IO primitives of Linux, Mac OS, and
Windows. In mid-2016, the introduction of the futures crate had a major impact
by providing a convenient, shared abstraction for asynchronous operations. The
tokio library provided a mio-based event loop that could execute code
implemented using the futures interfaces.</p>
<p>After gaining experience &amp; user feedback with the futures-based ecosystem, we
discovered certain ergonomics challenges. Using state which needs to be shared
across await points was extremely unergonomic - requiring either Arcs or join
chaining - and while combinators were often more ergonomic than manually
writing a future, they still often led to messy sets of nested and chained
callbacks.</p>
<p>Fortunately, the Future abstraction is well suited to use with a syntactic
sugar which has become common in many languages with async IO - the async and
await keywords. In brief, an asynchronous function returns a future, rather
than evaluating immediately when it is called. Inside the function, other
futures can be awaited using an await expression, which causes them to yield
control while the future is being polled. From a user’s perspective, they can
use async/await as if it were synchronous code, and only need to annotate their
functions and calls.</p>
<p>Async/await &amp; futures can be a powerful abstraction for asynchronicity and
concurrency in general, and likely has applications outside of the asynchronous
IO space. The use cases we’ve experience with today are generally tied to async
IO, but by introducing first class syntax and libstd support we believe more
use cases for async &amp; await will also flourish, that are not tied directly to
asynchronous IO.</p>
<h2 id="guide-level-explanation"><a class="header" href="#guide-level-explanation">Guide-level explanation</a></h2>
<h3 id="async-functions"><a class="header" href="#async-functions">Async functions</a></h3>
<p>Functions can be annotated with the <code>async</code> keyword, making them “async
functions”:</p>
<pre><code class="language-rust">async fn function(argument: &amp;str) -&gt; usize {
     // ...
}</code></pre>
<p>Async functions work differently from normal functions. When an async function
is called, it does not enter the body immediately. Instead, it evaluates to an
anonymous type which implements <code>Future</code>. As that future is polled, the
function is evaluated up to the next <code>await</code> or return point inside of it (see
the await syntax section next).</p>
<p>An async function is a kind of delayed computation - nothing in the body of the
function actually runs until you begin polling the future returned by the
function. For example:</p>
<pre><code class="language-rust">async fn print_async() {
     println!("Hello from print_async")
}

fn main() {
     let future = print_async();
     println!("Hello from main");
     futures::executor::block_on(future);
}</code></pre>
<p>This will print <code>"Hello from main"</code> before printing <code>"Hello from print_async"</code>.</p>
<p>An <code>async fn foo(args..) -&gt; T</code> is a function of the type
<code>fn(args..) -&gt; impl Future&lt;Output = T&gt;</code>. The return type is an anonymous type
generated by the compiler.</p>
<h4 id="async--closures"><a class="header" href="#async--closures"><code>async ||</code> closures</a></h4>
<p>In addition to functions, async can also be applied to closures. Like an async
function, an async closure has a return type of <code>impl Future&lt;Output = T&gt;</code>, rather
than <code>T</code>. When you call that closure, it returns a future immediately without
evaluating any of the body (just like an async function).</p>
<pre><code class="language-rust">fn main() {
    let closure = async || {
         println!("Hello from async closure.");
    };
    println!("Hello from main");
    let future = closure();
    println!("Hello from main again");
    futures::block_on(future);
}</code></pre>
<p>This will print both “Hello from main” statements before printing “Hello from
async closure.”</p>
<p><code>async</code> closures can be annotated with <code>move</code> to capture ownership of the
variables they close over.</p>
<h3 id="async-blocks"><a class="header" href="#async-blocks"><code>async</code> blocks</a></h3>
<p>You can create a future directly as an expression using an <code>async</code> block:</p>
<pre><code class="language-rust">let my_future = async {
    println!("Hello from an async block");
};</code></pre>
<p>This form is almost equivalent to an immediately-invoked <code>async</code> closure.
That is:</p>
<pre><code class="language-rust">async { /* body */ }

// is equivalent to

(async || { /* body */ })()</code></pre>
<p>except that control-flow constructs like <code>return</code>, <code>break</code> and <code>continue</code> are
not allowed within <code>body</code> (unless they appear within a fresh control-flow
context like a closure or a loop). How the <code>?</code>-operator and early returns
should work inside async blocks has not yet been established (see unresolved
questions).</p>
<p>As with <code>async</code> closures, <code>async</code> blocks can be annotated with <code>move</code> to capture
ownership of the variables they close over.</p>
<h3 id="the-await-compiler-built-in"><a class="header" href="#the-await-compiler-built-in">The <code>await!</code> compiler built-in</a></h3>
<p>A builtin called <code>await!</code> is added to the compiler. <code>await!</code> can be used to
“pause” the computation of the future, yielding control back to the caller.
<code>await!</code> takes any expression which implements <code>IntoFuture</code>, and evaluates to a
value of the item type that that future has.</p>
<pre><code class="language-rust">// future: impl Future&lt;Output = usize&gt;
let n = await!(future);</code></pre>
<p>The expansion of await repeatedly calls <code>poll</code> on the future it receives,
yielding control of the function when it returns <code>Poll::Pending</code> and
eventually evaluating to the item value when it returns <code>Poll::Ready</code>.</p>
<p><code>await!</code> can only be used inside of an async function, closure, or block.
Using it outside of that context is an error.</p>
<p>(<code>await!</code> is a compiler built-in to leave space for deciding its exact syntax
later. See more information in the unresolved questions section.)</p>
<h2 id="reference-level-explanation"><a class="header" href="#reference-level-explanation">Reference-level explanation</a></h2>
<h3 id="keywords"><a class="header" href="#keywords">Keywords</a></h3>
<p>Both <code>async</code> and <code>await</code> become keywords, gated on the 2018 edition.</p>
<h3 id="return-type-of-async-functions-closures-and-blocks"><a class="header" href="#return-type-of-async-functions-closures-and-blocks">Return type of <code>async</code> functions, closures, and blocks</a></h3>
<p>The return type of an async function is a unique anonymous type generated by
the compiler, similar to the type of a closure. You can think of this type as
being like an enum, with one variant for every “yield point” of the function -
the beginning of it, the await expressions, and every return. Each variant
stores the state that is needed to be stored to resume control from that yield
point.</p>
<p>When the function is called, this anonymous type is returned in its initial
state, which contains all of the arguments to this function.</p>
<h4 id="trait-bounds"><a class="header" href="#trait-bounds">Trait bounds</a></h4>
<p>The anonymous return type implements <code>Future</code>, with the return type as its
<code>Item</code>. Polling it advances the state of the function, returning <code>Pending</code>
when it hits an <code>await</code> point, and <code>Ready</code> with the item when it hits a
<code>return</code> point. Any attempt to poll it after it has already returned <code>Ready</code>
once will panic.</p>
<p>The anonymous return type has a negative impl for the <code>Unpin</code> trait - that is
<code>impl !Unpin</code>. This is because the future could have internal references which
means it needs to never be moved.</p>
<h3 id="lifetime-capture-in-the-anonymous-future"><a class="header" href="#lifetime-capture-in-the-anonymous-future">Lifetime capture in the anonymous future</a></h3>
<p>All of the input lifetimes to this function are captured in the future returned
by the async function, because it stores all of the arguments to the function
in its initial state (and possibly later states). That is, given a function
like this:</p>
<pre><code class="language-rust">async fn foo(arg: &amp;str) -&gt; usize { ... }</code></pre>
<p>It has an equivalent type signature to this:</p>
<pre><code class="language-rust">fn foo&lt;'a&gt;(arg: &amp;'a str) -&gt; impl Future&lt;Output = usize&gt; + 'a { ... }</code></pre>
<p>This is different from the default for <code>impl Trait</code>, which does not capture the
lifetime. This is a big part of why the return type is <code>T</code> instead of <code>impl Future&lt;Output = T&gt;</code>.</p>
<h4 id="initialization-pattern"><a class="header" href="#initialization-pattern">“Initialization” pattern</a></h4>
<p>One pattern that sometimes occurs is that a future has an “initialization” step
which should be performed during its construction. This is useful when dealing
with data conversion and temporary borrows. Because the async function does not
begin evaluating until you poll it, and it captures the lifetimes of its
arguments, this pattern cannot be expressed directly with an <code>async fn</code>.</p>
<p>One option is to write a function that returns <code>impl Future</code> using a closure
which is evaluated immediately:</p>
<pre><code class="language-rust">// only arg1's lifetime is captured in the returned future
fn foo&lt;'a&gt;(arg1: &amp;'a str, arg2: &amp;str) -&gt; impl Future&lt;Output = usize&gt; + 'a {
    // do some initialization using arg2

    // closure which is evaluated immediately
    async move {
         // asynchronous portion of the function
    }
}</code></pre>
<h3 id="the-expansion-of-await"><a class="header" href="#the-expansion-of-await">The expansion of await</a></h3>
<p>The <code>await!</code> builtin expands roughly to this:</p>
<pre><code class="language-rust">let mut future = IntoFuture::into_future($expression);
let mut pin = unsafe { Pin::new_unchecked(&amp;mut future) };
loop {
    match Future::poll(Pin::borrow(&amp;mut pin), &amp;mut ctx) {
          Poll::Ready(item) =&gt; break item,
          Poll::Pending     =&gt; yield,
    }
}</code></pre>
<p>This is not a literal expansion, because the <code>yield</code> concept cannot be
expressed in the surface syntax within <code>async</code> functions. This is why <code>await!</code>
is a compiler builtin instead of an actual macro.</p>
<h3 id="the-order-of-async-and-move"><a class="header" href="#the-order-of-async-and-move">The order of <code>async</code> and <code>move</code></a></h3>
<p>Async closures and blocks can be annotated with <code>move</code> to capture ownership of
the variables they close over. The order of the keywords is fixed to
<code>async move</code>. Permitting only one ordering avoids confusion about whether it is
significant for the meaning.</p>
<pre><code class="language-rust">async move {
    // body
}</code></pre>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<p>Adding async &amp; await syntax to Rust is a major change to the language - easily
one of the most significant additions since 1.0. Though we have started with
the smallest beachhead of features, in the long term the set of features it
implies will grow as well (see the unresolved questions section). Such a
significant addition mustn’t be taken lightly, and only with strong motivation.</p>
<p>We believe that an ergonomic asynchronous IO solution is essential to Rust’s
success as a language for writing high performance network services, one of our
goals for 2018. Async &amp; await syntax based on the Future trait is the most
expedient &amp; low risk path to achieving that goal in the near future.</p>
<p>This RFC, along with its companion lib RFC, makes a much firmer commitment to
futures &amp; async/await than we have previously as a project. If we decide to
reverse course after stabilizing these features, it will be quite costly.
Adding an alternative mechanism for asynchronous programming would be more
costly because this exists. However, given our experience with futures, we are
confident that this is the correct path forward.</p>
<p>There are drawbacks to several of the smaller decisions we have made as well.
There is a trade off between using the “inner” return type and the “outer”
return type, for example. We could have a different evaluation model for async
functions in which they are evaluated immediately up to the first await point.
The decisions we made on each of these questions are justified in the
appropriate section of the RFC.</p>
<h2 id="rationale-and-alternatives"><a class="header" href="#rationale-and-alternatives">Rationale and alternatives</a></h2>
<p>This section contains alternative design decisions which this RFC rejects (as
opposed to those it merely postpones).</p>
<h3 id="the-return-type-t-instead-of-impl-futureoutput--t"><a class="header" href="#the-return-type-t-instead-of-impl-futureoutput--t">The return type (<code>T</code> instead of <code>impl Future&lt;Output = T&gt;</code>)</a></h3>
<p>The return type of an asynchronous function is a sort of complicated question.
There are two different perspectives on the return type of an async fn: the
“interior” return type - the type that you return with the <code>return</code> keyword,
and the “exterior” return type - the type that the function returns when you
call it.</p>
<p>Most statically typed languages with async fns display the “outer” return type
in the function signature. This RFC proposes instead to display the “inner”
return type in the function signature. This has both advantages and
disadvantages.</p>
<h4 id="the-lifetime-elision-problem"><a class="header" href="#the-lifetime-elision-problem">The lifetime elision problem</a></h4>
<p>As alluded to previously, the returned future captures all input lifetimes. By
default, <code>impl Trait</code> does not capture any lifetimes. To accurately reflect the
outer return type, it would become necessary to eliminate lifetime elision:</p>
<pre><code class="language-rust">async fn foo&lt;'ret, 'a: 'ret, 'b: 'ret&gt;(x: &amp;'a i32, y: &amp;'b i32) -&gt; impl Future&lt;Output = i32&gt; + 'ret {
     *x + *y
}</code></pre>
<p>This would be very unergonomic and make async both much less pleasant to use
and much less easy to learn. This issue weighs heavily in the decision to
prefer returning the interior type.</p>
<p>We could have it return <code>impl Future</code> but have lifetime capture work
differently for the return type of <code>async fn</code> than other functions; this seems
worse than showing the interior type.</p>
<h4 id="polymorphic-return-a-non-factor-for-us"><a class="header" href="#polymorphic-return-a-non-factor-for-us">Polymorphic return (a non-factor for us)</a></h4>
<p>According to the C# developers, one of the major factors in returning <code>Task&lt;T&gt;</code>
(their “outer type”) was that they wanted to have async functions which could
return types other than <code>Task</code>. We do not have a compelling use case for this:</p>
<ol>
<li>In the 0.2 branch of futures, there is a distinction between <code>Future</code> and
<code>StableFuture</code>. However, this distinction is artificial and only because
object-safe custom self-types are not available on stable yet.</li>
<li>The current <code>#[async]</code> macro has a <code>(boxed)</code> variant. We would prefer to
have async functions always be unboxed and only box them explicitly at the
call site. The motivation for the attribute variant was to support async
methods in object-safe traits. This is a special case of supporting <code>impl Trait</code> in object-safe traits (probably by boxing the return type in the
object case), a feature we want separately from async fn.</li>
<li>It has been proposed that we support <code>async fn</code> which return streams.
However, this mean that the semantics of the internal function would differ
significantly between those which return futures and streams. As discussed
in the unresolved questions section, a solution based on generators and
async generators seems more promising.</li>
</ol>
<p>For these reasons, we don’t think there’s a strong argument from polymorphism
to return the outer type.</p>
<h4 id="learnability--documentation-trade-off"><a class="header" href="#learnability--documentation-trade-off">Learnability / documentation trade off</a></h4>
<p>There are arguments from learnability in favor of both the outer and inner
return type. One of the most compelling arguments in favor of the outer return
type is documentation: when you read automatically generated API docs, you will
definitely see what you get as the caller. In contrast, it can be easier to
understand how to write an async function using the inner return type, because
of the correspondence between the return type and the type of the expressions
you <code>return</code>.</p>
<p>Rustdoc can handle async functions using the inner return type in a couple of
ways to make them easier to understand. At minimum we should make sure to
include the <code>async</code> annotation in the documentation, so that users who
understand async notation know that the function will return a future. We can
also perform other transformations, possibly optionally, to display the outer
signature of the function. Exactly how to handle API documentation for async
functions is left as an unresolved question.</p>
<h3 id="built-in-syntax-instead-of-using-macros-in-generators"><a class="header" href="#built-in-syntax-instead-of-using-macros-in-generators">Built-in syntax instead of using macros in generators</a></h3>
<p>Another alternative is to focus on stabilizing procedural macros and
generators, rather than introducing built-in syntax for async functions. An
async function can be modeled as a generator which yields <code>()</code>.</p>
<p>In the long run, we believe we will want dedicated syntax for async functions,
because it is more ergonomic &amp; the use case is compelling and significant
enough to justify it (similar to - for example - having built in for loops and
if statements rather than having macros which compile to loops and match
statements). Given that, the only question is whether or not we could have a
more expedited stability by using generators for the time being than by
introducing async functions now.</p>
<p>It seems unlikely that using macros which expand to generators will result in a
faster stabilization. Generators can express a wider range of possibilities,
and have a wider range of open questions - both syntactic and semantic. This
does not even address the open questions of stabilizing more procedural macros.
For this reason, we believe it is more expedient to stabilize the minimal
built-in async/await functionality than to attempt to stabilize generators and
proc macros.</p>
<h3 id="async-based-on-generators-alone"><a class="header" href="#async-based-on-generators-alone"><code>async</code> based on generators alone</a></h3>
<p>Another alternative design would be to have async functions <em>be</em> the syntax for
creating generators. In this design, we would write a generator like this:</p>
<pre><code class="language-rust">async fn foo(arg: Arg) -&gt; Return yield Yield</code></pre>
<p>Both return and yield would be optional, default to <code>()</code>. An async fn that
yields <code>()</code> would implement <code>Future</code>, using a blanket impl. An async fn that
returns <code>()</code> would implement <code>Iterator</code>.</p>
<p>The problem with this approach is that does not ergonomically handle <code>Stream</code>s,
which need to yield <code>Poll&lt;Option&lt;T&gt;&gt;</code>. It’s unclear how <code>await</code> inside of an
async fn yielding something other than <code>()</code> (which would include streams) would
work.  For this reason, the “matrix” approach in which we have independent
syntax for generator functions, async functions, and async generator functions,
seems like a more promising approach.</p>
<h3 id="hot-async-functions"><a class="header" href="#hot-async-functions">“Hot async functions”</a></h3>
<p>As proposed by this RFC, all async functions return immediately, without
evaluating their bodies at all. As discussed above, this is not convenient for
use cases in which you have an immediate “initialization” step - those use
cases need to use a terminal async block, for example.</p>
<p>An alternative would be to have async functions immediately evaluate up until
their first <code>await</code>, preserving their state until then. The implementation of
this would be quite complicated - they would need to have an additional yield
point within the <code>await</code>, prior to polling the future being awaited,
conditional on whether or not the await is the first await in the body of the
future.</p>
<p>A fundamental difference between Rust’s futures and those from other languages
is that Rust’s futures do not do anything unless polled. The whole system is
built around this: for example, cancellation is dropping the future for
precisely this reason. In contrast, in other languages, calling an async fn
spins up a future that starts executing immediately. This difference carries
over to <code>async fn</code> and <code>async</code> blocks as well, where it’s vital that the
resulting future be <em>actively polled</em> to make progress. Allowing for partial,
eager execution is likely to lead to significant confusion and bugs.</p>
<p>This is also complicated from a user perspective - when a portion of the body
is evaluated depends on whether or not it appears before all <code>await</code>
statements (which could possibly be macro generated). The use of a terminal
async block provide a clearer mechanism for distinguishing between the
immediately evaluated and asynchronously evaluated portions of a future with an
initialization step.</p>
<h3 id="using-asyncawait-instead-of-alternative-asynchronicity-systems"><a class="header" href="#using-asyncawait-instead-of-alternative-asynchronicity-systems">Using async/await instead of alternative asynchronicity systems</a></h3>
<p>A final - and extreme - alternative would be to abandon futures and async/await
as the mechanism for async/await in Rust and to adopt a different paradigm.
Among those suggested are a generalized effects system, monads &amp; do notation,
green-threading, and stack-full coroutines.</p>
<p>While it is hypothetically plausible that some generalization beyond
async/await could be supported by Rust, there has not enough research in this
area to support it in the near-term. Given our goals for 2018 - which emphasize
shipping - async/await syntax (a concept available widely in many languages
which interacts well with our existing async IO libraries) is the most logical
thing to implement at this stage in Rust’s evolution.</p>
<h3 id="async-blocks-vs-async-closures"><a class="header" href="#async-blocks-vs-async-closures">Async blocks vs async closures</a></h3>
<p>As noted in the main text, <code>async</code> blocks and <code>async</code> closures are closely
related, and are roughly inter-expressible:</p>
<pre><code class="language-rust">// almost equivalent
async { ... }
(async || { ... })()

// almost equivalent
async |..| { ... }
|..| async { ... }</code></pre>
<p>We could consider having only one of the two constructs. However:</p>
<ul>
<li>
<p>There’s a strong reason to have <code>async ||</code> for consistency with <code>async fn</code>;
such closures are often useful for higher-order constructs like constructing a
service.</p>
</li>
<li>
<p>There’s a strong reason to have <code>async</code> blocks: The initialization pattern
mentioned in the RFC text, and the fact that it provides a more
direct/primitive way of constructing futures.</p>
</li>
</ul>
<p>The RFC proposes to include both constructs up front, since it seems inevitable
that we will want both of them, but we can always reconsider this question
before stabilization.</p>
<h2 id="prior-art"><a class="header" href="#prior-art">Prior art</a></h2>
<p>There is a lot of precedence from other languages for async/await syntax as a
way of handling asynchronous operation - notable examples include C#,
JavaScript, and Python.</p>
<p>There are three paradigms for asynchronous programming which are dominant
today:</p>
<ul>
<li>Async and await notation.</li>
<li>An implicit concurrent runtime, often called “green-threading,” such as
communicating sequential processes (e.g. Go) or an actor model (e.g. Erlang).</li>
<li>Monadic transformations on lazily evaluated code, such as do notation (e.g.
Haskell).</li>
</ul>
<p>Async/await is the most compelling model for Rust because it interacts
favorably with ownership and borrowing (unlike systems based on monads) and it
enables us to have an entirely library-based asynchronicity model (unlike
green-threading).</p>
<p>One way in which our handling of async/await differs from most other statically
typed languages (such as C#) is that we have chosen to show the “inner” return
type, rather than the outer return type. As discussed in the alternatives
section, Rust’s specific context (lifetime elision, the lack of a need for
return type polymorphism here) make this deviation well-motivated.</p>
<h2 id="unresolved-questions"><a class="header" href="#unresolved-questions">Unresolved questions</a></h2>
<p>This section contains design extensions which have been postponed &amp; not
included in this initial RFC.</p>
<h3 id="final-syntax-for-the-await-expression"><a class="header" href="#final-syntax-for-the-await-expression">Final syntax for the <code>await</code> expression</a></h3>
<p>Though this RFC proposes that <code>await</code> be a built-in macro, we’d prefer that
some day it be a normal control flow construct. The unresolved question about
this is how to handle its precedence &amp; whether or not to require delimiters of
some kind.</p>
<p>In particular, <code>await</code> has an interesting interaction with <code>?</code>. It is very
common to have a future which will evaluate to a <code>Result</code>, which the user will
then want to apply <code>?</code> to. This implies that await should have a tighter
precedence than <code>?</code>, so that the pattern will work how users wish it to.
However, because it introduces a space, it doesn’t look like this is the
precedence you would get:</p>
<pre><code>await future?
</code></pre>
<p>There are a couple of possible solutions:</p>
<ol>
<li>Require delimiters of some kind, maybe braces or parens or either, so that
it will look more like how you expect - <code>await { future }?</code> - this is rather
noisy.</li>
<li>Define the precedence as the obvious, if inconvenient precedence, requiring
users to write <code>(await future)?</code> - this seems very surprising for users.</li>
<li>Define the precedence as the inconvenient precedence - this seems equally
surprising as the other precedence.</li>
<li>Introduce a special syntax to handle the multiple applications, such as
<code>await? future</code> - this seems very unusual in its own way.</li>
</ol>
<p>This is left as an unresolved question to find another solution or decide which
of these is least bad.</p>
<h3 id="for-await-and-processing-streams"><a class="header" href="#for-await-and-processing-streams"><code>for await</code> and processing streams</a></h3>
<p>Another extension left out of the RFC for now is the ability to process streams
using a for loop. One could imagine a construct like <code>for await</code>, which takes
an <code>IntoStream</code> instead of an <code>IntoIterator</code>:</p>
<pre><code class="language-rust">for await value in stream {
    println!("{}", value);
}</code></pre>
<p>This is left out of the initial RFC to avoid having to stabilize a definition
of <code>Stream</code> in the standard library (to keep the companion RFC to this one as
small as possible).</p>
<h3 id="generators-and-streams"><a class="header" href="#generators-and-streams">Generators and Streams</a></h3>
<p>In the future, we may also want to be able to define async functions that
evaluate to streams, rather than evaluating to futures. We propose to handle
this use case by way of generators. Generators can evaluate to a kind of
iterator, while async generators can evaluate to a kind of stream.</p>
<p>For example (using syntax which could change);</p>
<pre><code class="language-rust">// Returns an iterator of i32
fn foo(mut x: i32) yield i32 {
     while x &gt; 0 {
          yield x;
          x -= 2;
     }
}

// Returns a stream of i32
async fn foo(io: &amp;AsyncRead) yield i32 {
    async for line in io.lines() {
        yield line.unwrap().parse().unwrap();
    }
}</code></pre>
<h3 id="async-functions-which-implement-unpin"><a class="header" href="#async-functions-which-implement-unpin">Async functions which implement <code>Unpin</code></a></h3>
<p>As proposed in this RFC, all async functions do not implement <code>Unpin</code>, making
it unsafe to move them out of a <code>Pin</code>. This allows them to contain references
across yield points.</p>
<p>We could also, with an annotation, typecheck an async function to confirm that it
does not contain any references across yield points, allowing it to implement
<code>Unpin</code>. The annotation to enable this is left unspecified for the time being.</p>
<h3 id="-operator-and-control-flow-constructs-in-async-blocks"><a class="header" href="#-operator-and-control-flow-constructs-in-async-blocks"><code>?</code>-operator and control-flow constructs in async blocks</a></h3>
<p>This RFC does not propose how the <code>?</code>-operator and control-flow constructs like
<code>return</code>, <code>break</code> and <code>continue</code> should work inside async blocks.</p>
<p>It was discussed that async blocks should act as a boundary for the
<code>?</code>-operator. This would make them suitable for fallible IO:</p>
<pre><code class="language-rust">let reader: AsyncRead = ...;
async {
    let foo = await!(reader.read_to_end())?;
    Ok(foo.parse().unwrap_or(0))
}: impl Future&lt;Output = io::Result&lt;u32&gt;&gt;</code></pre>
<p>Also, it was discussed to allow the use of <code>break</code> to return early from
an async block:</p>
<pre><code class="language-rust">async {
    if true { break "foo" }
}</code></pre>
<p>The use of the <code>break</code> keyword instead of <code>return</code> could be beneficial to
indicate that it applies to the async block and not its surrounding function. On
the other hand this would introduce a difference to closures and async closures
which make use the <code>return</code> keyword.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="2388-try-expr.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="2396-target-feature-1.1.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="2388-try-expr.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="2396-target-feature-1.1.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
