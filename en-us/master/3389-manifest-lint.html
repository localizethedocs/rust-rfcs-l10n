<!DOCTYPE HTML>
<html lang="en_US" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>3389-manifest-lint - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-0060737d.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: <code>manifest-lint</code></li>
<li>Start Date: 2023-02-14</li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/3389">rust-lang/rfcs#3389</a></li>
<li>Tracking Issue: <a href="https://github.com/rust-lang/cargo/issues/12115">rust-lang/cargo#12115</a></li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Add a <code>[lints]</code> table to <code>Cargo.toml</code> to configure reporting levels for
rustc and other tool lints.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>Currently, you can configure lints through</p>
<ul>
<li><code>#[&lt;level&gt;(&lt;lint&gt;)]</code> or <code>#![&lt;level&gt;(&lt;lint&gt;)]</code>, like <code>#[forbid(unsafe_code)]</code>
<ul>
<li>But this doesn’t scale up with additional targets (benches, examples,
tests) or workspaces</li>
</ul>
</li>
<li>On the command line, like <code>cargo clippy -- --forbid unsafe_code</code>
<ul>
<li>This puts the burden on the caller</li>
</ul>
</li>
<li>Through <code>RUSTFLAGS</code>, like <code>RUSTFLAGS=--forbid=unsafe_code cargo clippy</code>
<ul>
<li>This puts the burden on the caller</li>
</ul>
</li>
<li>In <code>.cargo/config.toml</code>’s <code>target.*.rustflags</code>
<ul>
<li>This couples you to the running in specific directories and not running in
the right directory causes rebuilds</li>
<li>The cargo team has previously stated that
<a href="https://internals.rust-lang.org/t/proposal-move-some-cargo-config-settings-to-cargo-toml/13336/14?u=epage">they would like to see package-specific config moved to manifests</a></li>
</ul>
</li>
</ul>
<p>We would like a solution that makes it easier to share across targets and
packages for all tools.</p>
<p>See also</p>
<ul>
<li><a href="https://github.com/rust-lang/rust-clippy/issues/1313">rust-lang/rust-clippy#1313</a></li>
<li><a href="https://github.com/rust-lang/cargo/issues/5034">rust-lang/cargo#5034</a></li>
<li><a href="https://github.com/EmbarkStudios/rust-ecosystem/issues/59">EmbarkStudios/rust-ecosystem#59</a></li>
<li><a href="https://internals.rust-lang.org/t/proposal-cargo-lint-configuration/9135">Proposal: Cargo Lint configuration</a></li>
</ul>
<h2 id="guide-level-explanation"><a class="header" href="#guide-level-explanation">Guide-level explanation</a></h2>
<p>A new <code>lints</code> table would be added to configure lints:</p>
<pre><code class="language-toml">[lints.rust]
unsafe_code = "forbid"
</code></pre>
<p>and <code>cargo</code> would pass these along as flags to <code>rustc</code>, <code>clippy</code>, or other lint tools.</p>
<p>This would work with
<a href="https://rust-lang.github.io/rfcs/2906-cargo-workspace-deduplicate.html?highlight=2906#">RFC 2906 <code>workspace-deduplicate</code></a>:</p>
<pre><code class="language-toml">[lints]
workspace = true

[workspace.lints.rust]
unsafe_code = "forbid"
</code></pre>
<h3 id="documentation-updates"><a class="header" href="#documentation-updates">Documentation Updates</a></h3>
<h3 id="the-lints-section"><a class="header" href="#the-lints-section">The <code>lints</code> section</a></h3>
<p><em>as a new <a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-manifest-format">“Manifest Format” entry</a></em></p>
<p>Override the default level of lints from different tools by assigning them to a new level in a
table, for example:</p>
<pre><code class="language-toml">[lints.rust]
unsafe_code = "forbid"
</code></pre>
<p>This is short-hand for:</p>
<pre><code class="language-toml">[lints.rust]
unsafe_code = { level = "forbid", priority = 0 }
</code></pre>
<p><code>level</code> corresponds to the lint levels in <code>rustc</code>:</p>
<ul>
<li><code>forbid</code></li>
<li><code>deny</code></li>
<li><code>warn</code></li>
<li><code>allow</code></li>
</ul>
<p><code>priority</code> is a signed integer that controls which lints or lint groups override other lint groups:</p>
<ul>
<li>lower (particularly negative) numbers have lower priority, being overridden
by higher numbers, and show up first on the command-line to tools like
<code>rustc</code></li>
</ul>
<p>To know which table under <code>[lints]</code> a particular lint belongs under, it is the part before <code>::</code> in the lint
name.  If there isn’t a <code>::</code>, then the tool is <code>rust</code>.  For example a warning
about <code>unsafe_code</code> would be <code>lints.rust.unsafe_code</code> but a lint about
<code>clippy::enum_glob_use</code> would be <code>lints.clippy.enum_glob_use</code>.</p>
<h3 id="the-lints-table"><a class="header" href="#the-lints-table">The <code>lints</code> table</a></h3>
<p><em>as a new <a href="https://doc.rust-lang.org/cargo/reference/workspaces.html#the-workspace-section"><code>[workspace]</code> entry</a></em></p>
<p>The <code>workspace.lints</code> table is where you define lint configuration to be inherited by members of a workspace.</p>
<p>Specifying a workspace lint configuration is similar to package lints.</p>
<p>Example:</p>
<pre><code class="language-toml"># [PROJECT_DIR]/Cargo.toml
[workspace]
members = ["crates/*"]

[workspace.lints.rust]
unsafe_code = "forbid"
</code></pre>
<pre><code class="language-toml"># [PROJECT_DIR]/crates/bar/Cargo.toml
[package]
name = "bar"
version = "0.1.0"

[lints]
workspace = true
</code></pre>
<h2 id="reference-level-explanation"><a class="header" href="#reference-level-explanation">Reference-level explanation</a></h2>
<p>When parsing a manifest, cargo will resolve workspace inheritance for
<code>lints.workspace = true</code> as it does with basic fields, when <code>workspace</code> is
present, no other fields are allowed to be present.  This precludes having the
package override the workspace on a lint-by-lint basis.</p>
<p>cargo will contain a mapping of tool to underlying command (e.g. <code>rust</code> to
<code>rustc</code>, <code>clippy</code> to <code>rustc</code> when clippy is the driver, <code>rustdoc</code> to
<code>rustdoc</code>).  When running the underlying command for the specified package,
cargo will:</p>
<ol>
<li>Transform the lints from <code>tool.lint = level</code> to <code>--level tool::lint</code></li>
</ol>
<ul>
<li>Leaving off the <code>tool::</code> when it is <code>rust</code></li>
<li>cargo will error if <code>lint</code> contains <code>::</code> as the first part is assumed to be
a tool and it should be listed in that tool’s table</li>
</ul>
<ol start="2">
<li>Sort them by priority and then an unspecified order within priority that we may change in the <a href="#future-possibilities">future</a>.</li>
</ol>
<ul>
<li>On initial release, the sort will likely be reverse alphabetical which would cause <code>all</code> to be last, making it unlikely to do what the user wants which would raise awareness of the need for setting <code>priority</code> for all groups.</li>
</ul>
<ol start="3">
<li>Pass them on the command line before other configuration like
<code>RUSTFLAGS</code>, allowing user configuration to override package configuration.</li>
</ol>
<ul>
<li>These flags will be fingerprinted so changing them will cause a rebuild only
for the commands where they are used.  By only including the lints for the
command in question, we reduce what is fingerprinted, reducing what gets
rebuilt when <code>[lints]</code> is changed.</li>
</ul>
<p>Note that this means that <code>[lints]</code> is only applied to the package where its
defined and not to its dependencies, local or not.  This avoids having to unify
<code>[lints]</code> tables across local packages.  Normally, lints for non-local
dependencies won’t be shown anyways because of <code>--cap-lints</code>.  As for local
dependencies, they will likely have their own <code>[lints]</code> table, most the same
one, inherited from the workspace.</p>
<p>Initially, the only supported tools will be:</p>
<ul>
<li><code>rust</code></li>
<li><code>clippy</code></li>
<li><code>rustdoc</code></li>
</ul>
<p>The reason for <code>rust</code> existing, despite lints not being prefixed with <code>rust::</code>, is
to avoid ambiguity in the data model between <code>lint.&lt;lint&gt;</code> and
<code>lint.&lt;tool&gt;.&lt;lint&gt;</code>.  A downside to naming the tool <code>rust</code> is it might be
confusing if we ever expose <code>rustc::</code> lints.</p>
<p>Addition of third-party tools would fall under their
<a href="https://github.com/rust-lang/rust/issues/44690">attributes for tools</a>.</p>
<p><strong>Note:</strong> This reserves the tool name <code>workspace</code> to allow workspace inheritance.</p>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<p>Since <code>[lints]</code> only affects the associated package, and not dependencies, it
will not work with <code>future-incompat</code> lints that are meant to be applied to
dependencies.  This may cause some user confusion.</p>
<p>There has been some user/IDE confusion about running commands like <code>rustfmt</code>
directly and expecting them to pick up configuration only associated with their
higher-level cargo-plugins despite that configuration (like <code>package.edition</code>)
being cargo-specific.  By baking the configured lint levels for rustc, rustdoc, and
clippy directly into cargo, we will be seeing more of this.  A hope is that
this will actually improve with this RFC.  Over time, tools will need to switch
to the model of running <code>cargo</code> to get configuration in response to this RFC.
As for users, if a tool’s primary configuration is in <code>Cargo.toml</code>, that will
provide a strong coupling with <code>cargo</code> in users minds as compared to using an
external configuration file and overlooking the one or two fields read from
<code>Cargo.toml</code>.</p>
<p>As this focuses on lints, this leaves out first-party tools that need
configuration but aren’t linters, namely <code>rustfmt</code>, leading to an inconsistent
experience if <code>clippy.toml</code> goes away in the future (if we act on the future
possibility of supporting linter configuration)</p>
<p>A concern brought up in
<a href="https://github.com/rust-lang/rust-clippy/issues/1313">rust-lang/rust-clippy#1313</a>
was that this will pass lints unconditionally to the underlying tool, leading
to “undefined lint” warnings when used on earlier versions, requiring that
warning to also be suppressed, reducing its value.  However, in the “Future
possibilities” section, we mention direct support for tying lints to rust versions.</p>
<p>This does not allow sharing lints across workspaces.</p>
<h2 id="rationale-and-alternatives"><a class="header" href="#rationale-and-alternatives">Rationale and alternatives</a></h2>
<p>When designing this, we wanted to keep in mind how things work today, including</p>
<ul>
<li><code>clippy</code> defines all configuration as linter/tool config and not lint config (linter/lint config is a future possibility)</li>
<li>All <code>clippy</code> lint groups are disjoint</li>
<li><code>rustdoc</code> has no plans for groups outside of <code>all</code></li>
<li><code>rustc</code> today has some intersecting groups</li>
</ul>
<p>However, we also need to consider how decisions might limit us in the future and whether we want to bind future decisions with this RFC, including</p>
<ul>
<li>Whether existing decisions will be revisited</li>
<li>When new tools are added, like <code>cargo</code> and <code>cargo-semver-check</code>, which haven’t had lint levels and configuration long enough (or at all) to explore their problem and design space.</li>
</ul>
<h3 id="misc"><a class="header" href="#misc">Misc</a></h3>
<p>This could be left to <code>clippy.toml</code> but that leaves <code>rustc</code>, <code>rustdoc</code>, and future linters without a solution.</p>
<p><code>[lints]</code> could be <code>[package.lints]</code>, tying it to the package unlike <code>[patch]</code>
and other fields that are more workspace related.  Instead, we used
<code>[dependencies]</code> as our model.</p>
<p><code>[lints]</code> could be <code>[lint]</code> but we decided to follow the precedence of <code>[dependencies]</code>.</p>
<h3 id="schema"><a class="header" href="#schema">Schema</a></h3>
<p>In evaluating prior art, we saw two major styles for configuring lint levels:</p>
<p>Python-style:</p>
<pre><code class="language-toml">[lints]
warn = [
  { lint = "rust_2018_idioms", priority = -1 },
  { lint = "clippy::all", priority = -1 },
  "clippy::await_holding_lock",
  "clippy::char_lit_as_u8",
  "clippy::checked_conversions",
]
deny = [
  "unsafe_code",
]
</code></pre>
<p>Inspired by ESLint-style:</p>
<pre><code class="language-toml">[lints.rust]
rust_2018_idioms = { level = "warn", priority = -1}

unsafe_code = "deny"

[lints.clippy]
all = { level = "warn", priority = -1 }

await_holding_lock = "warn"
char_lit_as_u8 = "warn"
checked_conversions = "warn"
</code></pre>
<ul>
<li>More akin to <code>eslint</code></li>
</ul>
<p>In a lot of areas, which to choose comes down to personal preference and what people are comfortable with:</p>
<ul>
<li>If you want to lookup everything for a level, Python-style works better</li>
<li>If you want to look up the level for a lint, ESLint-style works better</li>
<li>Python-style is more succinct</li>
<li>Python-style has fewer jagged edges</li>
</ul>
<p>We ended up favoring more of the ESLint-style because:</p>
<ul>
<li>ESLint-style offers more syntax choices for lint config (inline tables,
standard tables, dotted keys).  In general, the TOML experience for deeply
nested inline structures is not great.
<ul>
<li>Right now, the only other lint field beside <code>level</code> is <code>priority</code>.  In the future we may add lint configuration.  While we shouldn’t exclusively design for this possibility, all things being equal, we shouldn’t make that potential future’s experience worse</li>
</ul>
</li>
<li>ESLInt-style makes it easier to visually highlight groups and the lints related to those groups</li>
<li>The cargo team has seen support issues that partially arise from a user
losing track of which <code>dependencies</code> table they are in because the list of
dependencies is large enough to have the header far enough away (or off
screen).  This can similarly happen with Python-style as the context of the
level is in the table header.  See <a href="https://github.com/EmbarkStudios/rust-ecosystem/blob/81d62539a57add13f4b0f1c503e267b6de358f70/lints.toml">EmbarkStudios’s lint list as an example of where this could happen</a></li>
<li>If we add support for packages to override some of the lints inherited from
the workspace, it is easier for users to map out this relationship with
ESLint-style.</li>
</ul>
<h3 id="linter-tables-vs-linter-namespaces"><a class="header" href="#linter-tables-vs-linter-namespaces">Linter Tables vs Linter Namespaces</a></h3>
<p>We started off with lints being referenced with their tool as a namespace (e.g.
<code>"clipp::enum_glob_use"</code>) like in diagnostic messages, making copy/paste easy.</p>
<p>However, we switched to a more hierarchical data model (e.g.
<code>clippy.enum_glob_use</code>) to avoid quoting keys with the <code>lints.&lt;lint&gt; = &lt;level&gt;</code> schema.</p>
<p>If we add lint/linter config in the future</p>
<ul>
<li>Being more hierarchical means lint and linter config are kept closer to each
other, making it easier to evaluate their impact on each other.</li>
<li><code>lints.&lt;lint&gt; = &lt;level&gt;</code> combined with <code>lints.&lt;linter&gt;.metadata</code> makes it
harder for cargo to collect all the lints to pass down into the compiler
driver.</li>
</ul>
<h3 id="lint-precedence"><a class="header" href="#lint-precedence">Lint Precedence</a></h3>
<p>Currently, <code>rustc</code> allows lints to be controlled on the command-line with the
last level for a lint winning.  They may also be specified as attributes with
the last instance winning.  <code>cargo</code> adds the <code>RUSTFLAGS</code> environment variable
and <code>config.toml</code> entry.  On top of this, there are lint groups that act as
aliases to sets of lints.  These groups may be disjoint, supersets, or they may
even intersect.</p>
<p>Example <code>RUSTFLAGS</code>:</p>
<ul>
<li><code>-Aclippy::all -Wclippy::doc_markdown</code></li>
<li><code>-Dfuture-incompatible -Asemicolon_in_expressions_from_macros</code></li>
</ul>
<p>In providing lint-level configuration in <code>Cargo.toml</code>, users will need to be
able to set the lint level for group and then override individual lints within
that group while interacting with the existing <code>RUSTFLAGS</code> system.</p>
<p>We have chosen <strong>Option 6</strong> with <code>priority</code> being in-scope for this RFC and
warnings and auto-sorting as a future possibility.</p>
<p><strong>Option 1: Auto-sort</strong></p>
<pre><code class="language-rust">[lints.rust]
unsafe_code = "deny"
allow_dead_code = "allow"
all = "warn"</code></pre>
<ul>
<li>Unable to handle if two intersecting groups are assigned different levels</li>
</ul>
<p><strong>Option 2: Ordered keys</strong></p>
<pre><code class="language-rust">[lints.rust]
all = "warn"
allow_dead_code = "allow"
unsafe_code = "deny"</code></pre>
<ul>
<li>Relies on the order of keys in a TOML table which is undefined</li>
<li>Without standard ordering semantics, like with <code>[]</code>, users or formatters
might naively reformat the table which would affect the semantics</li>
</ul>
<p><strong>Option 3: Array of tables</strong></p>
<pre><code class="language-toml"># inline table
[lints]
rust = [
    { lint = "all", level = "warn" },
    { lint = "allow_dead_code", level = "allow" },
    { lint = "unsafe_code", level = "deny" },
]
# standard table
[[lints.clippy]]
lint = "all"
level = "warn"
[[lints.clippy]]
lint = "cyclomatic_complexity"
level = "allow"
</code></pre>
<ul>
<li>The syntax for this seems overly verbose</li>
<li>Complex, nested structures aren’t the easiest to work with in TOML</li>
</ul>
<p><strong>Option 4: Compact array of tables</strong></p>
<pre><code class="language-toml">[tools.rust]
lints = [
    { warn = "all" },
    { allow = "allow_dead_code" },
    { deny = "unsafe_code" },
]
</code></pre>
<ul>
<li><em>Note:</em> <code>lints.rust = []</code> wasn’t used as that won’t work with linter configuration in the future</li>
<li><em>Note:</em> Top-level table was changed to avoid <code>lints.rust.lints</code> redundancy and would allow us to open this up to more tools in the future</li>
<li><em>Note:</em> <code>&lt;level&gt; = &lt;lint&gt;</code> (instead of the other way) to keep the keys finite so we can add more fields in the future</li>
<li>Mirrors the familiar <code>RUSTFLAGS</code> syntax</li>
<li>Complex, nested structures aren’t the easiest to work with in TOML</li>
</ul>
<p><strong>Option 5: <code>priority</code> field</strong></p>
<pre><code class="language-rust">[lints.rust]
all = { level = "warn", priority = -1 }
allow_dead_code = "allow"
unsafe_code = "deny"</code></pre>
<ul>
<li>Difficult for the user to figure out there is a problem or how to address it</li>
</ul>
<p><strong>Option 6: <code>priority</code> field with warnings and maybe auto-sort</strong></p>
<pre><code class="language-rust">[lints.rust]
all = "warn"
allow_dead_code = "allow"
unsafe_code = "deny"</code></pre>
<ul>
<li>Option 1 (auto-sort) but using Option 5 (<code>priority</code> field) to break ties</li>
<li>Produces warnings to tell the user when <code>priority</code> may be needed</li>
<li>As <code>priority</code> is a low-level subset, we can start with that as an MVP.  Later, we can add warnings for all the ambiguity cases.  As we gain confidence in this, we can then add auto-sorting.</li>
</ul>
<p><strong>Option 7: Explicit groups</strong></p>
<pre><code class="language-rust">[lints.rust.groups]
all = "warn"
[lints.rust.lints]
allow_dead_code = "allow"
unsafe_code = "deny"</code></pre>
<ul>
<li>Hard codes knowledge of <code>all</code></li>
<li>Does not solve the intersecting group problem</li>
<li>Names aren’t validated as being from a group without duplicating the work needed for Option 1 (auto-sort)</li>
</ul>
<h3 id="workspace-inheritance"><a class="header" href="#workspace-inheritance">Workspace Inheritance</a></h3>
<p>Instead of using workspace inheritance for <code>[lint]</code>, we could make it
workspace-level configuration, like <code>[patch]</code> which is automatically applied to
all workspace members.  However, <code>[patch]</code> and friends are because they affect
the resolver / <code>Cargo.toml</code> and so they can only operate at the workspace
level.  <code>[lints]</code> is more like <code>[dependencies]</code> in being something that applies
at the package level but we want shared across workspaces.</p>
<p>Instead of traditional workspace inheritance where there is a single value to
inherit with <code>workspace = true</code>, we could have <code>[workspace.lints.&lt;preset&gt;]</code>
which defines presets and the user could do <code>lints.&lt;preset&gt; = true</code>.  The user
could then name them as they wish to avoid collision with rustc lints.</p>
<h3 id="rustfmt"><a class="header" href="#rustfmt"><code>rustfmt</code></a></h3>
<p>We could possibly extend this new field to <code>rustfmt</code> by shifting the focus from
“lints” to “rules” (see
<a href="https://eslint.org/docs/latest/use/configure/rules">eslint</a>).  However, the
more we generalize this field, the fewer assumptions we can make about it.  On
one extreme is <code>package.metadata</code> which is so free-form we can’t support it
with workspace inheritance.  A less extreme example is if we make the
configuration too general, we would preclude the option of supporting
per-package overrides as we wouldn’t know enough about the shape of the data to
know how to merge it.  There is likely a middle ground that we could make work
but it would take time and experimentation to figure that out which is at odds
with trying to maintain a stable file format.  Another problem with <code>rules</code> is
that it is divorced from any context.  In eslint, it is in an eslint-specific
config file but a <code>[rules]</code> table is not a clear as a <code>[lints]</code> table as to
what role it fulfills.</p>
<h3 id="target-specific-lint"><a class="header" href="#target-specific-lint">Target-specific lint</a></h3>
<p>We could support platform or feature specific settings, like with
<code>[lints.&lt;target&gt;]</code> or <code>[target.&lt;target&gt;.lints]</code> but</p>
<ul>
<li>There isn’t a defined use case for this yet besides having support for <code>cfg(feature = "clippy")</code> or
which does not seem high enough priority to design
around.</li>
<li><code>[lints.&lt;target&gt;]</code> runs into ambiguity issues around what is a <code>&lt;target&gt;</code>
entry vs a <code>&lt;lint&gt;</code> entry in the <code>[lints]</code> table.</li>
<li>We have not yet defined semantics for sharing something like this across a
workspace</li>
</ul>
<h2 id="prior-art"><a class="header" href="#prior-art">Prior art</a></h2>
<p>Rust</p>
<ul>
<li><a href="https://github.com/ericseppanen/cargo-cranky">cargo cranky</a></li>
</ul>
<p>Python</p>
<ul>
<li><a href="https://flake8.pycqa.org/en/latest/user/configuration.html">flake8</a>
<ul>
<li>Format is <code>level = [lint, ...]</code></li>
</ul>
</li>
<li><a href="https://github.com/PyCQA/pylint/blob/main/examples/pylintrc#L402">pylint</a>
<ul>
<li>Format is <code>level = [lint, ...]</code> but the <a href="https://pylint.pycqa.org/en/latest/user_guide/configuration/index.html">config file is a reflection of the CLI</a></li>
</ul>
</li>
<li><a href="https://beta.ruff.rs/docs/configuration/">ruff</a>
<ul>
<li>Format is <code>level = [lint, ...]</code>, due to past precedence in ecosystem (see above)</li>
</ul>
</li>
</ul>
<p>Javascript</p>
<ul>
<li><a href="https://eslint.org/docs/latest/use/configure/rules">eslint</a>
<ul>
<li>Format is <code>lint = level</code> / <code>lint = [ level, additional config ]</code></li>
</ul>
</li>
</ul>
<p>Go</p>
<ul>
<li><a href="https://golangci-lint.run/usage/configuration/">golangci-lint</a>
<ul>
<li>Format is <code>level = [lint, ...]</code></li>
</ul>
</li>
</ul>
<p>Ruby</p>
<ul>
<li><a href="https://docs.rubocop.org/rubocop/1.45/configuration.html">rubocop</a>
<ul>
<li>Format is <code>Lint: Enabled: true</code></li>
</ul>
</li>
</ul>
<h2 id="unresolved-questions"><a class="header" href="#unresolved-questions">Unresolved questions</a></h2>
<p>Blocking for stablization</p>
<ul>
<li>Are we still comfortable with our schema choice?</li>
<li>Are we still comfortable with our precedence choice?</li>
<li>Can we fingerprint only the lints for the tool being run?</li>
</ul>
<h2 id="future-possibilities"><a class="header" href="#future-possibilities">Future possibilities</a></h2>
<h3 id="help-the-user-with-priority"><a class="header" href="#help-the-user-with-priority">Help the user with <code>priority</code></a></h3>
<p>When running linters through cargo, we could warn the user when there is ambiguity, including</p>
<ul>
<li>A group and a lint at the same priority</li>
<li>A group that is a superset of another group at the same priority</li>
<li>Two intersecting groups at the same priority</li>
<li>A lint or group that is masked by a group in a later priority</li>
</ul>
<p>We could then take this a step further and change the way we sort within a
priority level to put the most specific entry last, where ambiguity doesn’t
exist.  This would nearly eliminate the need for specifying <code>priority</code> with the
current groups.</p>
<p>We specifically recommend warning, rather than error, so groups can evolve to
become intersecting without it being a breaking change.</p>
<p>To implement this, either cargo needs to pass the lints down to the tool in a
way to communicate the priority batches, allow cargo to query the group
memberships from the linter, or we hard code this at compile-time like
rust-analyzer
(<a href="https://rust-lang.github.io/rust-clippy/master/lints.json">lints</a>,
<a href="https://github.com/rust-lang/rust-analyzer/blob/a6464392c15fa8788215d669c4c0b1e46bcadeea/crates/ide-db/src/tests/sourcegen_lints.rs">generate</a>).
One thing to keep in mind is the potential for <a href="https://rust-lang.github.io/rfcs/2103-tool-attributes.html">custom
tools</a> in the
future.</p>
<h3 id="rustc-reporting-cargotoml-as-lint-level-source"><a class="header" href="#rustc-reporting-cargotoml-as-lint-level-source">rustc reporting <code>Cargo.toml</code> as lint-level source</a></h3>
<p>Currently Rust tells you where a lint level was enabled when it emits a lint.
<code>rustc</code> only sees that these lints are coming in from the command-line and
doesn’t know about <code>[lints]</code>.
It would be nice if it could also point to Cargo.toml for this.  This could be
as simple as a <code>--lint-source=Cargo.toml</code> with rustc knowing just enough about
the <code>[lints]</code> table to process it directly.</p>
<h3 id="external-file"><a class="header" href="#external-file">External file</a></h3>
<p>Like with <code>package.license</code>, users might want to refer to an external file for
their lints.  This especially becomes useful for copy/pasting lints between
projects.</p>
<h3 id="configurable-lints"><a class="header" href="#configurable-lints">Configurable lints</a></h3>
<p>We can extend basic lint syntax:</p>
<pre><code class="language-toml">[lints.clippy]
cyclomatic_complexity = "allow"
</code></pre>
<p>to support configuration, whether for cargo or the lint tool:</p>
<pre><code class="language-toml">[lints.clippy]
cyclomatic_complexity = { level = "allow", rust-version = "1.23.0", threshold = 30 }
</code></pre>
<p>Where <code>rust-version</code> is used by cargo to determine whether to pass along this
lint and <code>threshold</code> is used by the tool.  We’d need to define how to
distinguish between reserved and unreserved field names.</p>
<p>Tool-wide configuration would be in the <code>lints.&lt;tool&gt;.metadata</code> table and be
completely ignored by <code>cargo</code>.  For example:</p>
<pre><code class="language-toml">[lints.clippy.metadata]
avoid-breaking-exported-api = true
</code></pre>
<p>Tools will need <code>cargo metadata</code> to report the <code>lints</code> table so they can read
it without re-implementing workspace inheritance.</p>
<p><strong>Note:</strong> At this time, there is no lint configuration for clippy, just tool
configuration.  <code>lints.clippy.cyclomatic_complexity</code> exists for illustrative
purposes of what linters could support and is not indicative of any future
plans for clippy itself.</p>
<h3 id="packages-overriding-inherited-lints"><a class="header" href="#packages-overriding-inherited-lints">Packages overriding inherited lints</a></h3>
<p>Currently, it is a hard error to mix <code>workspace = true</code> and lints.  We could
open this up in the future for the package to override lints from the
workspace.  This would not be a breaking change as we’d be changing an error
case into a working case.  We should consider the possibility of adding
configurable lints in the future and what that would look like with
overridin of lints.</p>
<h3 id="extending-the-syntax-to-cargoconfigtoml"><a class="header" href="#extending-the-syntax-to-cargoconfigtoml">Extending the syntax to <code>.cargo/config.toml</code></a></h3>
<p>Similar to <code>profile</code> and <code>patch</code> being in both files, we could support
<code>[lints]</code> in both files.  This allows more flexibility for experimentation with
this feature, like conditionally applying them or applying them via environment
variables.  For now, users still have the option of using <code>rustflags</code>.</p>
<p>We would need to define whether this only affects local packages as-if the user
set it in <code>Cargo.toml</code> or if it also affects dependencies.</p>
<p>In doing so, we would need to define how <code>priority</code> interacts with different
sources of <code>[lints]</code>.</p>
<h3 id="cargo-lints"><a class="header" href="#cargo-lints">Cargo Lints</a></h3>
<p>The cargo team has expressed interest in producing warnings for more situations
but this requires defining a lint control system for it.  The overhead of doing
so has detered people from adding additional warnings.  This would provide an
MVP for controlling cargo lints, unblocking the cargo team from adding more
warnings.  This just leaves the question of whether these belong more in cargo
or in clippy which already has some cargo-specific lints.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="3373-avoid-nonlocal-definitions-in-fns.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="3391-result_ffi_guarantees.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="3373-avoid-nonlocal-definitions-in-fns.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="3391-result_ffi_guarantees.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
