<!DOCTYPE HTML>
<html lang="en_US" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>1252-open-options - The Rust RFC Book</title>


        <!-- Custom HTML head -->
        <script type="text/javascript" src="ltd-provenance.js"></script>
        <script type="text/javascript" src="ltd-current.js"></script>
        <script type="text/javascript" src="../../ltd-config.js"></script>
        <script type="text/javascript" src="../../ltd-flyout.js"></script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-0060737d.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-5025baa3.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust RFC Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/rust-lang/rfcs" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <ul>
<li>Feature Name: <code>expand_open_options</code></li>
<li>Start Date: 2015-08-04</li>
<li>RFC PR: <a href="https://github.com/rust-lang/rfcs/pull/1252">rust-lang/rfcs#1252</a></li>
<li>Rust Issue: <a href="https://github.com/rust-lang/rust/issues/30014">rust-lang/rust#30014</a></li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Document and expand the open options.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>The options that can be passed to the os when opening a file vary between
systems. And even if the options seem the same or similar, there may be
unexpected corner cases.</p>
<p>This RFC attempts to</p>
<ul>
<li>describe the different corner cases and behaviour of various operating
systems.</li>
<li>describe the intended behaviour and interaction of Rusts options.</li>
<li>remedy cross-platform inconsistencies.</li>
<li>suggest extra options to expose more platform-specific options.</li>
</ul>
<h2 id="detailed-design"><a class="header" href="#detailed-design">Detailed design</a></h2>
<h3 id="access-modes"><a class="header" href="#access-modes">Access modes</a></h3>
<h4 id="read-only"><a class="header" href="#read-only">Read-only</a></h4>
<p>Open a file for read-only.</p>
<h4 id="write-only"><a class="header" href="#write-only">Write-only</a></h4>
<p>Open a file for write-only.</p>
<p>If a file already exist, the contents of that file get overwritten, but it is
not truncated. Example:</p>
<pre><code>// contents of file before: "aaaaaaaa"
file.write(b"bbbb")
// contents of file after: "bbbbaaaa"
</code></pre>
<h4 id="read-write"><a class="header" href="#read-write">Read-write</a></h4>
<p>This is the simple combinations of read-only and write-only.</p>
<h4 id="append-mode"><a class="header" href="#append-mode">Append-mode</a></h4>
<p>Append-mode is similar to write-only, but all writes always happen at the end of
the file. This mode is especially useful if multiple processes or threads write
to a single file, like a log file. The operating system guarantees all writes
are atomic: no writes get mangled because another process writes at the same
time. No guarantees are made about the order writes end up in the file though.</p>
<p>Note: sadly append-mode is not atomic on NFS filesystems.</p>
<p>One maybe obvious note when using append-mode: make sure that all data that
belongs together, is written to the file in one operation. This can be done
by concatenating strings before passing them to <code>write()</code>, or using a buffered
writer (with a more than adequately sized buffer) and calling <code>flush()</code> when the
message is complete.</p>
<p><em>Implementation detail</em>: On Windows opening a file in append-mode has one flag
<em>less</em>, the right to change existing data is removed. On Unix opening a file in
append-mode has one flag <em>extra</em>, that sets the status of the file descriptor to
append-mode. You could say that on Windows write is a superset of append, while
on Unix append is a superset of write.</p>
<p>Because of this append is treated as a separate access mode in Rust, and if
<code>.append(true)</code> is specified than <code>.write()</code> is ignored.</p>
<h4 id="read-append"><a class="header" href="#read-append">Read-append</a></h4>
<p>Writing to the file works exactly the same as in append-mode.</p>
<p>Reading is more difficult, and may involve a lot of seeking. When the file is
opened, the position for reading may be set at the end of the file, so you
should first seek to the beginning. Also after every write the position is set
to the end of the file. So before writing you should save the current position,
and restore it after the write.</p>
<pre><code>try!(file.seek(SeekFrom::Start(0)));
try!(file.read(&amp;mut buffer));
let pos = try!(file.seek(SeekFrom::Current(0)));
try!(file.write(b"foo"));
try!(file.seek(SeekFrom::Start(pos)));
try!(file.read(&amp;mut buffer));
</code></pre>
<h4 id="no-access-mode-set"><a class="header" href="#no-access-mode-set">No access mode set</a></h4>
<p>Even if you don’t have read or write permission to a file, it is possible to
open it on some systems by opening it with no access mode set (or the equivalent
there of). This is true for Windows, Linux (with the flag <code>O_PATH</code>) and
GNU/Hurd.</p>
<p>What can be done with a file opened this way is system-specific and niche. Since
Linux version 2.6.39 all three operating systems support reading metadata such
as the file size and timestamps.</p>
<p>On practically all variants of Unix opening a file without specifying the access
mode falls back to opening the file read-only. This is because of the way the
access flags where traditionally defined: <code>O_RDONLY = 0</code>, <code>O_WRONLY = 1</code> and
<code>O_RDWR = 2</code>. When no flags are set, the access mode is <code>0</code>: read-only. But
code that relies on this is considered buggy and not portable.</p>
<p>What should Rust do when no access mode is specified? Fall back to read-only,
open with the most similar system-specific mode, or always fail to open? This
RFC proposes to always fail. This is the conservative choice, and can be changed
to open in a system-specific mode if a clear use case arises. Implementing a
fallback is not worth it: it is no great effort to set the access mode
explicitly.</p>
<h4 id="windows-specific"><a class="header" href="#windows-specific">Windows-specific</a></h4>
<p><code>.access_mode(FILE_READ_DATA)</code></p>
<p>On Windows you can detail whether you want to have read and/or write access to
the files data, attributes and/or extended attributes. Managing permissions in
such detail has proven itself too difficult, and generally not worth it.</p>
<p>In Rust, <code>.read(true)</code> gives you read access to the data, attributes and
extended attributes. Similarly, <code>.write(true)</code> gives write access to those
three, and the right to append data beyond the current end of the file.</p>
<p>But if you want fine-grained control, with <code>access_mode</code> you have it.</p>
<p><code>.access_mode()</code> overrides the access mode set with Rusts cross-platform
options. Reasons to do so:</p>
<ul>
<li>it is not possible to un-set the flags set by Rusts options;</li>
<li>otherwise the cross-platform options have to be wrapped with <code>#[cfg(unix)]</code>,
instead of only having to wrap the Windows-specific option.</li>
</ul>
<p>As a reference, this are the flags set by Rusts access modes:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th style="text-align: right">bit</th><th style="text-align: left">flag</th><th style="text-align: center">read</th><th style="text-align: center">write</th><th style="text-align: center">read-write</th><th style="text-align: center">append</th><th style="text-align: center">read-append</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right"><strong>generic rights</strong></td><td style="text-align: left"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">31</td><td style="text-align: left">GENERIC_READ</td><td style="text-align: center">set</td><td style="text-align: center"></td><td style="text-align: center">set</td><td style="text-align: center"></td><td style="text-align: center">set</td></tr>
<tr><td style="text-align: right">30</td><td style="text-align: left">GENERIC_WRITE</td><td style="text-align: center"></td><td style="text-align: center">set</td><td style="text-align: center">set</td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">29</td><td style="text-align: left">GENERIC_EXECUTE</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">28</td><td style="text-align: left">GENERIC_ALL</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right"><strong>specific rights</strong></td><td style="text-align: left"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">0</td><td style="text-align: left">FILE_READ_DATA</td><td style="text-align: center">implied</td><td style="text-align: center"></td><td style="text-align: center">implied</td><td style="text-align: center"></td><td style="text-align: center">implied</td></tr>
<tr><td style="text-align: right">1</td><td style="text-align: left">FILE_WRITE_DATA</td><td style="text-align: center"></td><td style="text-align: center">implied</td><td style="text-align: center">implied</td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">2</td><td style="text-align: left">FILE_APPEND_DATA</td><td style="text-align: center"></td><td style="text-align: center">implied</td><td style="text-align: center">implied</td><td style="text-align: center">set</td><td style="text-align: center">set</td></tr>
<tr><td style="text-align: right">3</td><td style="text-align: left">FILE_READ_EA</td><td style="text-align: center">implied</td><td style="text-align: center"></td><td style="text-align: center">implied</td><td style="text-align: center"></td><td style="text-align: center">implied</td></tr>
<tr><td style="text-align: right">4</td><td style="text-align: left">FILE_WRITE_EA</td><td style="text-align: center"></td><td style="text-align: center">implied</td><td style="text-align: center">implied</td><td style="text-align: center">set</td><td style="text-align: center">set</td></tr>
<tr><td style="text-align: right">6</td><td style="text-align: left">FILE_EXECUTE</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">7</td><td style="text-align: left">FILE_READ_ATTRIBUTES</td><td style="text-align: center">implied</td><td style="text-align: center"></td><td style="text-align: center">implied</td><td style="text-align: center"></td><td style="text-align: center">implied</td></tr>
<tr><td style="text-align: right">8</td><td style="text-align: left">FILE_WRITE_ATTRIBUTES</td><td style="text-align: center"></td><td style="text-align: center">implied</td><td style="text-align: center">implied</td><td style="text-align: center">set</td><td style="text-align: center">set</td></tr>
<tr><td style="text-align: right"><strong>standard rights</strong></td><td style="text-align: left"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">16</td><td style="text-align: left">DELETE</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">17</td><td style="text-align: left">READ_CONTROL</td><td style="text-align: center">implied</td><td style="text-align: center">implied</td><td style="text-align: center">implied</td><td style="text-align: center">set</td><td style="text-align: center">set+implied</td></tr>
<tr><td style="text-align: right">18</td><td style="text-align: left">WRITE_DAC</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">19</td><td style="text-align: left">WRITE_OWNER</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: right">20</td><td style="text-align: left">SYNCHRONIZE</td><td style="text-align: center">implied</td><td style="text-align: center">implied</td><td style="text-align: center">implied</td><td style="text-align: center">set</td><td style="text-align: center">set+implied</td></tr>
</tbody>
</table>
</div>
<p>The implied flags can be specified explicitly with the constants
<code>FILE_GENERIC_READ</code> and <code>FILE_GENERIC_WRITE</code>.</p>
<h3 id="creation-modes"><a class="header" href="#creation-modes">Creation modes</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th style="text-align: left">creation mode</th><th>file exists</th><th>file does not exist</th><th style="text-align: left">Unix</th><th style="text-align: left">Windows</th></tr>
</thead>
<tbody>
<tr><td style="text-align: left">not set (open existing)</td><td>open</td><td>fail</td><td style="text-align: left"></td><td style="text-align: left">OPEN_EXISTING</td></tr>
<tr><td style="text-align: left">.create(true)</td><td>open</td><td>create</td><td style="text-align: left">O_CREAT</td><td style="text-align: left">OPEN_ALWAYS</td></tr>
<tr><td style="text-align: left">.truncate(true)</td><td>truncate</td><td>fail</td><td style="text-align: left">O_TRUNC</td><td style="text-align: left">TRUNCATE_EXISTING</td></tr>
<tr><td style="text-align: left">.create(true).truncate(true)</td><td>truncate</td><td>create</td><td style="text-align: left">O_CREAT + O_TRUNC</td><td style="text-align: left">CREATE_ALWAYS</td></tr>
<tr><td style="text-align: left">.create_new(true)</td><td>fail</td><td>create</td><td style="text-align: left">O_CREAT + O_EXCL</td><td style="text-align: left">CREATE_NEW + FILE_FLAG_OPEN_REPARSE_POINT</td></tr>
</tbody>
</table>
</div>
<h4 id="not-set-open-existing"><a class="header" href="#not-set-open-existing">Not set (open existing)</a></h4>
<p>Open an existing file. Fails if the file does not exist.</p>
<h4 id="create"><a class="header" href="#create">Create</a></h4>
<p><code>.create(true)</code></p>
<p>Open an existing file, or create a new file if it does not already exists.</p>
<h4 id="truncate"><a class="header" href="#truncate">Truncate</a></h4>
<p><code>.truncate(true)</code></p>
<p>Open an existing file, and truncate it to zero length. Fails if the file does
not exist. Attributes and permissions of the truncated file are preserved.</p>
<p>Note when using the Windows-specific <code>.access_mode()</code>: truncating will only work
if the <code>GENERIC_WRITE</code> flag is set. Setting the equivalent individual flags is
not enough.</p>
<h4 id="create-and-truncate"><a class="header" href="#create-and-truncate">Create and truncate</a></h4>
<p><code>.create(true).truncate(true)</code></p>
<p>Open an existing file and truncate it to zero length, or create a new file if it
does not already exists.</p>
<p>Note when using the Windows-specific <code>.access_mode()</code>: Contrary to only
<code>.truncate(true)</code>, with <code>.create(true).truncate(true)</code> Windows <em>can</em> truncate an
existing file without requiring any flags to be set.</p>
<p>On Windows the attributes of an existing file can cause <code>.open()</code> to fail. If
the existing file has the attribute <em>hidden</em> set, it is necessary to open with
<code>FILE_ATTRIBUTE_HIDDEN</code>. Similarly if the existing file has the attribute
<em>system</em> set, it is necessary to open with <code>FILE_ATTRIBUTE_SYSTEM</code>. See
the Windows-specific <code>.attributes()</code> below on how to set these.</p>
<h4 id="create_new"><a class="header" href="#create_new">Create_new</a></h4>
<p><code>.create_new(true)</code></p>
<p>Create a new file, and fail if it already exist.</p>
<p>On Unix this options started its life as a security measure. If you first check
if a file does not exists with <code>exists()</code> and then call <code>open()</code>, some other
process may have created in the in mean time. <code>.create_new()</code> is an atomic
operation that will fail if a file already exist at the location.</p>
<p><code>.create_new()</code> has a special rule on Unix for dealing with symlinks. If there
is a symlink at the final element of its path (e.g. the filename), open will
fail. This is to prevent a vulnerability where an unprivileged process could
trick a privileged process into following a symlink and overwriting a file the
unprivileged process has no access to.
See <a href="https://lwn.net/Articles/250468/">Exploiting symlinks and tmpfiles</a>.
On Windows this behaviour is imitated by specifying not only <code>CREATE_NEW</code> but
also <code>FILE_FLAG_OPEN_REPARSE_POINT</code>.</p>
<p>Simply put: nothing is allowed to exist on the target location, also no
(dangling) symlink.</p>
<p>if <code>.create_new(true)</code> is set, <code>.create()</code> and <code>.truncate()</code> are ignored.</p>
<h4 id="unix-specific-mode"><a class="header" href="#unix-specific-mode">Unix-specific: Mode</a></h4>
<p><code>.mode(0o666)</code></p>
<p>On Unix the new file is created by default with permissions <code>0o666</code> minus the
systems <code>umask</code> (see <a href="https://en.wikipedia.org/wiki/Umask">Wikipedia</a>). It is
possible to set on other mode with this option.</p>
<p>If a file already exist or <code>.create(true)</code> or <code>.create_new(true)</code> are not
specified, <code>.mode()</code> is ignored.</p>
<p>Rust currently does not expose a way to modify the umask.</p>
<h4 id="windows-specific-attributes"><a class="header" href="#windows-specific-attributes">Windows-specific: Attributes</a></h4>
<p><code>.attributes(FILE_ATTRIBUTE_READONLY | FILE_ATTRIBUTE_HIDDEN | FILE_ATTRIBUTE_SYSTEM)</code></p>
<p>Files on Windows can have several attributes, most commonly one or more of the
following four: readonly, hidden, system and archive. Most
<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/gg258117%28v=vs.85%29.aspx">others</a>
are properties set by the file system. Of the others only
<code>FILE_ATTRIBUTE_ENCRYPTED</code>, <code>FILE_ATTRIBUTE_TEMPORARY</code> and
<code>FILE_ATTRIBUTE_OFFLINE</code> can be set when creating a new file. All others are
silently ignored.</p>
<p>It is no use to set the archive attribute, as Windows sets it automatically when
the file is newly created or modified. This flag may then be used by backup
applications as an indication of which files have changed.</p>
<p>If a <em>new</em> file is created because it does not yet exist and <code>.create(true)</code> or
<code>.create_new(true)</code> are specified, the new file is given the attributes declared
with <code>.attributes()</code>.</p>
<p>If an <em>existing</em> file is opened with <code>.create(true).truncate(true)</code>, its
existing attributes are preserved and combined with the ones declared with
<code>.attributes()</code>.</p>
<p>In all other cases the attributes get ignored.</p>
<h4 id="combination-of-access-modes-and-creation-modes"><a class="header" href="#combination-of-access-modes-and-creation-modes">Combination of access modes and creation modes</a></h4>
<p>Some combinations of creation modes and access modes do not make sense.</p>
<p>For example: <code>.create(true)</code> when opening read-only. If the file does not
already exist, it is created and you start reading from an empty file. And it is
questionable whether you have permission to create a new file if you don’t have
write access. A new file is created on all systems I have tested, but there is
no documentation that explicitly guarantees this behaviour.</p>
<p>The same is true for <code>.truncate(true)</code> with read and/or append mode. Should an
existing file be modified if you don’t have write permission? On Unix it is
undefined
(see <a href="http://www.monkey.org/openbsd/archive/tech/0009/msg00299.html">some</a>
<a href="http://www.monkey.org/openbsd/archive/tech/0009/msg00304.html">comments</a> on the
OpenBSD mailing list). The behaviour on Windows is inconsistent and depends on
whether <code>.create(true)</code> is set.</p>
<p>To give guarantees about cross-platform (and sane) behaviour, Rust should allow
only the following combinations of access modes and creations modes:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th style="text-align: left">creation mode</th><th style="text-align: center">read</th><th style="text-align: center">write</th><th style="text-align: center">read-write</th><th style="text-align: center">append</th><th style="text-align: center">read-append</th></tr>
</thead>
<tbody>
<tr><td style="text-align: left">not set (open existing)</td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center">X</td></tr>
<tr><td style="text-align: left">create</td><td style="text-align: center"></td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center">X</td></tr>
<tr><td style="text-align: left">truncate</td><td style="text-align: center"></td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: left">create and truncate</td><td style="text-align: center"></td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center"></td><td style="text-align: center"></td></tr>
<tr><td style="text-align: left">create_new</td><td style="text-align: center"></td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center">X</td><td style="text-align: center">X</td></tr>
</tbody>
</table>
</div>
<p>It is possible to bypass these restrictions by using system-specific options (as
in this case you already have to take care of cross-platform support yourself).
On Unix this is done by setting the creation mode using <code>.custom_flags()</code> with
<code>O_CREAT</code>, <code>O_TRUNC</code> and/or <code>O_EXCL</code>. On Windows this can be done by manually
specifying <code>.access_mode()</code> (see above).</p>
<h3 id="asynchronous-io"><a class="header" href="#asynchronous-io">Asynchronous IO</a></h3>
<p>Out op scope.</p>
<h3 id="other-options"><a class="header" href="#other-options">Other options</a></h3>
<h4 id="inheritance-of-file-descriptors"><a class="header" href="#inheritance-of-file-descriptors">Inheritance of file descriptors</a></h4>
<p>Leaking file descriptors to child processes can cause problems and can be a
security vulnerability. See this report by
<a href="https://www.python.org/dev/peps/pep-0446/">Python</a>.</p>
<p>On Windows, child processes do not inherit file descriptors by default (but this
can be changed). On Unix they always inherit, unless the close-on-exec flag is
set.</p>
<p>The close on exec flag can be set atomically when opening the file, or later
with <code>fcntl</code>. The <code>O_CLOEXEC</code> flag is in the relatively new POSIX-2008 standard,
and all modern versions of Unix support it. The following table lists for which
operating systems we can rely on the flag to be supported.</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th style="text-align: left">os</th><th style="text-align: left">since version</th><th style="text-align: left">oldest supported version</th></tr>
</thead>
<tbody>
<tr><td style="text-align: left">OS X</td><td style="text-align: left">10.6</td><td style="text-align: left">10.7?</td></tr>
<tr><td style="text-align: left">Linux</td><td style="text-align: left">2.6.23</td><td style="text-align: left">2.6.32 (supported by Rust)</td></tr>
<tr><td style="text-align: left">FreeBSD</td><td style="text-align: left">8.3</td><td style="text-align: left">8.4</td></tr>
<tr><td style="text-align: left">OpenBSD</td><td style="text-align: left">5.0</td><td style="text-align: left">5.7</td></tr>
<tr><td style="text-align: left">NetBSD</td><td style="text-align: left">6.0</td><td style="text-align: left">5.0</td></tr>
<tr><td style="text-align: left">Dragonfly BSD</td><td style="text-align: left">3.2</td><td style="text-align: left">? (3.2 is not updated since 2012-12-14)</td></tr>
<tr><td style="text-align: left">Solaris</td><td style="text-align: left">11</td><td style="text-align: left">10</td></tr>
</tbody>
</table>
</div>
<p>This means we can always set the flag <code>O_CLOEXEC</code>, and do an additional <code>fcntl</code>
if the os is NetBSD or Solaris.</p>
<h4 id="custom-flags"><a class="header" href="#custom-flags">Custom flags</a></h4>
<p><code>.custom_flags()</code></p>
<p>Windows and the various flavours of Unix support flags that are not
cross-platform, but that can be useful in some circumstances. On Unix they will
be passed as the variable <em>flags</em> to <code>open</code>, on Windows as the
<em>dwFlagsAndAttributes</em> parameter.</p>
<p>The cross-platform options of Rust can do magic: they can set any flag necessary
to ensure it works as expected. For example, <code>.append(true)</code> on Unix not only
sets the flag <code>O_APPEND</code>, but also automatically <code>O_WRONLY</code> or <code>O_RDWR</code>. This
special treatment is not available for the custom flags.</p>
<p>Custom flags can only set flags, not remove flags set by Rusts options.</p>
<p>For the custom flags on Unix, the bits that define the access mode are masked
out with <code>O_ACCMODE</code>, to ensure they do not interfere with the access mode set
by Rusts options.</p>
<p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/hh449426%28v=vs.85%29.aspx">Windows</a>:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th style="text-align: right">bit</th><th style="text-align: left">flag</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right">31</td><td style="text-align: left">FILE_FLAG_WRITE_THROUGH</td></tr>
<tr><td style="text-align: right">30</td><td style="text-align: left">FILE_FLAG_OVERLAPPED</td></tr>
<tr><td style="text-align: right">29</td><td style="text-align: left">FILE_FLAG_NO_BUFFERING</td></tr>
<tr><td style="text-align: right">28</td><td style="text-align: left">FILE_FLAG_RANDOM_ACCESS</td></tr>
<tr><td style="text-align: right">27</td><td style="text-align: left">FILE_FLAG_SEQUENTIAL_SCAN</td></tr>
<tr><td style="text-align: right">26</td><td style="text-align: left">FILE_FLAG_DELETE_ON_CLOSE</td></tr>
<tr><td style="text-align: right">25</td><td style="text-align: left">FILE_FLAG_BACKUP_SEMANTICS</td></tr>
<tr><td style="text-align: right">24</td><td style="text-align: left">FILE_FLAG_POSIX_SEMANTICS</td></tr>
<tr><td style="text-align: right">23</td><td style="text-align: left">FILE_FLAG_SESSION_AWARE</td></tr>
<tr><td style="text-align: right">21</td><td style="text-align: left">FILE_FLAG_OPEN_REPARSE_POINT</td></tr>
<tr><td style="text-align: right">20</td><td style="text-align: left">FILE_FLAG_OPEN_NO_RECALL</td></tr>
<tr><td style="text-align: right">19</td><td style="text-align: left">FILE_FLAG_FIRST_PIPE_INSTANCE</td></tr>
<tr><td style="text-align: right">18</td><td style="text-align: left">FILE_FLAG_OPEN_REQUIRING_OPLOCK</td></tr>
</tbody>
</table>
</div>
<p>Unix:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th style="text-align: left">POSIX</th><th style="text-align: left">Linux</th><th style="text-align: left">OS X</th><th style="text-align: left">FreeBSD</th><th style="text-align: left">OpenBSD</th><th style="text-align: left">NetBSD</th><th style="text-align: left">Dragonfly BSD</th><th style="text-align: left">Solaris</th></tr>
</thead>
<tbody>
<tr><td style="text-align: left">O_TRUNC</td><td style="text-align: left">O_TRUNC</td><td style="text-align: left">O_TRUNC</td><td style="text-align: left">O_TRUNC</td><td style="text-align: left">O_TRUNC</td><td style="text-align: left">O_TRUNC</td><td style="text-align: left">O_TRUNC</td><td style="text-align: left">O_TRUNC</td></tr>
<tr><td style="text-align: left">O_CREAT</td><td style="text-align: left">O_CREAT</td><td style="text-align: left">O_CREAT</td><td style="text-align: left">O_CREAT</td><td style="text-align: left">O_CREAT</td><td style="text-align: left">O_CREAT</td><td style="text-align: left">O_CREAT</td><td style="text-align: left">O_CREAT</td></tr>
<tr><td style="text-align: left">O_EXCL</td><td style="text-align: left">O_EXCL</td><td style="text-align: left">O_EXCL</td><td style="text-align: left">O_EXCL</td><td style="text-align: left">O_EXCL</td><td style="text-align: left">O_EXCL</td><td style="text-align: left">O_EXCL</td><td style="text-align: left">O_EXCL</td></tr>
<tr><td style="text-align: left">O_APPEND</td><td style="text-align: left">O_APPEND</td><td style="text-align: left">O_APPEND</td><td style="text-align: left">O_APPEND</td><td style="text-align: left">O_APPEND</td><td style="text-align: left">O_APPEND</td><td style="text-align: left">O_APPEND</td><td style="text-align: left">O_APPEND</td></tr>
<tr><td style="text-align: left">O_CLOEXEC</td><td style="text-align: left">O_CLOEXEC</td><td style="text-align: left">O_CLOEXEC</td><td style="text-align: left">O_CLOEXEC</td><td style="text-align: left">O_CLOEXEC</td><td style="text-align: left">O_CLOEXEC</td><td style="text-align: left">O_CLOEXEC</td><td style="text-align: left">O_CLOEXEC</td></tr>
<tr><td style="text-align: left">O_DIRECTORY</td><td style="text-align: left">O_DIRECTORY</td><td style="text-align: left">O_DIRECTORY</td><td style="text-align: left">O_DIRECTORY</td><td style="text-align: left">O_DIRECTORY</td><td style="text-align: left">O_DIRECTORY</td><td style="text-align: left">O_DIRECTORY</td><td style="text-align: left">O_DIRECTORY</td></tr>
<tr><td style="text-align: left">O_NOCTTY</td><td style="text-align: left">O_NOCTTY</td><td style="text-align: left">O_NOCTTY</td><td style="text-align: left">O_NOCTTY</td><td style="text-align: left"></td><td style="text-align: left">O_NOCTTY</td><td style="text-align: left"></td><td style="text-align: left">O_NOCTTY</td></tr>
<tr><td style="text-align: left">O_NOFOLLOW</td><td style="text-align: left">O_NOFOLLOW</td><td style="text-align: left">O_NOFOLLOW</td><td style="text-align: left">O_NOFOLLOW</td><td style="text-align: left">O_NOFOLLOW</td><td style="text-align: left">O_NOFOLLOW</td><td style="text-align: left">O_NOFOLLOW</td><td style="text-align: left">O_NOFOLLOW</td></tr>
<tr><td style="text-align: left">O_NONBLOCK</td><td style="text-align: left">O_NONBLOCK</td><td style="text-align: left">O_NONBLOCK</td><td style="text-align: left">O_NONBLOCK</td><td style="text-align: left">O_NONBLOCK</td><td style="text-align: left">O_NONBLOCK</td><td style="text-align: left">O_NONBLOCK</td><td style="text-align: left">O_NONBLOCK</td></tr>
<tr><td style="text-align: left">O_SYNC</td><td style="text-align: left">O_SYNC</td><td style="text-align: left">O_SYNC</td><td style="text-align: left">O_SYNC</td><td style="text-align: left">O_SYNC</td><td style="text-align: left">O_SYNC</td><td style="text-align: left">O_FSYNC</td><td style="text-align: left">O_SYNC</td></tr>
<tr><td style="text-align: left">O_DSYNC</td><td style="text-align: left">O_DSYNC</td><td style="text-align: left">O_DSYNC</td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_DSYNC</td><td style="text-align: left"></td><td style="text-align: left">O_DSYNC</td></tr>
<tr><td style="text-align: left">O_RSYNC</td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_RSYNC</td><td style="text-align: left"></td><td style="text-align: left">O_RSYNC</td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left">O_DIRECT</td><td style="text-align: left"></td><td style="text-align: left">O_DIRECT</td><td style="text-align: left"></td><td style="text-align: left">O_DIRECT</td><td style="text-align: left">O_DIRECT</td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left">O_ASYNC</td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_ASYNC</td><td style="text-align: left"></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left">O_NOATIME</td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left">O_PATH</td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left">O_TMPFILE</td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_SHLOCK</td><td style="text-align: left">O_SHLOCK</td><td style="text-align: left">O_SHLOCK</td><td style="text-align: left">O_SHLOCK</td><td style="text-align: left">O_SHLOCK</td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_EXLOCK</td><td style="text-align: left">O_EXLOCK</td><td style="text-align: left">O_EXLOCK</td><td style="text-align: left">O_EXLOCK</td><td style="text-align: left">O_EXLOCK</td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_SYMLINK</td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_EVTONLY</td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_NOSIGPIPE</td><td style="text-align: left"></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_ALT_IO</td><td style="text-align: left"></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_NOLINKS</td></tr>
<tr><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left"></td><td style="text-align: left">O_XATTR</td></tr>
<tr><td style="text-align: left"><a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html">POSIX</a></td><td style="text-align: left"><a href="http://man7.org/linux/man-pages/man2/open.2.html">Linux</a></td><td style="text-align: left"><a href="https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man2/open.2.html">OS X</a></td><td style="text-align: left"><a href="https://www.freebsd.org/cgi/man.cgi?query=open&amp;sektion=2">FreeBSD</a></td><td style="text-align: left"><a href="http://www.openbsd.org/cgi-bin/man.cgi/OpenBSD-current/man2/open.2?query=open&amp;sec=2">OpenBSD</a></td><td style="text-align: left"><a href="http://netbsd.gw.com/cgi-bin/man-cgi?open+2+NetBSD-current">NetBSD</a></td><td style="text-align: left"><a href="http://leaf.dragonflybsd.org/cgi/web-man?command=open&amp;section=2">Dragonfly BSD</a></td><td style="text-align: left"><a href="http://docs.oracle.com/cd/E23824_01/html/821-1463/open-2.html">Solaris</a></td></tr>
</tbody>
</table>
</div>
<h4 id="windows-specific-flags-and-attributes"><a class="header" href="#windows-specific-flags-and-attributes">Windows-specific flags and attributes</a></h4>
<p>The following variables for CreateFile2 currently have no equivalent functions
in Rust to set them:</p>
<pre><code>DWORD                 dwSecurityQosFlags;
LPSECURITY_ATTRIBUTES lpSecurityAttributes;
HANDLE                hTemplateFile;
</code></pre>
<h3 id="changes-from-current"><a class="header" href="#changes-from-current">Changes from current</a></h3>
<h4 id="access-mode"><a class="header" href="#access-mode">Access mode</a></h4>
<ul>
<li>Current: <code>.append(true)</code> requires <code>.write(true)</code> on Unix, but not on Windows.
New: ignore <code>.write()</code> if <code>.append(true)</code> is specified.</li>
<li>Current: when <code>.append(true)</code> is set, it is not possible to modify file
attributes on Windows, but it is possible to change the file mode on Unix.
New: allow file attributes to be modified on Windows in append-mode.</li>
<li>Current: On Windows <code>.read()</code> and <code>.write()</code> set individual bit flags instead
of generic flags. New: Set generic flags, as recommend by Microsoft. e.g.
<code>GENERIC_WRITE</code> instead of <code>FILE_GENERIC_WRITE</code> and <code>GENERIC_READ</code> instead of
<code>FILE_GENERIC_READ</code>. Currently truncate is broken on Windows, this fixes it.</li>
<li>Current: when no access mode is set, this falls back to opening the file
read-only on Unix, and opening with no access permissions on Windows.
New: always fail to open if no access mode is set.</li>
<li>Rename the Windows-specific <code>.desired_access()</code> to <code>.access_mode()</code></li>
</ul>
<h4 id="creation-mode"><a class="header" href="#creation-mode">Creation mode</a></h4>
<ul>
<li>Implement <code>.create_new()</code>.</li>
<li>Do not allow <code>.truncate(true)</code> if the access mode is read-only and/or append.</li>
<li>Do not allow <code>.create(true)</code> or <code>.create_new (true)</code> if the access mode is
read-only.</li>
<li>Remove the Windows-specific <code>.creation_disposition()</code>.
It has no use, because all its options can be set in a cross-platform way.</li>
<li>Split the Windows-specific <code>.flags_and_attributes()</code> into <code>.custom_flags()</code>
and <code>.attributes()</code>. This is a form of future-proofing, as the new Windows 8
<code>Createfile2</code> also splits these attributes. This has the advantage of a clear
separation between file attributes, that are somewhat similar to Unix mode
bits, and the custom flags that modify the behaviour of the current file
handle.</li>
</ul>
<h4 id="other-options-1"><a class="header" href="#other-options-1">Other options</a></h4>
<ul>
<li>Set the close-on-exec flag atomically on Unix if supported.</li>
<li>Implement <code>.custom_flags()</code> on Windows and Unix to pass custom flags to the
system.</li>
</ul>
<h2 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h2>
<p>This adds a thin layer on top of the raw operating system calls. In this
<a href="https://github.com/rust-lang/rust/pull/26772#issuecomment-126753342">pull request</a>
the conclusion was: this seems like a good idea for a “high level” abstraction
like OpenOptions.</p>
<p>This adds extra options that many applications can do without (otherwise they
were already implemented).</p>
<p>Also this RFC is in line with the vision for IO in the
<a href="https://github.com/rust-lang/rfcs/blob/master/text/0517-io-os-reform.md#vision-for-io">IO-OS-redesign</a>:</p>
<ul>
<li>[The APIs] should impose essentially zero cost over the underlying OS
services; the core APIs should map down to a single syscall unless more are
needed for cross-platform compatibility.</li>
<li>The APIs should largely feel like part of “Rust” rather than part of any
legacy, and they should enable truly portable code.</li>
<li>Coverage. The std APIs should over time strive for full coverage of non-niche,
cross-platform capabilities.</li>
</ul>
<h2 id="alternatives"><a class="header" href="#alternatives">Alternatives</a></h2>
<p>The first version of this RFC contained a proposal for options that control
caching anf file locking. They are out of scope for now, but included here for
reference.</p>
<h3 id="sharing--locking"><a class="header" href="#sharing--locking">Sharing / locking</a></h3>
<p>On Unix it is possible for multiple processes to read and write to the same file
at the same time.</p>
<p>When you open a file on Windows, the system by default denies other processes to
read or write to the file, or delete it. By setting the sharing mode, it is
possible to allow other processes read, write and/or delete access. For
cross-platform consistency, Rust imitates Unix by setting all sharing flags.</p>
<p>Unix has no equivalent to the kind of file locking that Windows has. It has two
types of advisory locking, POSIX and BSD-style. Advisory means any process that
does not use locking itself can happily ignore the locking af another process.
As if that is not bad enough, they both have
<a href="http://0pointer.de/blog/projects/locking.html">problems</a> that make them close
to unusable for modern multi-threaded programs. Linux may in some very rare
cases support mandatory file locking, but it is just as broken as advisory.</p>
<h4 id="windows-specific-share-mode"><a class="header" href="#windows-specific-share-mode">Windows-specific: Share mode</a></h4>
<p><code>.share_mode(FILE_SHARE_READ | FILE_SHARE_WRITE | FILE_SHARE_DELETE)</code></p>
<p>It is possible to set the individual share permissions with <code>.share_mode()</code>.</p>
<p>The current philosophy of this function is that others should have no rights,
unless explicitly granted. I think a better fit for Rust would be to give all
others all rights, unless explicitly denied, e.g.:
<code>.share_mode(DENY_READ | DENY_WRITE | DENY_DELETE)</code>.</p>
<h3 id="controlling-caching"><a class="header" href="#controlling-caching">Controlling caching</a></h3>
<p>When dealing file file systems and hard disks, there are several kinds of
caches. Giving hints or controlling them may improve performance or data
consistency.</p>
<ol>
<li><em>read-ahead (performance of reads and overwrites)</em>
Instead of requesting only the data necessary for a single <code>read()</code> call from
a storage device, an operating system may request more data than necessary to
have it already available for the next read.</li>
<li><em>os cache  (performance of reads and overwrites)</em>
The os may keep the data of previous reads and writes in memory to increase
the performance of future reads and possibly writes.</li>
<li><em>os staging area (convenience/performance of reads and writes)</em>
The size and alignment of data reads and writes to a disk should
correspondent to sectors on the storage device, usually 512 or 4096 bytes.
The os makes sure a regular <code>write()</code> or <code>read()</code> doesn’t have to care about
this. For example a small write (say a 100 bytes) has to rewrite a whole
sector. The os often has the surrounding data in its cache and can
efficiently combine it to write the whole sector.</li>
<li><em>delayed writing (performance/correctness of writes)</em>
The os may delay writes to improve performance, for example by batching
consecutive writes, and scheduling with reads to minimize seeking.</li>
<li><em>on-disk write cache (performance/correctness of writes)</em>
Most hard disk / storage devices have a small RAM cache. It can speed up
reads, and writes can return as soon as the data is written to the devices
cache.</li>
</ol>
<h4 id="read-ahead-hint"><a class="header" href="#read-ahead-hint">Read-ahead hint</a></h4>
<pre><code>.read_ahead_hint(enum CacheHint)

enum ReadAheadHint {
    Default,
    Sequential,
    Random,
}
</code></pre>
<p>If you read a file sequentially the read-ahead is beneficial, for completely
random access it can become a penalty.</p>
<ul>
<li><code>Default</code> uses the generally good heuristics of the operating system.</li>
<li><code>Sequential</code> indicates sequential but not necessary consecutive access.
With this the os may increase the amount of data that is read ahead.</li>
<li><code>Random</code> indicates mainly random access. The os may disable its read-ahead
cache.</li>
</ul>
<p>This option is treated as a hint. It is ignored if the os does not support it,
or if the behaviour of the application proves it is set wrong.</p>
<p>Open flags / system calls:</p>
<ul>
<li>Windows: flags <code>FILE_FLAG_SEQUENTIAL_SCAN</code> and <code>FILE_FLAG_RANDOM_ACCESS</code></li>
<li>Linux, FreeBSD, NetBSD: <code>posix_fadvise()</code> with the flags
<code>POSIX_FADV_SEQUENTIAL</code> and <code>POSIX_FADV_RANDOM</code></li>
<li>OS X: <code>fcntl()</code> with with <code>F_RDAHEAD 0</code> for random (there is no special mode
for sequential).</li>
</ul>
<h4 id="os-cache"><a class="header" href="#os-cache">OS cache</a></h4>
<p><code>used_once(true)</code></p>
<p>When reading many gigabytes of data a process may push useful data from other
processes out of the os cache. To keep the performance of the whole system up, a
process could indicate to the os whether data is only needed once, or not needed
anymore. On Linux, FreeBSD and NetBSD this is possible with fcntl
<code>POSIX_FADV_DONTNEED</code> after a read or write with sync (or before close). On
FreeBSD and NetBSD it is also possible to specify this up-front with fnctl
<code>POSIX_FADV_NOREUSE</code>, and on OS X with fnctl <code>F_NOCACHE</code>. Windows does not seem
to provide an option for this.</p>
<p>This option may negatively effect the performance of writes smaller than the
sector size, as cached data may not be available to the os staging area.</p>
<p>This control over the os cache is the main reason some applications use direct
io, despite it being less convenient and disabling other useful caches.</p>
<h4 id="delayed-writing-and-on-disk-write-cache"><a class="header" href="#delayed-writing-and-on-disk-write-cache">Delayed writing and on-disk write cache</a></h4>
<p><code>.sync_data(true)</code> and <code>.sync_all(true)</code></p>
<p>There can be two delays (by the os and by the disk cache) between when an
application performs a write, and when the data is written to persistent
storage. They increase performance, but increase the risk of data loss in case
of a systems crash or power outage.</p>
<p>When dealing with critical data, it may be useful to control these caches to
make the chance of data loss smaller. The application should normally do so by
calling Rusts stand-alone functions <code>sync_data()</code> or <code>sync_all()</code> at meaningful
points (e.g. when the file is in a consistent state, or a state it can recover
from).</p>
<p>However, <code>.sync_data()</code> and <code>.sync_all()</code> may also be given as an open option.
This guarantees every write will not return before the data is written to disk.
These options improve reliability as and you can never accidentally forget a
sync.</p>
<p>Whether performance with these options is worse than with the stand-alone
functions is hard to say. With these options the data maybe has to be
synchronised more often. But the stand-alone functions often sync outstanding
writes to all files, while the options possibly sync only the current file.</p>
<p>The difference between <code>.sync_all()</code> and <code>.sync_data(true)</code> is that
<code>.sync_data(true)</code> does not update the less critical metadata such as the last
modified timestamp (although it will be written eventually).</p>
<p>Open flags:</p>
<ul>
<li>Windows: <code>FILE_FLAG_WRITE_THROUGH</code> for <code>.sync_all()</code></li>
<li>Unix: <code>O_SYNC</code> for <code>.sync_all()</code> and <code>O_DSYNC</code> for <code>.sync_data()</code></li>
</ul>
<p>If a system does not support syncing only data, this option will fall back to
syncing both data and metadata. If <code>.sync_all(true)</code> is specified,
<code>.sync_data()</code> is ignored.</p>
<h4 id="direct-access--no-caching"><a class="header" href="#direct-access--no-caching">Direct access / no caching</a></h4>
<p>Most operating systems offer a mode that reads data straight from disk to an
application buffer, or that writes straight from a buffer to disk. This avoid
the small cost of a memory copy. It has the side effect that the data is not
available to the os to provide caching. Also, because this does not use the
<em>os staging area</em> all reads and writes have to take care of data sizes and
alignment themselves.</p>
<p>Overview:</p>
<ul>
<li><em>os staging area</em>: not used</li>
<li><em>read-ahead</em>: not used</li>
<li><em>os cache</em>: data may be used, but is not added</li>
<li><em>delayed writing</em>: no delay</li>
<li><em>on-disk write cache</em>: maybe</li>
</ul>
<p>Open flags / system calls:</p>
<ul>
<li>Windows: flag <code>FILE_FLAG_NO_BUFFERING</code></li>
<li>Linux, FreeBSD, NetBSD, Dragonfly BSD: flag <code>O_DIRECT</code></li>
</ul>
<p>The other options offer a more fine-grained control over caching, and usually
offer better performance or correctness guarantees. This option is sometimes
used by applications as a crude way to control (disable) the <em>os cache</em>.</p>
<p>Rust should not currently expose this as an open option, because it should be
used with an abstraction / external crate that handles the data size and
alignment requirements. If it should be used at all.</p>
<h2 id="unresolved-questions"><a class="header" href="#unresolved-questions">Unresolved questions</a></h2>
<p>None.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="1242-rust-lang-crates.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="1257-drain-range-2.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="1242-rust-lang-crates.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="1257-drain-range-2.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
